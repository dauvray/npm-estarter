{"version":3,"file":"index.umd.js","sources":["../src/core/algorithms.js","../src/core/image.js","../node_modules/debounce/index.js","../src/core/utils.js","../src/Cropper.vue","../node_modules/classnames/index.js","../node_modules/easy-bem/index.js","../src/core/events.js","../src/mixins/draggable.js","../src/core/constants.js","../src/index.js"],"sourcesContent":["import {\n\tHORIZONTAL_DIRECTIONS,\n\tVERTICAL_DIRECTIONS,\n\tALL_DIRECTIONS,\n} from './constants';\n\nimport {\n\tisUndefined\n} from './utils';\n\nimport { MoveEvent } from './events';\n\nfunction allSides(coordinates) {\n\treturn {\n\t\tleft: coordinates.left,\n\t\ttop: coordinates.top,\n\t\tright: coordinates.left + coordinates.width,\n\t\tbottom: coordinates.top + coordinates.height,\n\t};\n}\n\nfunction mainSide(side) {\n\tif (side === 'right') {\n\t\treturn 'left';\n\t} else if (side === 'bottom') {\n\t\treturn 'top';\n\t} else if (side === 'left' || side === 'top') {\n\t\treturn side;\n\t}\n}\n\nfunction getCurrentWidth(actualCoordinates, directions) {\n\treturn actualCoordinates.width + (directions.left + directions.right);\n}\n\nfunction getCurrentHeight(actualCoordinates, directions) {\n\treturn actualCoordinates.height + (directions.top + directions.bottom);\n}\n\nfunction getBrokenLimits(coordinates, directions, allowedArea) {\n\treturn {\n\t\tleft: ('left' in allowedArea) ? -Math.min(0, Math.ceil(coordinates.left - allowedArea.left) - directions.left) : 0,\n\t\ttop: ('top' in allowedArea) ? -Math.min(0, Math.ceil(coordinates.top - allowedArea.top) - directions.top) : 0,\n\t\tbottom: ('bottom' in allowedArea) ? -Math.min(0, allowedArea.bottom - (coordinates.bottom + directions.bottom)) : 0,\n\t\tright: ('right' in allowedArea) ? -Math.min(0, allowedArea.right - (coordinates.right + directions.right)) : 0,\n\t};\n}\n\nfunction fitConditions({ directions: oldDirections, coordinates, restrictions, preserveAspectRatio, stopOnBreak, mode = 'crop', allowedArea = {}}) {\n\tconst directions = { ...oldDirections, };\n\n\tlet currentWidth = getCurrentWidth(coordinates, directions);\n\tlet currentHeight = getCurrentHeight(coordinates, directions);\n\n\t// Prevent strange resizes when the width or height of stencil becomes smaller than 0\n\tif (currentWidth < 0) {\n\t\tif (directions.left < 0 && directions.right < 0) {\n\t\t\tdirections.left = -(coordinates.width - restrictions.minWidth) / (directions.left / directions.right);\n\t\t\tdirections.right = -(coordinates.width - restrictions.minWidth) / (directions.right / directions.left);\n\t\t} else if (directions.left < 0) {\n\t\t\tdirections.left = -(coordinates.width - restrictions.minWidth);\n\t\t} else if (directions.right < 0) {\n\t\t\tdirections.right = -(coordinates.width - restrictions.minWidth);\n\t\t}\n\t}\n\tif (currentHeight < 0) {\n\t\tif (directions.top < 0 && directions.bottom < 0) {\n\t\t\tdirections.top = -(coordinates.height - restrictions.minHeight) / (directions.top / directions.bottom);\n\t\t\tdirections.bottom = -(coordinates.height - restrictions.minHeight) / (directions.bottom / directions.top);\n\t\t} else if (directions.top < 0) {\n\t\t\tdirections.top = -(coordinates.height - restrictions.minHeight);\n\t\t} else if (directions.bottom < 0) {\n\t\t\tdirections.bottom = -(coordinates.height - restrictions.minHeight);\n\t\t}\n\t}\n\n\t// Prevent breaking limits\n\tlet breaks = getBrokenLimits(coordinates, directions, allowedArea);\n\n\tif (mode === 'move') {\n\t\tif (breaks.left > 0 && breaks.right === 0) {\n\t\t\tdirections.right += breaks.left;\n\t\t\tdirections.left -= breaks.left;\n\t\t} else if (breaks.right > 0 && breaks.left === 0) {\n\t\t\tdirections.left += breaks.right;\n\t\t\tdirections.right -= breaks.right;\n\t\t}\n\n\t\tif (breaks.top > 0 && breaks.bottom === 0) {\n\t\t\tdirections.bottom += breaks.top;\n\t\t\tdirections.top -= breaks.top;\n\t\t} else if (breaks.bottom > 0 && breaks.top === 0) {\n\t\t\tdirections.top += breaks.bottom;\n\t\t\tdirections.bottom -= breaks.bottom;\n\t\t}\n\n\t\tbreaks = getBrokenLimits(coordinates, directions, allowedArea);\n\t}\n\n\tconst maxResize = {\n\t\twidth: Infinity,\n\t\theight: Infinity\n\t};\n\n\tALL_DIRECTIONS.forEach(direction => {\n\t\tif (breaks[direction] && directions[direction]) {\n\t\t\tmaxResize[direction] = Math.max(0, 1 - breaks[direction] / (directions[direction]));\n\t\t} else {\n\t\t\tmaxResize[direction] = Infinity;\n\t\t}\n\t});\n\n\tif (preserveAspectRatio) {\n\t\tconst multiplier = Math.min(...ALL_DIRECTIONS.map(direction => maxResize[direction]));\n\t\tif (multiplier !== Infinity) {\n\t\t\tALL_DIRECTIONS.forEach(direction => {\n\t\t\t\tdirections[direction] *= multiplier;\n\t\t\t});\n\t\t}\n\t} else {\n\t\tHORIZONTAL_DIRECTIONS.forEach(direction => {\n\t\t\tconst multiplier = stopOnBreak ? Math.min(maxResize.top, maxResize.bottom) : maxResize[direction];\n\t\t\tif (multiplier !== Infinity) {\n\t\t\t\tdirections[direction] *= multiplier;\n\t\t\t}\n\t\t});\n\t\tVERTICAL_DIRECTIONS.forEach(direction => {\n\t\t\tconst multiplier = stopOnBreak ? Math.min(maxResize.top, maxResize.bottom) : maxResize[direction];\n\t\t\tif (multiplier !== Infinity) {\n\t\t\t\tdirections[direction] *= multiplier;\n\t\t\t}\n\t\t});\n\t}\n\n\tcurrentWidth = getCurrentWidth(coordinates, directions);\n\tcurrentHeight = getCurrentHeight(coordinates, directions);\n\n\tif (directions.right + directions.left) {\n\t\tif (currentWidth > restrictions.maxWidth) {\n\t\t\tmaxResize.width = (restrictions.maxWidth - coordinates.width) / (directions.right + directions.left);\n\t\t} else if (currentWidth < restrictions.minWidth) {\n\t\t\tmaxResize.width = (restrictions.minWidth - coordinates.width) / (directions.right + directions.left);\n\t\t}\n\t}\n\n\tif (directions.bottom + directions.top) {\n\t\tif (currentHeight > restrictions.maxHeight) {\n\t\t\tmaxResize.height = (restrictions.maxHeight - coordinates.height) / (directions.bottom + directions.top);\n\t\t} else if (currentHeight < restrictions.minHeight) {\n\t\t\tmaxResize.height = (restrictions.minHeight - coordinates.height) / (directions.bottom + directions.top);\n\t\t}\n\t}\n\n\tif (preserveAspectRatio) {\n\t\tconst multiplier = Math.min(maxResize.width, maxResize.height);\n\t\tif (multiplier !== Infinity) {\n\t\t\tALL_DIRECTIONS.forEach(direction => {\n\t\t\t\tdirections[direction] *= multiplier;\n\t\t\t});\n\t\t}\n\t}\n\telse {\n\t\tif (maxResize.width !== Infinity) {\n\t\t\tHORIZONTAL_DIRECTIONS.forEach(direction => {\n\t\t\t\tdirections[direction] *= maxResize.width;\n\t\t\t});\n\t\t}\n\t\tif (maxResize.height !== Infinity) {\n\t\t\tVERTICAL_DIRECTIONS.forEach(direction => {\n\t\t\t\tdirections[direction] *= maxResize.height;\n\t\t\t});\n\t\t}\n\t}\n\n\treturn directions;\n}\n\n\n\nfunction getBrokenRatio(currentWidth, currentHeight, aspectRatio, actualCoordinates, preserveAspectRatio) {\n\tlet ratioBroken;\n\tif (aspectRatio.minimum && currentWidth / currentHeight < aspectRatio.minimum) {\n\t\tratioBroken = aspectRatio.minimum;\n\t} else if (aspectRatio.maximum && currentWidth / currentHeight > aspectRatio.maximum) {\n\t\tratioBroken = aspectRatio.maximum;\n\t} else if (preserveAspectRatio) {\n\t\tratioBroken = actualCoordinates.width / actualCoordinates.height;\n\t}\n\treturn ratioBroken;\n}\n\nexport function resize ({ coordinates, restrictions, allowedArea, aspectRatio, resizeEvent }) {\n\tconst actualCoordinates = {\n\t\t...coordinates,\n\t\tright: coordinates.left + coordinates.width,\n\t\tbottom: coordinates.top + coordinates.height,\n\t};\n\n\tconst params = resizeEvent.params || {};\n\n\tlet directions = {\n\t\t...resizeEvent.directions,\n\t};\n\n\tconst limitedRestrictions = {\n\t\t...restrictions,\n\t\tminWidth: Math.max(restrictions.minWidth, restrictions.minimum),\n\t\tminHeight: Math.max(restrictions.minHeight, restrictions.minimum),\n\t};\n\n\tconst allowedDirections = params.allowedDirections || {\n\t\tleft: true,\n\t\tright: true,\n\t\tbottom: true,\n\t\ttop: true,\n\t};\n\n\tALL_DIRECTIONS.forEach(direction => {\n\t\tif (!allowedDirections[direction]) {\n\t\t\tdirections[direction] = 0;\n\t\t}\n\t});\n\n\t// 1. First step: determine the safe and desired area\n\tdirections = fitConditions({ directions, restrictions: limitedRestrictions, coordinates: actualCoordinates, allowedArea, stopOnBreak: params.stopOnBreak });\n\n\t// 2. Second step: fix desired box to correspondent to aspect ratio\n\tlet currentWidth = getCurrentWidth(actualCoordinates, directions);\n\tlet currentHeight = getCurrentHeight(actualCoordinates, directions);\n\n\t// Checks ratio:\n\tlet ratioBroken = getBrokenRatio(currentWidth, currentHeight, aspectRatio, actualCoordinates, params.preserveAspectRatio);\n\n\tif (ratioBroken) {\n\t\tlet { respectDirection, } = params;\n\t\tif (!respectDirection) {\n\t\t\tif (actualCoordinates.width >= actualCoordinates.height || ratioBroken == 1) {\n\t\t\t\trespectDirection = 'width';\n\t\t\t} else {\n\t\t\t\trespectDirection = 'height';\n\t\t\t}\n\t\t}\n\t\tif (respectDirection === 'width') {\n\t\t\tlet overlapHeight = currentWidth / ratioBroken - actualCoordinates.height;\n\t\t\tif ((allowedDirections.top && allowedDirections.bottom)) {\n\t\t\t\tdirections.bottom = overlapHeight / 2;\n\t\t\t\tdirections.top = overlapHeight / 2;\n\t\t\t} else if (allowedDirections.bottom) {\n\t\t\t\tdirections.bottom = overlapHeight;\n\t\t\t} else if (allowedDirections.top) {\n\t\t\t\tdirections.top = overlapHeight;\n\t\t\t}  else if (allowedDirections.right) {\n\t\t\t\tdirections.right = 0;\n\t\t\t} else if (allowedDirections.left) {\n\t\t\t\tdirections.left = 0;\n\t\t\t}\n\t\t} else if (respectDirection === 'height') {\n\t\t\tlet overlapWidth = actualCoordinates.width - currentHeight * ratioBroken;\n\t\t\tif (allowedDirections.left && allowedDirections.right) {\n\t\t\t\tdirections.left = -overlapWidth / 2;\n\t\t\t\tdirections.right = -overlapWidth / 2;\n\t\t\t} else if (allowedDirections.left) {\n\t\t\t\tdirections.left = -overlapWidth;\n\t\t\t} else if (allowedDirections.right) {\n\t\t\t\tdirections.right = -overlapWidth;\n\t\t\t} else if (allowedDirections.top) {\n\t\t\t\tdirections.top = 0;\n\t\t\t} else if (allowedDirections.bottom) {\n\t\t\t\tdirections.bottom = 0;\n\t\t\t}\n\t\t}\n\t\t// 3. Third step: check if desired box with correct aspect ratios break some limits and fit to this conditions\n\t\tdirections = fitConditions({ directions, restrictions: limitedRestrictions, coordinates: actualCoordinates, allowedArea, preserveAspectRatio: true, mode: params.compensate && !params.stopOnBreak ? 'move' : 'crop' });\n\t}\n\n\t// 4. Check if ratio broken (temporary):\n\tcurrentWidth = getCurrentWidth(actualCoordinates, directions);\n\tcurrentHeight = getCurrentHeight(actualCoordinates, directions);\n\tratioBroken = getBrokenRatio(currentWidth, currentHeight, aspectRatio, actualCoordinates, params.preserveAspectRatio);\n\tif (Math.abs(ratioBroken - currentWidth/currentHeight) > 1e-3) {\n\t\tconsole.error(`Something went wrong and ratio was broken: ${currentWidth/currentHeight} instead of ${ratioBroken}`);\n\t\tALL_DIRECTIONS.forEach(direction => {\n\t\t\tif (!allowedDirections[direction]) {\n\t\t\t\tdirections[direction] = 0;\n\t\t\t}\n\t\t});\n\t}\n\n\treturn move({\n\t\tcoordinates: {\n\t\t\twidth: coordinates.width + directions.right + directions.left,\n\t\t\theight: coordinates.height + directions.top + directions.bottom,\n\t\t\tleft: coordinates.left,\n\t\t\ttop: coordinates.top,\n\t\t},\n\t\tallowedArea,\n\t\tmoveEvent: new MoveEvent({}, {\n\t\t\tleft: -directions.left,\n\t\t\ttop: -directions.top,\n\t\t})\n\t});\n}\n\nexport function move ({ coordinates, allowedArea = {}, moveEvent }) {\n\n\tconst directions = {\n\t\t...moveEvent.directions,\n\t};\n\n\tconst newCoordinates = {\n\t\tleft: coordinates.left + directions.left,\n\t\ttop: coordinates.top + directions.top,\n\t\twidth: coordinates.width,\n\t\theight: coordinates.height,\n\t};\n\n\tif ('left' in allowedArea && newCoordinates.left < allowedArea.left) {\n\t\tnewCoordinates.left = allowedArea.left;\n\t}\n\tif ('right' in allowedArea && newCoordinates.left + newCoordinates.width > allowedArea.right) {\n\t\tnewCoordinates.left = allowedArea.right - newCoordinates.width;\n\t}\n\tif ('top' in allowedArea && newCoordinates.top < allowedArea.top) {\n\t\tnewCoordinates.top = allowedArea.top;\n\t}\n\tif ('bottom' in allowedArea && newCoordinates.top + newCoordinates.height > allowedArea.bottom) {\n\t\tnewCoordinates.top = allowedArea.bottom - newCoordinates.height;\n\t}\n\n\treturn newCoordinates;\n}\n\n// eslint-disable-next-line no-unused-vars\nexport function areaSize ({ cropper, image, imageWidth, imageHeight }) {\n\tconst areaHeight = cropper.clientHeight;\n\tconst areaWidth = cropper.clientWidth;\n\n\tlet currentHeight = areaHeight;\n\tlet currentWidth = imageWidth * areaHeight / imageHeight;\n\n\tif (currentWidth > areaWidth) {\n\t\tcurrentWidth = areaWidth;\n\t\tcurrentHeight = imageHeight * areaWidth / imageWidth;\n\t}\n\n\treturn {\n\t\twidth: currentWidth,\n\t\theight: currentHeight,\n\t};\n}\n\n// eslint-disable-next-line no-unused-vars\nexport function defaultPosition ({ cropper, image, stencilWidth, stencilHeight, imageWidth, imageHeight,  props }) {\n\treturn {\n\t\tleft: imageWidth / 2 - stencilWidth / 2,\n\t\ttop: imageHeight / 2 - stencilHeight / 2,\n\t};\n}\n\n// eslint-disable-next-line no-unused-vars\nexport function defaultSize ({ cropper, image, minWidth, minHeight, maxWidth, maxHeight, imageWidth, imageHeight, aspectRatio, props }) {\n\tlet newHeight, newWidth;\n\tlet areaWidth = imageWidth;\n\tlet areaHeight = imageHeight;\n\n\tconst ratio = imageWidth > imageHeight ? aspectRatio.maximum : aspectRatio.minimum;\n\n\tif (imageWidth / imageHeight > aspectRatio.maximum || imageWidth / imageHeight < aspectRatio.minimum) {\n\t\tif (ratio <= 1) {\n\t\t\tareaHeight = imageHeight;\n\t\t\tareaWidth = areaHeight * aspectRatio.maximum;\n\t\t} else {\n\t\t\tareaWidth = imageWidth;\n\t\t\tareaHeight = areaWidth / aspectRatio.minimum;\n\t\t}\n\t}\n\n\tnewHeight = Math.min(maxHeight, Math.max(minHeight, areaHeight * 0.8));\n\tnewWidth = Math.min(maxWidth, Math.max(minWidth, areaWidth * 0.8));\n\n\treturn {\n\t\theight: newHeight,\n\t\twidth: newWidth,\n\t};\n}\n\nexport function percentRestrictions({ minWidth, minHeight, maxWidth, maxHeight, imageWidth, imageHeight }) {\n\treturn {\n\t\tminWidth: minWidth / 100 * imageWidth,\n\t\tminHeight: minHeight / 100 * imageHeight,\n\t\tmaxWidth: maxWidth / 100 * imageWidth,\n\t\tmaxHeight: maxHeight / 100 * imageHeight,\n\t};\n}\n\n// The main point of this feature is calculating the needed position of stencil and parameters of world transforms\n// Real coordinates don't changes here\nexport function autoZoom({ coordinates, stencilCoordinates: originalStencilCoordinates, worldTransforms: originalWorldTransforms, coefficient, imageSize, allowedArea }) {\n\tconst worldTransforms = {\n\t\t...originalWorldTransforms\n\t};\n\n\tconst stencilCoordinates = {\n\t\twidth: worldTransforms.scale * coordinates.width / coefficient,\n\t\theight: worldTransforms.scale * coordinates.height / coefficient,\n\t\tleft: originalStencilCoordinates.left,\n\t\ttop: originalStencilCoordinates.top,\n\t};\n\n\tworldTransforms.shift.left -= (coordinates.left * worldTransforms.scale + worldTransforms.shift.left) - originalStencilCoordinates.left * coefficient;\n\tworldTransforms.shift.top -= (coordinates.top * worldTransforms.scale + worldTransforms.shift.top) - originalStencilCoordinates.top * coefficient;\n\n\t// 1. Scale the image, if the stencil is too big\n\tlet multiplier = 1;\n\tif (stencilCoordinates.width > imageSize.width / coefficient) {\n\t\tmultiplier = Math.min(multiplier, imageSize.width / coefficient / stencilCoordinates.width);\n\t}\n\tif (stencilCoordinates.height > imageSize.height / coefficient) {\n\t\tmultiplier = Math.min(multiplier, imageSize.height / coefficient / stencilCoordinates.height);\n\t}\n\n\tif (multiplier !== 1) {\n\t\tworldTransforms.scale *= multiplier;\n\t\tstencilCoordinates.left += stencilCoordinates.width * (1 - multiplier)/2;\n\t\tstencilCoordinates.top += stencilCoordinates.height * (1 - multiplier)/2;\n\t\tworldTransforms.shift.left = stencilCoordinates.left * coefficient - (coordinates.left) * worldTransforms.scale;\n\t\tworldTransforms.shift.top = stencilCoordinates.top * coefficient - (coordinates.top) * worldTransforms.scale;\n\t\tstencilCoordinates.width *= multiplier;\n\t\tstencilCoordinates.height *= multiplier;\n\t}\n\n\t// 2. Move the stencil to prevent breaking borders\n\tif (stencilCoordinates.left < 0) {\n\t\tworldTransforms.shift.left -= stencilCoordinates.left * coefficient;\n\t\tstencilCoordinates.left = 0;\n\t}\n\n\tif (stencilCoordinates.top < 0) {\n\t\tworldTransforms.shift.top -= stencilCoordinates.top * coefficient;\n\t\tstencilCoordinates.top = 0;\n\t}\n\n\tif (stencilCoordinates.left + stencilCoordinates.width > imageSize.width / coefficient) {\n\t\tworldTransforms.shift.left -= (stencilCoordinates.left + stencilCoordinates.width) * coefficient - imageSize.width;\n\t\tstencilCoordinates.left = imageSize.width / coefficient - stencilCoordinates.width;\n\t}\n\n\tif (stencilCoordinates.top + stencilCoordinates.height > imageSize.height / coefficient) {\n\t\tworldTransforms.shift.top -= (stencilCoordinates.top + stencilCoordinates.height) * coefficient - imageSize.height;\n\t\tstencilCoordinates.top = imageSize.height / coefficient - stencilCoordinates.height;\n\t}\n\n\t// 3. Move the image to prevent breaking borders:\n\tconst scaledImageSize = {\n\t\twidth: imageSize.width * worldTransforms.scale,\n\t\theight: imageSize.height * worldTransforms.scale,\n\t};\n\n\tif (worldTransforms.shift.left > -allowedArea.left * worldTransforms.scale) {\n\t\tstencilCoordinates.left -= (worldTransforms.shift.left + (allowedArea.left * worldTransforms.scale)) / coefficient;\n\t\tworldTransforms.shift.left = -(allowedArea.left * worldTransforms.scale);\n\t}\n\tif (worldTransforms.shift.left < imageSize.width - scaledImageSize.width - (allowedArea.right - imageSize.width) * worldTransforms.scale) {\n\t\tstencilCoordinates.left -= (worldTransforms.shift.left - (imageSize.width - scaledImageSize.width) + (allowedArea.right - imageSize.width) * worldTransforms.scale) / coefficient;\n\t\tworldTransforms.shift.left = imageSize.width - scaledImageSize.width - (allowedArea.right - imageSize.width) * worldTransforms.scale;\n\t}\n\tif (worldTransforms.shift.top > -allowedArea.top * worldTransforms.scale) {\n\t\tstencilCoordinates.top -= (worldTransforms.shift.top + (allowedArea.top * worldTransforms.scale)) / coefficient;\n\t\tworldTransforms.shift.top = -allowedArea.top * worldTransforms.scale;\n\t}\n\tif (worldTransforms.shift.top < imageSize.height - scaledImageSize.height - (allowedArea.bottom - imageSize.height) * worldTransforms.scale) {\n\t\tstencilCoordinates.top -= (worldTransforms.shift.top - (imageSize.height - scaledImageSize.height) + (allowedArea.bottom - imageSize.height) * worldTransforms.scale) / coefficient;\n\t\tworldTransforms.shift.top = imageSize.height - scaledImageSize.height - (allowedArea.bottom - imageSize.height) * worldTransforms.scale;\n\t}\n\n\treturn {\n\t\tstencilCoordinates,\n\t\tworldTransforms\n\t};\n}\n\nexport function manipulateImage({ manipulateImageEvent, coordinates, stencilRestrictions, coefficient, stencilCoordinates, worldTransforms: originalWorldTransforms, imageSize, frozenDirections, allowedArea, fitImage }) {\n\tlet { scale, move } = manipulateImageEvent;\n\tconst worldTransforms = { ...originalWorldTransforms };\n\n\tconst scaledImageSize = {\n\t\twidth: imageSize.width * worldTransforms.scale,\n\t\theight: imageSize.height * worldTransforms.scale,\n\t};\n\n\tconst imageShifts = {\n\t\tleft: move.left || 0,\n\t\ttop: move.top || 0,\n\t};\n\n\tlet scaleImage = 1;\n\tlet scaleStencil = 1;\n\n\tconst minScale = !fitImage ? Math.max(\n\t\t('left' in allowedArea && 'right' in allowedArea) ? stencilCoordinates.width * coefficient / (allowedArea.right - allowedArea.left) : 1e-2,\n\t\t('top' in allowedArea && 'bottom' in allowedArea) ? stencilCoordinates.height * coefficient / (allowedArea.bottom - allowedArea.top) : 1e-2,\n\t) : 1;\n\n\t// If there is scaling then begin scale\n\tif (!frozenDirections.width && !frozenDirections.height && Math.abs(scale.factor - 1) > 1e-3) {\n\t\tconst epsilon = Math.abs(1 - scaleImage) / 2;\n\t\tconst { maxWidth, maxHeight, minWidth, minHeight } = stencilRestrictions;\n\n\t\tscaleImage = scale.factor;\n\n\t\t// Determine allowed resize:\n\t\tif (worldTransforms.scale / scaleImage < minScale + epsilon) {\n\t\t\tscaleImage = worldTransforms.scale / minScale;\n\t\t}\n\n\t\tlet width = coordinates.width * scaleImage;\n\t\tlet height = coordinates.height * scaleImage;\n\n\t\t// Prevent breaking the restrictions\n\t\tconst breaks = {\n\t\t\tminWidth: width < minWidth + epsilon,\n\t\t\tminHeight: height < minHeight + epsilon,\n\t\t\tmaxWidth: width > maxWidth - epsilon,\n\t\t\tmaxHeight: height > maxHeight - epsilon,\n\t\t};\n\n\t\tif (breaks.minWidth) {\n\t\t\tscaleImage = minWidth / coordinates.width;\n\t\t}\n\t\tif (breaks.minHeight) {\n\t\t\tscaleImage = minHeight / coordinates.height;\n\t\t}\n\t\tif (breaks.maxHeight || breaks.maxWidth) {\n\t\t\tlet allowedImageScale = scaleImage;\n\t\t\tif (breaks.maxWidth && breaks.maxHeight) {\n\t\t\t\tallowedImageScale = Math.min(maxHeight / coordinates.height, coordinates.width);\n\t\t\t} else if (breaks.maxHeight) {\n\t\t\t\tallowedImageScale = maxHeight / coordinates.height;\n\t\t\t} else if (breaks.maxWidth) {\n\t\t\t\tallowedImageScale = maxWidth / coordinates.width;\n\t\t\t}\n\t\t\tif (worldTransforms.scale * scaleImage >= 1) {\n\t\t\t\tscaleStencil = allowedImageScale / scaleImage;\n\t\t\t} else {\n\t\t\t\tscaleImage = allowedImageScale;\n\t\t\t}\n\t\t}\n\n\t\tconst imageSizeChanges = {\n\t\t\twidth: scaledImageSize.width * (1 - 1/scaleImage),\n\t\t\theight:  scaledImageSize.height * (1 - 1/scaleImage),\n\t\t};\n\n\t\timageShifts.left += imageSizeChanges.width * Math.abs((worldTransforms.shift.left - scale.center.left * coefficient) / scaledImageSize.width);\n\t\timageShifts.top += imageSizeChanges.height * Math.abs((worldTransforms.shift.top - scale.center.top * coefficient) / scaledImageSize.height);\n\n\t\tscaledImageSize.width /= scaleImage;\n\t\tscaledImageSize.height /= scaleImage;\n\t}\n\n\tworldTransforms.scale = worldTransforms.scale / scaleImage;\n\n\t// If the image should not break area boundaries we should change coordinates so they don't break them\n\t// otherwise we just prevent moving\n\tif (fitImage) {\n\t\tif (Math.ceil(worldTransforms.shift.left + imageShifts.left) > 0) {\n\t\t\timageShifts.left = -worldTransforms.shift.left;\n\t\t} else if (worldTransforms.shift.left + imageShifts.left < imageSize.width - scaledImageSize.width) {\n\t\t\timageShifts.left = imageSize.width - scaledImageSize.width  - worldTransforms.shift.left;\n\t\t}\n\n\t\tif (Math.ceil(worldTransforms.shift.top + imageShifts.top) > 0) {\n\t\t\timageShifts.top = -worldTransforms.shift.top;\n\t\t} else if (worldTransforms.shift.top + imageShifts.top < imageSize.height - scaledImageSize.height) {\n\t\t\timageShifts.top = imageSize.height - scaledImageSize.height - worldTransforms.shift.top;\n\t\t}\n\t} else {\n\t\tconst breaks = {};\n\t\tALL_DIRECTIONS.forEach(side => {\n\t\t\tif (side in allowedArea) {\n\t\t\t\tbreaks[side] = (worldTransforms.shift[mainSide(side)] + imageShifts[mainSide(side)]) + (allowedArea[side] * worldTransforms.scale - allSides(stencilCoordinates)[side] * coefficient);\n\t\t\t} else {\n\t\t\t\tbreaks[side] = 0;\n\t\t\t}\n\t\t});\n\n\t\t// Process the moving:\n\t\tif (breaks.left > 0) {\n\t\t\timageShifts.left -= breaks.left;\n\t\t} else if (breaks.right < 0) {\n\t\t\timageShifts.left -= breaks.right;\n\t\t}\n\t\tif (breaks.top > 0) {\n\t\t\timageShifts.top -= breaks.top;\n\t\t} else if (breaks.bottom < 0) {\n\t\t\timageShifts.top -= breaks.bottom;\n\t\t}\n\t}\n\n\tworldTransforms.shift.left += imageShifts.left;\n\tworldTransforms.shift.top += imageShifts.top;\n\n\tconst stencilResizeAmends = { left: 0, top: 0 };\n\tif (imageSize.width !== coordinates.width && worldTransforms.scale >= 1) {\n\t\tstencilResizeAmends.left = stencilCoordinates.width * (1 - scaleStencil) * (coordinates.left / (imageSize.width - coordinates.width));\n\t}\n\tif (imageSize.height !== coordinates.height && worldTransforms.scale >= 1) {\n\t\tstencilResizeAmends.top = stencilCoordinates.height * (1 - scaleStencil) * (coordinates.top / (imageSize.height - coordinates.height));\n\t}\n\n\treturn {\n\t\tcoordinates: {\n\t\t\twidth: coordinates.width * scaleImage * scaleStencil,\n\t\t\theight: coordinates.height * scaleImage * scaleStencil,\n\t\t\tleft: (stencilCoordinates.left - worldTransforms.shift.left / coefficient + stencilResizeAmends.left) * coefficient / worldTransforms.scale,\n\t\t\ttop: (stencilCoordinates.top - worldTransforms.shift.top / coefficient + stencilResizeAmends.top) * coefficient / worldTransforms.scale,\n\t\t},\n\t\tworldTransforms\n\t};\n}\n\nexport function allowedArea({ breakBoundaries, imageSize, worldTransforms, imageRestriction }) {\n\tlet limits = {};\n\n\tif (imageRestriction !== 'none') {\n\t\tlimits = {\n\t\t\tleft: 0,\n\t\t\ttop: 0,\n\t\t\tright: imageSize.width,\n\t\t\tbottom: imageSize.height\n\t\t};\n\t}\n\n\tif (!breakBoundaries) {\n\t\tconst boundaries = {\n\t\t\tleft: -worldTransforms.shift.left / worldTransforms.scale,\n\t\t\ttop: -worldTransforms.shift.top / worldTransforms.scale,\n\t\t\tright: (imageSize.width - worldTransforms.shift.left) / worldTransforms.scale,\n\t\t\tbottom: (imageSize.height - worldTransforms.shift.top) / worldTransforms.scale\n\t\t};\n\t\tALL_DIRECTIONS.forEach(direction => {\n\t\t\tif (!isUndefined(limits[direction])) {\n\t\t\t\tif (direction === 'left' || direction === 'top') {\n\t\t\t\t\tlimits[direction] = Math.max(limits[direction], boundaries[direction]);\n\t\t\t\t} else {\n\t\t\t\t\tlimits[direction] = Math.min(limits[direction], boundaries[direction]);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tlimits[direction] = boundaries[direction];\n\t\t\t}\n\t\t});\n\t}\n\treturn limits;\n}\n\nexport function roundCoordinates({ coordinates, restrictions, allowedArea }) {\n\tconst roundedCoordinates = {\n\t\twidth: Math.round(coordinates.width),\n\t\theight: Math.round(coordinates.height),\n\t\tleft: Math.round(coordinates.left),\n\t\ttop: Math.round(coordinates.top),\n\t};\n\n\tif (roundedCoordinates.width > restrictions.maxWidth) {\n\t\troundedCoordinates.width = Math.floor(coordinates.width);\n\t} else if (roundedCoordinates.width < restrictions.minWidth) {\n\t\troundedCoordinates.width = Math.ceil(coordinates.width);\n\t}\n\tif (roundedCoordinates.height > restrictions.maxHeight) {\n\t\troundedCoordinates.height = Math.floor(coordinates.height);\n\t} else if (roundedCoordinates.height < restrictions.minHeight) {\n\t\troundedCoordinates.height = Math.ceil(coordinates.height);\n\t}\n\tif (roundedCoordinates.left < allowedArea.left || roundedCoordinates.left + roundedCoordinates.width > allowedArea.right) {\n\t\troundedCoordinates.left = Math.floor(allowedArea.left);\n\t}\n\tif (roundedCoordinates.top < allowedArea.top || roundedCoordinates.top + roundedCoordinates.height > allowedArea.bottom) {\n\t\troundedCoordinates.top = Math.floor(allowedArea.top);\n\t}\n\n\treturn roundedCoordinates;\n}\n","import { XHR_DONE } from './constants';\r\n\r\nexport function prepareSource(canvas, image, { flipped, orientation, }) {\r\n\tconst width = image.naturalWidth;\r\n\tconst height = image.naturalHeight;\r\n\r\n\tconst ctx = canvas.getContext('2d');\r\n\tcanvas.width = width;\r\n\tcanvas.height = height;\r\n\r\n\tctx.save();\r\n\r\n\tif (flipped) {\r\n\t\tcanvas.width = height;\r\n\t\tcanvas.height = width;\r\n\t}\r\n\r\n\t// TODO: refactor this\r\n\tif (orientation == 2) {\r\n\t\tctx.translate(width, 0);\r\n\t\tctx.scale(-1, 1);\r\n\t} else if (orientation == 3) {\r\n\t\tctx.translate(width, height);\r\n\t\tctx.rotate(180 / 180 * Math.PI);\r\n\t} else if (orientation == 4) {\r\n\t\tctx.translate(0, height);\r\n\t\tctx.scale(1, -1);\r\n\t} else if (orientation == 5) {\r\n\t\tctx.rotate(90 / 180 * Math.PI);\r\n\t\tctx.scale(1, -1);\r\n\t} else if (orientation == 6) {\r\n\t\tctx.rotate(90 / 180 * Math.PI);\r\n\t\tctx.translate(0, -height);\r\n\t} else if (orientation == 7) {\r\n\t\tctx.rotate(270 / 180 * Math.PI);\r\n\t\tctx.translate(-width, height);\r\n\t\tctx.scale(1, -1);\r\n\t} else if (orientation == 8) {\r\n\t\tctx.translate(0, width);\r\n\t\tctx.rotate(270 / 180 * Math.PI);\r\n\t}\r\n\r\n\tctx.drawImage(image, 0, 0, width, height);\r\n\tctx.restore();\r\n\r\n\treturn canvas;\r\n}\r\n\r\nexport function getImageTransforms(orientation) {\r\n\tlet result = {\r\n\t\torientation,\r\n\t};\r\n\tif (orientation) {\r\n\t\tswitch (orientation) {\r\n\t\tcase 2:\r\n\t\t\tresult.scaleX = -1;\r\n\t\t\tbreak;\r\n\t\tcase 3:\r\n\t\t\tresult.rotate = -180;\r\n\t\t\tbreak;\r\n\t\tcase 4:\r\n\t\t\tresult.scaleY = -1;\r\n\t\t\tbreak;\r\n\t\tcase 5:\r\n\t\t\tresult.rotate = 90;\r\n\t\t\tresult.scaleY = -1;\r\n\t\t\tbreak;\r\n\t\tcase 6:\r\n\t\t\tresult.rotate = 90;\r\n\t\t\tbreak;\r\n\t\tcase 7:\r\n\t\t\tresult.rotate = 90;\r\n\t\t\tresult.scaleX = -1;\r\n\t\t\tbreak;\r\n\t\tcase 8:\r\n\t\t\tresult.rotate = -90;\r\n\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n\tif (result.rotate === 90 || result.rotate === -90) {\r\n\t\tresult.flipped = true;\r\n\t}\r\n\treturn result;\r\n}\r\n\r\nexport function getStyleTransforms({ rotate, scaleX, scaleY, }) {\r\n\tlet transform = '';\r\n\tif (rotate || scaleX || scaleY) {\r\n\t\tif (rotate) {\r\n\t\t\ttransform += ` rotate(${rotate}deg) `;\r\n\t\t}\r\n\t\tif (scaleX) {\r\n\t\t\ttransform += ` scaleX(${scaleX}) `;\r\n\t\t}\r\n\t\tif (scaleY) {\r\n\t\t\ttransform += ` scaleY(${scaleY}) `;\r\n\t\t}\r\n\t}\r\n\treturn transform;\r\n}\r\n\r\nexport function parseImage(src) {\r\n\treturn new Promise((resolve) => {\r\n\t\tgetImageData(src)\r\n\t\t\t.then(data => {\r\n\t\t\t\tresolve(data ?\r\n\t\t\t\t\t{ source: src, arrayBuffer: data, orientation: getOrientation(data) } :\r\n\t\t\t\t\t{ source: src, arrayBuffer: null, orientation: null }\r\n\t\t\t\t);\r\n\t\t\t})\r\n\t\t\t.catch((error) => {\r\n\t\t\t\tconsole.warn(error);\r\n\t\t\t\tresolve({ source: src, arrayBuffer: null, orientation: null, });\r\n\t\t\t});\r\n\t});\r\n}\r\n\r\nfunction getImageData(img) {\r\n\treturn new Promise((resolve, reject) => {\r\n\t\ttry {\r\n\t\t\tif (img) {\r\n\t\t\t\t// Data URL\r\n\t\t\t\tif (/^data:/i.test(img)) {\r\n\t\t\t\t\tresolve(base64ToArrayBuffer(img));\r\n\t\t\t\t// Blob\r\n\t\t\t\t} else if (/^blob:/i.test(img)) {\r\n\t\t\t\t\tconst fileReader = new FileReader();\r\n\t\t\t\t\tfileReader.onload = function (e) {\r\n\t\t\t\t\t\tresolve(e.target.result);\r\n\t\t\t\t\t};\r\n\t\t\t\t\tobjectURLToBlob(img, function (blob) {\r\n\t\t\t\t\t\tfileReader.readAsArrayBuffer(blob);\r\n\t\t\t\t\t});\r\n\t\t\t\t// Simple URL\r\n\t\t\t\t} else {\r\n\t\t\t\t\tlet http = new XMLHttpRequest();\r\n\t\t\t\t\thttp.onreadystatechange = function () {\r\n\t\t\t\t\t\tif (http.readyState !== XHR_DONE) return;\r\n\r\n\t\t\t\t\t\tif (http.status === 200 || http.status === 0) {\r\n\t\t\t\t\t\t\tresolve(http.response);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\treject('Warning: could not load an image to parse its orientation');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\thttp = null;\r\n\t\t\t\t\t};\r\n\t\t\t\t\thttp.onprogress = function () {\r\n\t\t\t\t\t\t// Abort the request directly if it not a JPEG image for better performance\r\n\t\t\t\t\t\tif (http.getResponseHeader('content-type') !== 'image/jpeg') {\r\n\t\t\t\t\t\t\thttp.abort();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t};\r\n\t\t\t\t\thttp.withCredentials  = false;\r\n\t\t\t\t\thttp.open('GET', img, true);\r\n\t\t\t\t\thttp.responseType = 'arraybuffer';\r\n\t\t\t\t\thttp.send(null);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\treject('Error: the image is empty');\r\n\t\t\t}\r\n\t\t} catch (e) {\r\n\t\t\treject(e);\r\n\t\t}\r\n\t});\r\n}\r\n\r\nfunction objectURLToBlob(url, callback) {\r\n\tconst http = new XMLHttpRequest();\r\n\thttp.open('GET', url, true);\r\n\thttp.responseType = 'blob';\r\n\thttp.onload = function () {\r\n\t\tif (this.status == 200 || this.status === 0) {\r\n\t\t\tcallback(this.response);\r\n\t\t}\r\n\t};\r\n\thttp.send();\r\n}\r\n\r\nfunction base64ToArrayBuffer(base64) {\r\n\tbase64 = base64.replace(/^data:([^;]+);base64,/gmi, '');\r\n\tconst binary = atob(base64);\r\n\tconst len = binary.length;\r\n\tconst buffer = new ArrayBuffer(len);\r\n\tconst view = new Uint8Array(buffer);\r\n\tfor (let i = 0; i < len; i++) {\r\n\t\tview[i] = binary.charCodeAt(i);\r\n\t}\r\n\treturn buffer;\r\n}\r\nfunction getStringFromCharCode(dataView, start, length) {\r\n\tlet str = '';\r\n\tlet i;\r\n\tfor (i = start, length += start; i < length; i++) {\r\n\t\tstr += String.fromCharCode(dataView.getUint8(i));\r\n\t}\r\n\treturn str;\r\n}\r\n\r\nfunction getOrientation(arrayBuffer) {\r\n\ttry {\r\n\t\tconst dataView = new DataView(arrayBuffer);\r\n\t\tlet orientation;\r\n\t\tlet exifIDCode;\r\n\t\tlet tiffOffset;\r\n\t\tlet littleEndian;\r\n\t\tlet app1Start;\r\n\t\tlet ifdStart;\r\n\t\t// Only handle JPEG image (start by 0xFFD8)\r\n\t\tif (dataView.getUint8(0) === 0xFF && dataView.getUint8(1) === 0xD8) {\r\n\t\t\tconst length = dataView.byteLength;\r\n\t\t\tlet offset = 2;\r\n\t\t\twhile (offset + 1 < length) {\r\n\t\t\t\tif (dataView.getUint8(offset) === 0xFF && dataView.getUint8(offset + 1) === 0xE1) {\r\n\t\t\t\t\tapp1Start = offset;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\toffset++;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (app1Start) {\r\n\t\t\texifIDCode = app1Start + 4;\r\n\t\t\ttiffOffset = app1Start + 10;\r\n\t\t\tif (getStringFromCharCode(dataView, exifIDCode, 4) === 'Exif') {\r\n\t\t\t\tconst endianness = dataView.getUint16(tiffOffset);\r\n\r\n\t\t\t\tlittleEndian = endianness === 0x4949;\r\n\r\n\t\t\t\tif (littleEndian || endianness === 0x4D4D /* bigEndian */) {\r\n\t\t\t\t\tif (dataView.getUint16(tiffOffset + 2, littleEndian) === 0x002A) {\r\n\t\t\t\t\t\tconst firstIFDOffset = dataView.getUint32(tiffOffset + 4, littleEndian);\r\n\t\t\t\t\t\tif (firstIFDOffset >= 0x00000008) {\r\n\t\t\t\t\t\t\tifdStart = tiffOffset + firstIFDOffset;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (ifdStart) {\r\n\t\t\tconst length = dataView.getUint16(ifdStart, littleEndian);\r\n\r\n\t\t\tfor (let i = 0; i < length; i++) {\r\n\t\t\t\tlet offset = ifdStart + (i * 12) + 2;\r\n\t\t\t\tif (dataView.getUint16(offset, littleEndian) === 0x0112 /* Orientation */) {\r\n\t\t\t\t\t// 8 is the offset of the current tag's value\r\n\t\t\t\t\toffset += 8;\r\n\t\t\t\t\t// Get the original orientation value\r\n\t\t\t\t\torientation = dataView.getUint16(offset, littleEndian);\r\n\t\t\t\t\t// Override the orientation with its default value\r\n\t\t\t\t\tdataView.setUint16(offset, 1, littleEndian);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn orientation;\r\n\t} catch (error) {\r\n\t\treturn null;\r\n\t}\r\n}\r\n\r\nexport function arrayBufferToDataURL(arrayBuffer) {\r\n\tconst chunks = [];\r\n\r\n\t// Chunk Typed Array for better performance (#435)\r\n\tconst chunkSize = 8192;\r\n\tlet uint8 = new Uint8Array(arrayBuffer);\r\n\r\n\twhile (uint8.length > 0) {\r\n\t\tconst value = uint8.subarray(0, chunkSize);\r\n\t\tchunks.push(String.fromCharCode.apply(\r\n\t\t\tnull,\r\n\t\t\tArray.from ? Array.from(value) : Array.slice(value)\r\n\t\t));\r\n\t\tuint8 = uint8.subarray(chunkSize);\r\n\t}\r\n\r\n\treturn `data:image/jpeg;base64,${btoa(chunks.join(''))}`;\r\n}\r\n","/**\n * Returns a function, that, as long as it continues to be invoked, will not\n * be triggered. The function will be called after it stops being called for\n * N milliseconds. If `immediate` is passed, trigger the function on the\n * leading edge, instead of the trailing. The function also has a property 'clear' \n * that is a function which will clear the timer to prevent previously scheduled executions. \n *\n * @source underscore.js\n * @see http://unscriptable.com/2009/03/20/debouncing-javascript-methods/\n * @param {Function} function to wrap\n * @param {Number} timeout in ms (`100`)\n * @param {Boolean} whether to execute at the beginning (`false`)\n * @api public\n */\nfunction debounce(func, wait, immediate){\n  var timeout, args, context, timestamp, result;\n  if (null == wait) wait = 100;\n\n  function later() {\n    var last = Date.now() - timestamp;\n\n    if (last < wait && last >= 0) {\n      timeout = setTimeout(later, wait - last);\n    } else {\n      timeout = null;\n      if (!immediate) {\n        result = func.apply(context, args);\n        context = args = null;\n      }\n    }\n  };\n\n  var debounced = function(){\n    context = this;\n    args = arguments;\n    timestamp = Date.now();\n    var callNow = immediate && !timeout;\n    if (!timeout) timeout = setTimeout(later, wait);\n    if (callNow) {\n      result = func.apply(context, args);\n      context = args = null;\n    }\n\n    return result;\n  };\n\n  debounced.clear = function() {\n    if (timeout) {\n      clearTimeout(timeout);\n      timeout = null;\n    }\n  };\n  \n  debounced.flush = function() {\n    if (timeout) {\n      result = func.apply(context, args);\n      context = args = null;\n      \n      clearTimeout(timeout);\n      timeout = null;\n    }\n  };\n\n  return debounced;\n};\n\n// Adds compatibility for ES modules\ndebounce.debounce = debounce;\n\nmodule.exports = debounce;\n","export function directionNames (hDirection, vDirection) {\n\tlet name, classname;\n\tif (hDirection && vDirection) {\n\t\tname = `${hDirection}${vDirection[0].toUpperCase()}${vDirection.slice(1)}`;\n\t\tclassname = `${hDirection}-${vDirection}`;\n\t} else {\n\t\tname = hDirection || vDirection;\n\t\tclassname = hDirection || vDirection;\n\t}\n\treturn { name, classname, };\n}\n\nexport function isLocal(url) {\n\treturn /^data:/.test(url) || /^blob:/.test(url);\n}\n\nexport function isCrossOriginURL(url) {\n\tif (isLocal(url)) {\n\t\treturn false;\n\t}\n\tconst pageLocation = window.location;\n\tconst URL_HOST_PATTERN = /(\\w+:)?(?:\\/\\/)([\\w.-]+)?(?::(\\d+))?\\/?/;\n\tconst urlMatch = URL_HOST_PATTERN.exec(url) || [];\n\tconst urlparts = {\n\t\tprotocol:   urlMatch[1] || '',\n\t\thost:       urlMatch[2] || '',\n\t\tport:       urlMatch[3] || '',\n\t};\n\n\tconst defaultPort = (protocol) => {\n\t\treturn { 'http:':80, 'https:':443, }[protocol];\n\t};\n\n\tconst portOf = (location) => {\n\t\treturn location.port || defaultPort(location.protocol || pageLocation.protocol);\n\t};\n\n\treturn !((!urlparts.protocol && !urlparts.host && !urlparts.port) ||\n\t\tBoolean((urlparts.protocol  && (urlparts.protocol  == pageLocation.protocol)) &&\n\t\t\t\t\t\t\t\t\t(urlparts.host      && (urlparts.host       == pageLocation.host))     &&\n\t\t\t\t\t\t\t\t\t(urlparts.host      && (portOf(urlparts)    == portOf(pageLocation)))\n\t\t));\n}\n\nexport function isUndefined(obj) {\n\treturn typeof obj === 'undefined';\n}\n\nexport function isObject(obj) {\n\treturn typeof obj === 'object' && obj !== null;\n}\n\nexport function addTimestamp(url) {\n\tconst timestamp = `timestamp=${(new Date()).getTime()}`;\n\treturn url + (url.indexOf('?') === -1 ? '?' : '&') + timestamp;\n}\n\nexport function distance(firstPoint, secondPoint) {\n\treturn Math.sqrt(\n\t\tMath.pow(firstPoint.x - secondPoint.x, 2) + Math.pow(firstPoint.y - secondPoint.y, 2)\n\t);\n}\n\nexport function getSettings(param, defaultParams = {}) {\n\tlet result = {\n\t\tenabled: Boolean(param),\n\t\t...defaultParams\n\t};\n\tif (isObject(param)) {\n\t\tresult = { ...result, ...param };\n\t}\n\treturn result;\n}\n\nexport function parseNumber(number) {\n\tconst parsedNumber = Number(number);\n\tif (Number.isNaN(parsedNumber)) {\n\t\treturn number;\n\t} else {\n\t\treturn parsedNumber;\n\t}\n}\n","<script>\nimport classnames from 'classnames';\nimport bem from 'easy-bem';\nimport Vue from 'vue';\nimport debounce from 'debounce';\nimport { RectangleStencil } from './components/stencils';\nimport { CropperWrapper } from './components/service';\nimport { ResizeEvent, MoveEvent } from './core/events';\nimport { isLocal, isCrossOriginURL, isUndefined, addTimestamp, getSettings, parseNumber } from './core/utils';\nimport { arrayBufferToDataURL, getImageTransforms, getStyleTransforms, prepareSource, parseImage } from './core/image';\nimport { ALL_DIRECTIONS, MINIMAL_PERCENT_SIZE, IMAGE_RESTRICTIONS, DEFAULT_COORDINATES } from './core/constants';\nimport * as algorithms from './core/algorithms';\n\nconst cn = bem('vue-advanced-cropper');\n\nfunction migrateAlgorithm(f, name, transform) {\n\tfunction fallback(params) {\n\t\tconsole.warn(`The arguments will be passed to the prop '${name}' as an single object {${Object.keys(params).join(',')}} in the future releases. You should change the interface of your function.`);\n\t\treturn f(...transform(params));\n\t}\n\treturn (params) => {\n\t\tif (f.length > 1) {\n\t\t\treturn fallback(params);\n\t\t} else {\n\t\t\ttry {\n\t\t\t\treturn f(params);\n\t\t\t} catch (e) {\n\t\t\t\treturn fallback(params);\n\t\t\t}\n\t\t}\n\t};\n}\n\nexport default {\n\tname: 'Cropper',\n\tcomponents: {\n\t\tCropperWrapper\n\t},\n\tprops: {\n\t\tsrc: {\n\t\t\ttype: String,\n\t\t\tdefault: null,\n\t\t},\n\t\tbustCache: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\tallowedArea: {\n\t\t\ttype: Function,\n\t\t\tdefault: algorithms.allowedArea,\n\t\t},\n\t\tresizeAlgorithm: {\n\t\t\ttype: Function,\n\t\t\tdefault: algorithms.resize,\n\t\t},\n\t\tmoveAlgorithm: {\n\t\t\ttype: Function,\n\t\t\tdefault: algorithms.move,\n\t\t},\n\t\tdefaultSize: {\n\t\t\ttype: Function,\n\t\t\tdefault: algorithms.defaultSize,\n\t\t},\n\t\tdefaultPosition: {\n\t\t\ttype: Function,\n\t\t\tdefault: algorithms.defaultPosition,\n\t\t},\n\t\tareaSize: {\n\t\t\ttype: Function,\n\t\t\tdefault: algorithms.areaSize,\n\t\t},\n\t\trestrictions: {\n\t\t\ttype: Function,\n\t\t\tdefault: algorithms.percentRestrictions,\n\t\t},\n\t\tminWidth: {\n\t\t\ttype: [Number, String],\n\t\t},\n\t\tminHeight: {\n\t\t\ttype: [Number, String],\n\t\t},\n\t\tmaxWidth: {\n\t\t\ttype: [Number, String],\n\t\t},\n\t\tmaxHeight: {\n\t\t\ttype: [Number, String],\n\t\t},\n\t\tstencilComponent: {\n\t\t\ttype: [Object, String],\n\t\t\tdefault() {\n\t\t\t\treturn RectangleStencil;\n\t\t\t},\n\t\t},\n\t\tstencilProps: {\n\t\t\ttype: Object,\n\t\t\tdefault() {\n\t\t\t\treturn {};\n\t\t\t},\n\t\t},\n\t\tclassname: {\n\t\t\ttype: String,\n\t\t},\n\t\timageClassname: {\n\t\t\ttype: String,\n\t\t},\n\t\tareaClassname: {\n\t\t\ttype: String,\n\t\t},\n\t\tbackgroundClassname: {\n\t\t\ttype: String,\n\t\t},\n\t\tdebounce: {\n\t\t\ttype: Number,\n\t\t\tdefault: 500,\n\t\t},\n\t\tcanvas: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true,\n\t\t},\n\t\tcheckCrossOrigin: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true,\n\t\t},\n\t\tcheckOrientation: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true,\n\t\t},\n\t\tcrossOrigin: {\n\t\t\ttype: String,\n\t\t\tdefault: 'anonymous'\n\t\t},\n\t\ttransitionTime: {\n\t\t\ttype: Number,\n\t\t\tdefault: 300\n\t\t},\n\t\twheelResize: {\n\t\t\ttype: [Boolean, Object],\n\t\t\tdefault: true,\n\t\t},\n\t\ttouchResize: {\n\t\t\ttype: [Boolean, Object],\n\t\t\tdefault: true,\n\t\t},\n\t\ttouchMove: {\n\t\t\ttype: [Boolean, Object],\n\t\t\tdefault: true,\n\t\t},\n\t\tmouseMove: {\n\t\t\ttype: [Boolean, Object],\n\t\t\tdefault: true,\n\t\t},\n\t\timageRestriction: {\n\t\t\ttype: String,\n\t\t\tdefault: 'area',\n\t\t\tvalidator(value) {\n\t\t\t\treturn IMAGE_RESTRICTIONS.indexOf(value) !== -1;\n\t\t\t}\n\t\t},\n\t\troundResult: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true\n\t\t}\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tboundarySize: {\n\t\t\t\twidth: null,\n\t\t\t\theight: null,\n\t\t\t},\n\t\t\timageLoaded: false,\n\t\t\timageAttributes: {\n\t\t\t\tcrossOrigin: false,\n\t\t\t\tsrc: null,\n\t\t\t},\n\t\t\tbasicImageTransforms: {\n\t\t\t\trotate: null,\n\t\t\t\tscaleX: null,\n\t\t\t\tscaleY: null,\n\t\t\t},\n\t\t\timageSize: {\n\t\t\t\twidth: null,\n\t\t\t\theight: null,\n\t\t\t},\n\t\t\tcoordinates: {\n\t\t\t\t...DEFAULT_COORDINATES\n\t\t\t},\n\t\t\tstencilCoordinates: {\n\t\t\t\t...DEFAULT_COORDINATES\n\t\t\t},\n\t\t\tfrozenDirections: {\n\t\t\t\twidth: false,\n\t\t\t\theight: false,\n\t\t\t},\n\t\t\tworldTransforms: {\n\t\t\t\tscale: 1,\n\t\t\t\tshift: {\n\t\t\t\t\tleft: 0,\n\t\t\t\t\ttop: 0\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t},\n\tcomputed: {\n\t\tsettings() {\n\t\t\tconst settings = {\n\t\t\t\ttouchResize: getSettings(this.touchResize),\n\t\t\t\ttouchMove: getSettings(this.touchMove),\n\t\t\t\tmouseMove: getSettings(this.mouseMove),\n\t\t\t\twheelResize: getSettings(this.wheelResize, {\n\t\t\t\t\tratio: 0.1\n\t\t\t\t}),\n\t\t\t};\n\n\t\t\t// Disable some interactions for user convenience\n\t\t\tsettings.touchMove.enabled = settings.touchMove.enabled && (this.worldTransforms.scale !== 1 || this.imageRestriction !== 'area');\n\n\t\t\treturn settings;\n\t\t},\n\t\timageTransforms() {\n\t\t\treturn {\n\t\t\t\t...this.basicImageTransforms,\n\t\t\t\tscaleX: (this.basicImageTransforms.scaleX || 1) * this.worldTransforms.scale,\n\t\t\t\tscaleY: (this.basicImageTransforms.scaleY || 1) * this.worldTransforms.scale,\n\t\t\t\ttranslateX: this.worldTransforms.shift.left / this.coefficient + (this.imageSize.width * this.worldTransforms.scale - this.imageSize.width)/2/this.coefficient,\n\t\t\t\ttranslateY: this.worldTransforms.shift.top / this.coefficient + (this.imageSize.height * this.worldTransforms.scale - this.imageSize.height)/2/this.coefficient,\n\t\t\t};\n\t\t},\n\t\tcoefficient() {\n\t\t\treturn this.imageSize.width\n\t\t\t\t? this.imageSize.width / this.boundarySize.width\n\t\t\t\t: 0;\n\t\t},\n\t\tclasses() {\n\t\t\treturn {\n\t\t\t\tcropper: classnames(cn(), this.classname),\n\t\t\t\timage: classnames(cn('image'), this.imageClassname),\n\t\t\t\tarea: classnames(cn('area'), this.areaClassname),\n\t\t\t\tstretcher: classnames(cn('stretcher')),\n\t\t\t\tbackground: classnames(cn('background'), this.backgroundClassname),\n\t\t\t\timageWrapper: classnames(cn('image-wrapper')),\n\t\t\t\tcropperWrapper: classnames(cn('cropper-wrapper')),\n\t\t\t};\n\t\t},\n\t\twrapperStyle() {\n\t\t\treturn {\n\t\t\t\twidth: `${this.stencilCoordinates.width}px`,\n\t\t\t\theight: `${this.stencilCoordinates.height}px`,\n\t\t\t\tleft: `${this.stencilCoordinates.left}px`,\n\t\t\t\ttop: `${this.stencilCoordinates.top}px`,\n\t\t\t};\n\t\t},\n\t\tareaStyle() {\n\t\t\treturn {\n\t\t\t\twidth: this.boundarySize.width\n\t\t\t\t\t? `${this.boundarySize.width}px`\n\t\t\t\t\t: 'auto',\n\t\t\t\theight: this.boundarySize.height\n\t\t\t\t\t? `${this.boundarySize.height}px`\n\t\t\t\t\t: 'auto',\n\t\t\t\topacity: this.imageLoaded ? 1 : 0,\n\t\t\t\ttransition: `opacity ${this.transitionTime}ms`,\n\t\t\t\tpointerEvents: this.imageLoaded ? 'all' : 'none',\n\t\t\t};\n\t\t},\n\t\timageStyle() {\n\t\t\tconst result = {\n\t\t\t\tleft: `calc(50% + ${this.imageTransforms.translateX}px)`,\n\t\t\t\ttop: `calc(50% + ${this.imageTransforms.translateY}px)`,\n\t\t\t\ttransform: 'translate(-50%, -50%)' + getStyleTransforms(this.imageTransforms),\n\t\t\t};\n\t\t\tconst flipped = this.imageTransforms.flipped;\n\t\t\tif (flipped) {\n\t\t\t\tresult.width = `${this.boundarySize.height}px`;\n\t\t\t\tresult.height = `${this.boundarySize.width}px`;\n\t\t\t} else {\n\t\t\t\tresult.width = `${this.boundarySize.width}px`;\n\t\t\t\tresult.height = `${this.boundarySize.height}px`;\n\t\t\t}\n\t\t\treturn result;\n\t\t},\n\t\tstencilRestrictions() {\n\t\t\tconst minSize = Math.max(\n\t\t\t\tMINIMAL_PERCENT_SIZE * this.imageSize.width / this.coefficient / this.worldTransforms.scale,\n\t\t\t\tMINIMAL_PERCENT_SIZE * this.imageSize.height / this.coefficient / this.worldTransforms.scale,\n\t\t\t);\n\t\t\t\t\t\t\n\t\t\tconst oldRestrictions = {\n\t\t\t\tminWidth: !isUndefined(this.minWidth) ? this.minWidth : 0,\n\t\t\t\tminHeight: !isUndefined(this.minHeight) ? this.minHeight : 0,\n\t\t\t\tmaxWidth: !isUndefined(this.maxWidth) ? this.maxWidth : Infinity,\n\t\t\t\tmaxHeight: !isUndefined(this.maxHeight) ? this.maxHeight : Infinity,\n\t\t\t};\n\n\t\t\tconst restrictions = migrateAlgorithm(this.restrictions, 'restrictions', (args) => [\n\t\t\t\targs.minWidth, args.minHeight, args.maxWidth, args.maxHeight, args.imageWidth, args.imageHeight\n\t\t\t])({\n\t\t\t\tminWidth: parseNumber(oldRestrictions.minWidth),\n\t\t\t\tminHeight: parseNumber(oldRestrictions.minHeight),\n\t\t\t\tmaxWidth: parseNumber(oldRestrictions.maxWidth),\n\t\t\t\tmaxHeight: parseNumber(oldRestrictions.maxHeight),\n\t\t\t\timageWidth: this.imageSize.width,\n\t\t\t\timageHeight: this.imageSize.height,\n\t\t\t\tprops: this.$props\n\t\t\t});\n\n\t\t\tif (isUndefined(restrictions.minWidth)) {\n\t\t\t\trestrictions.minWidth = Math.floor(minSize);\n\t\t\t}\n\n\t\t\tif (isUndefined(restrictions.minHeight)) {\n\t\t\t\trestrictions.minHeight = Math.floor(minSize);\n\t\t\t}\n\n\t\t\tif (restrictions.minWidth > restrictions.maxWidth) {\n\t\t\t\tconsole.warn(`Warning: maximum width (${restrictions.maxWidth}px) fewer that the minimum width (${restrictions.minWidth}px). It is set equal to the minimum width and width resizing was blocked`);\n\t\t\t\trestrictions.maxWidth = restrictions.minWidth;\n\t\t\t\trestrictions.widthFrozen = true;\n\t\t\t}\n\n\t\t\tif (restrictions.minHeight > restrictions.maxHeight) {\n\t\t\t\tconsole.warn(`Warning: maximum height (${restrictions.maxHeight}px) fewer that the minimum height (${restrictions.minHeight}px). It is set equal to the minimum height and height resizing was blocked`);\n\t\t\t\trestrictions.maxHeight = restrictions.minHeight;\n\t\t\t\trestrictions.heightFrozen = true;\n\t\t\t}\n\n\t\t\tif (this.imageRestriction !== 'none') {\n\t\t\t\tif (!restrictions.maxWidth || (restrictions.maxWidth > this.imageSize.width)) {\n\t\t\t\t\trestrictions.maxWidth = this.imageSize.width;\n\t\t\t\t}\n\t\t\t\tif (!restrictions.maxHeight || (restrictions.maxHeight > this.imageSize.height)) {\n\t\t\t\t\trestrictions.maxHeight = this.imageSize.height;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// The magic number is the approximation of the handler size\n\t\t\t// Temporary solution that should be improved in the future\n\t\t\trestrictions.minimum = 20 * this.coefficient / this.worldTransforms.scale;\n\n\t\t\treturn restrictions;\n\t\t},\n\t},\n\twatch: {\n\t\tsrc() {\n\t\t\tthis.onChangeImage();\n\t\t},\n\t\tminWidth() {\n\t\t\tthis.onPropsChange();\n\t\t},\n\t\tmaxWidth() {\n\t\t\tthis.onPropsChange();\n\t\t},\n\t\tminHeight() {\n\t\t\tthis.onPropsChange();\n\t\t},\n\t\tmaxHeight() {\n\t\t\tthis.onPropsChange();\n\t\t},\n\t\timageRestriction() {\n\t\t\tthis.resetCoordinates();\n\t\t},\n\t\tstencilProps(oldProps, newProps) {\n\t\t\tconst significantProps = ['aspectRatio', 'minAspectRatio', 'maxAspectRatio'];\n\t\t\tif (significantProps.find(prop => oldProps[prop] !== newProps[prop])) {\n\t\t\t\tVue.nextTick(this.onPropsChange);\n\t\t\t}\n\t\t}\n\t},\n\tmounted() {\n\t\tthis.debouncedUpdate = debounce(\n\t\t\tthis.update,\n\t\t\tthis.debounce\n\t\t);\n\t\twindow.addEventListener('resize', this.onResizeWindow);\n\t\twindow.addEventListener('orientationchange', this.onResizeWindow);\n\t\tthis.$refs.image.addEventListener('load', () => {\n\t\t\tthis.onSuccessLoadImage();\n\t\t});\n\t\tthis.$refs.image.addEventListener('error', () => {\n\t\t\tthis.onFailLoadImage();\n\t\t});\n\t\tthis.onChangeImage();\n\t},\n\tdestroyed() {\n\t\twindow.removeEventListener('resize', this.refreshImage);\n\t\twindow.removeEventListener('orientationchange', this.refreshImage);\n\t},\n\tmethods: {\n\t\t// External methods\n\t\tgetResult() {\n\t\t\tconst coordinates = this.prepareResult({ ...this.coordinates });\n\t\t\tif (this.canvas && this.src && this.imageLoaded) {\n\t\t\t\tthis.updateCanvas(this.coordinates);\n\t\t\t\treturn {\n\t\t\t\t\tcoordinates,\n\t\t\t\t\tcanvas: this.$refs.canvas,\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\treturn {\n\t\t\t\t\tcoordinates,\n\t\t\t\t};\n\t\t\t}\n\t\t},\n\t\t// Internal methods\n\t\tprepareResult(coordinates) {\n\t\t\tif (this.roundResult) {\n\t\t\t\treturn algorithms.roundCoordinates({\n\t\t\t\t\tcoordinates,\n\t\t\t\t\trestrictions: this.restrictions,\n\t\t\t\t\tallowedArea: this.getAllowedArea()\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\treturn coordinates;\n\t\t\t}\n\t\t},\n\t\tgetArea() {\n\t\t\treturn this.$refs.area;\n\t\t},\n\t\tgetStencil() {\n\t\t\treturn this.$refs.stencil;\n\t\t},\n\t\tautoZoom(coordinates) {\n\t\t\tconst { worldTransforms, stencilCoordinates } = algorithms.autoZoom({\n\t\t\t\tcoordinates,\n\t\t\t\tstencilCoordinates: this.stencilCoordinates,\n\t\t\t\tworldTransforms: this.worldTransforms,\n\t\t\t\tcoefficient: this.coefficient,\n\t\t\t\timageSize: this.imageSize,\n\t\t\t\tallowedArea: this.getAllowedArea(true)\n\t\t\t});\n\n\t\t\tthis.worldTransforms = worldTransforms;\n\t\t\tthis.stencilCoordinates = stencilCoordinates;\n\t\t},\n\t\tupdateStencilCoordinates(coordinates) {\n\t\t\tconst { width, height, left, top, } = coordinates;\n\t\t\tthis.stencilCoordinates =  {\n\t\t\t\twidth: this.worldTransforms.scale * width / this.coefficient,\n\t\t\t\theight: this.worldTransforms.scale * height / this.coefficient,\n\t\t\t\tleft: (left * this.worldTransforms.scale + this.worldTransforms.shift.left) / this.coefficient,\n\t\t\t\ttop: (top * this.worldTransforms.scale + this.worldTransforms.shift.top) / this.coefficient,\n\t\t\t};\n\t\t},\n\t\tupdateCanvas(coordinates) {\n\t\t\t// This function can be asynchronously called because it's debounced\n\t\t\t// Therefore there is workaround to prevent processing after the component was unmounted\n\t\t\tif (!this.$refs.canvas) return;\n\n\t\t\tconst image = this.$refs.image;\n\t\t\tconst source = this.checkOrientation ? prepareSource(this.$refs.sourceCanvas, image, this.imageTransforms) : image;\n\n\t\t\tconst canvas = this.$refs.canvas;\n\t\t\tcanvas.width = coordinates.width;\n\t\t\tcanvas.height = coordinates.height;\n\n\t\t\tconst ctx = canvas.getContext('2d');\n\t\t\tctx.clearRect(0,0,canvas.width,canvas.height);\n\t\t\tctx.drawImage(\n\t\t\t\tsource,\n\t\t\t\tcoordinates.left,\n\t\t\t\tcoordinates.top,\n\t\t\t\tcoordinates.width,\n\t\t\t\tcoordinates.height,\n\t\t\t\t0,\n\t\t\t\t0,\n\t\t\t\tcoordinates.width,\n\t\t\t\tcoordinates.height\n\t\t\t);\n\t\t},\n\t\tupdate() {\n\t\t\tthis.$emit('change', this.getResult());\n\t\t},\n\t\tonResizeWindow() {\n\t\t\tconst image = this.$refs.image;\n\t\t\tif (this.src && image) {\n\t\t\t\tthis.refreshImage().then(() => {\n\t\t\t\t\tthis.updateStencilCoordinates(this.coordinates);\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\tonChangeCoordinates(newCoordinates, debounce = true) {\n\t\t\tthis.coordinates = newCoordinates;\n\t\t\tif (this.$listeners && this.$listeners.change) {\n\t\t\t\tif (debounce) {\n\t\t\t\t\tthis.debouncedUpdate();\n\t\t\t\t} else {\n\t\t\t\t\tthis.update();\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tonChangeImage() {\n\t\t\tthis.imageLoaded = false;\n\t\t\tthis.delayedTransforms = null;\n\t\t\tthis.imageAttributes.src = null;\n\n\t\t\tif (this.src) {\n\t\t\t\tconst crossOrigin = isCrossOriginURL(this.src);\n\t\t\t\tif (crossOrigin && this.canvas && this.checkCrossOrigin) {\n\t\t\t\t\tthis.imageAttributes.crossOrigin = this.crossOrigin;\n\t\t\t\t}\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tconst src = this.bustCache ? addTimestamp(this.src) : this.src;\n\t\t\t\t\tif (this.checkOrientation) {\n\t\t\t\t\t\tparseImage(src).then(this.onParseImage);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.onParseImage({\n\t\t\t\t\t\t\tsource: src\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}, this.transitionTime);\n\t\t\t} else {\n\t\t\t\tthis.clearImage();\n\t\t\t}\n\t\t},\n\t\tonFailLoadImage() {\n\t\t\tthis.clearImage();\n\t\t\tthis.$emit('error');\n\t\t},\n\t\tonSuccessLoadImage() {\n\t\t\t// After loading image the current component can be unmounted\n\t\t\t// Therefore there is a workaround to prevent processing the following code\n\t\t\tif (this.$refs.image && !this.imageLoaded) {\n\t\t\t\tthis.imageLoaded = true;\n\t\t\t\tthis.refreshImage().then(() => {\n\t\t\t\t\tthis.resetCoordinates();\n\t\t\t\t\tthis.$emit('ready');\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\tonParseImage({ source, arrayBuffer, orientation }) {\n\t\t\tif (arrayBuffer && orientation && isLocal(source)) {\n\t\t\t\tthis.imageAttributes.src = arrayBufferToDataURL(arrayBuffer);\n\t\t\t} else {\n\t\t\t\tthis.imageAttributes.src = source;\n\t\t\t}\n\t\t\tthis.basicImageTransforms = getImageTransforms(orientation);\n\t\t\tVue.nextTick(() => {\n\t\t\t\tconst image = this.$refs.image;\n\t\t\t\tif (image && image.complete) {\n\t\t\t\t\tif (image.naturalWidth) {\n\t\t\t\t\t\tthis.onSuccessLoadImage();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.onFailLoadImage();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tonResize(resizeEvent) {\n\t\t\tif (this.frozenDirections.width) {\n\t\t\t\tresizeEvent.directions.left = 0;\n\t\t\t\tresizeEvent.directions.right = 0;\n\t\t\t}\n\t\t\tif (this.frozenDirections.height) {\n\t\t\t\tresizeEvent.directions.top = 0;\n\t\t\t\tresizeEvent.directions.bottom = 0;\n\t\t\t}\n\t\t\tALL_DIRECTIONS.forEach(direction => {\n\t\t\t\tresizeEvent.directions[direction] /= this.worldTransforms.scale / this.coefficient;\n\t\t\t});\n\t\t\tthis.onChangeCoordinates(\n\t\t\t\tthis.resizeAlgorithm({\n\t\t\t\t\tcoordinates: this.coordinates,\n\t\t\t\t\trestrictions: this.stencilRestrictions,\n\t\t\t\t\tallowedArea: this.getAllowedArea(),\n\t\t\t\t\taspectRatio: this.stencilAspectRatios(),\n\t\t\t\t\tresizeEvent\n\t\t\t\t})\n\t\t\t);\n\t\t\tthis.updateStencilCoordinates(this.coordinates);\n\t\t},\n\t\tonManipulateImage(manipulateImageEvent) {\n\t\t\tif (manipulateImageEvent.move.left) {\n\t\t\t\tmanipulateImageEvent.move.left *= this.coefficient;\n\t\t\t}\n\t\t\tif (manipulateImageEvent.move.top) {\n\t\t\t\tmanipulateImageEvent.move.top *= this.coefficient;\n\t\t\t}\n\t\t\tconst { worldTransforms, coordinates } = algorithms.manipulateImage({\n\t\t\t\tmanipulateImageEvent,\n\t\t\t\tcoordinates: this.coordinates,\n\t\t\t\tcoefficient: this.coefficient,\n\t\t\t\tstencilRestrictions: this.stencilRestrictions,\n\t\t\t\timageSize: this.imageSize,\n\t\t\t\tfrozenDirections: this.frozenDirections,\n\t\t\t\tstencilCoordinates: this.stencilCoordinates,\n\t\t\t\tworldTransforms: this.worldTransforms,\n\t\t\t\tallowedArea: this.getAllowedArea(true),\n\t\t\t\tminScale: this.imageRestriction === 'none' ? MINIMAL_PERCENT_SIZE : 1,\n\t\t\t\tfitImage: this.imageRestriction === 'area'\n\t\t\t});\n\t\t\tthis.worldTransforms = worldTransforms;\n\t\t\tthis.onChangeCoordinates(coordinates);\n\t\t\tthis.updateStencilCoordinates(coordinates);\n\t\t},\n\t\tonMove(moveEvent) {\n\t\t\tALL_DIRECTIONS.forEach(direction => {\n\t\t\t\tmoveEvent.directions[direction] /= this.worldTransforms.scale / this.coefficient;\n\t\t\t});\n\t\t\tthis.onChangeCoordinates(\n\t\t\t\tthis.moveAlgorithm({\n\t\t\t\t\tcoordinates: this.coordinates,\n\t\t\t\t\tallowedArea: this.getAllowedArea(),\n\t\t\t\t\tmoveEvent\n\t\t\t\t})\n\t\t\t);\n\t\t\tthis.updateStencilCoordinates(this.coordinates);\n\t\t},\n\t\tdefaultCoordinates() {\n\t\t\tconst aspectRatio = this.stencilAspectRatios();\n\t\t\tconst { minWidth, minHeight, maxWidth, maxHeight } = this.stencilRestrictions;\n\t\t\tconst imageSize = this.imageSize;\n\n\t\t\tlet coordinates = {};\n\t\t\tif (!aspectRatio.minimum && !aspectRatio.maximum) {\n\t\t\t\tcoordinates.height = minHeight;\n\t\t\t\tcoordinates.width = minWidth;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tlet ranges = {\n\t\t\t\t\twidth: {\n\t\t\t\t\t\tmaximum: aspectRatio.minimum ? Math.min(maxHeight, minWidth / aspectRatio.minimum) : maxHeight,\n\t\t\t\t\t\tminimum: aspectRatio.maximum ? Math.max(minHeight, minWidth / aspectRatio.maximum) : minHeight,\n\t\t\t\t\t},\n\t\t\t\t\theight: {\n\t\t\t\t\t\tmaximum: aspectRatio.maximum ? Math.min(maxWidth, minHeight * aspectRatio.maximum) : maxWidth,\n\t\t\t\t\t\tminimum: aspectRatio.minimum ? Math.max(minWidth, minHeight * aspectRatio.minimum) : minWidth,\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\tif (ranges.width.maximum >= ranges.width.minimum) {\n\t\t\t\t\tcoordinates.width = minWidth;\n\t\t\t\t\tcoordinates.height = ranges.width.minimum;\n\t\t\t\t} else if (ranges.height.maximum >= ranges.height.minimum) {\n\t\t\t\t\tcoordinates.height = minHeight;\n\t\t\t\t\tcoordinates.width = ranges.height.minimum;\n\t\t\t\t} else {\n\t\t\t\t\tthrow 'Error: current aspect ratio is incompatible with minimum/maximum height and width settings. Can\\'t setup default coordinates';\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tcoordinates.left = imageSize.width / 2 - coordinates.width / 2;\n\t\t\tcoordinates.top = imageSize.height / 2 - coordinates.height / 2;\n\n\t\t\treturn coordinates;\n\t\t},\n\t\tsetCoordinates(transforms, params = {}) {\n\t\t\tconst { autoZoom = true } = params;\n\t\t\tVue.nextTick(() => {\n\t\t\t\tif (!this.imageLoaded) {\n\t\t\t\t\tthis.delayedTransforms = transforms;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis.applyTransforms(transforms, autoZoom);\n\t\t\t});\n\t\t},\n\t\tonPropsChange() {\n\t\t\tthis.applyTransforms(this.coordinates, true);\n\t\t},\n\t\tapplyTransforms(transforms, autoZoom = false) {\n\t\t\tconst aspectRatio = this.stencilAspectRatios();\n\n\t\t\tconst allowedArea = this.getAllowedArea(true);\n\n\t\t\tconst moveAlgorithm = (prevCoordinates, newCoordinates) => {\n\t\t\t\treturn this.moveAlgorithm({\n\t\t\t\t\tcoordinates: prevCoordinates,\n\t\t\t\t\tallowedArea,\n\t\t\t\t\tmoveEvent: new MoveEvent(null, {\n\t\t\t\t\t\tleft: (newCoordinates.left - prevCoordinates.left),\n\t\t\t\t\t\ttop: (newCoordinates.top - prevCoordinates.top),\n\t\t\t\t\t})\n\t\t\t\t});\n\t\t\t};\n\n\t\t\tconst resizeAlgorithm = (prevCoordinates, newCoordinates) => {\n\t\t\t\tlet coordinates = this.defaultCoordinates();\n\t\t\t\tcoordinates = this.resizeAlgorithm({\n\t\t\t\t\tcoordinates,\n\t\t\t\t\trestrictions: this.stencilRestrictions,\n\t\t\t\t\tallowedArea,\n\t\t\t\t\taspectRatio,\n\t\t\t\t\tresizeEvent: new ResizeEvent(\n\t\t\t\t\t\tnull,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tleft: (newCoordinates.width - coordinates.width) / 2,\n\t\t\t\t\t\t\tright: (newCoordinates.width - coordinates.width) / 2,\n\t\t\t\t\t\t\ttop: (newCoordinates.height - coordinates.height) / 2,\n\t\t\t\t\t\t\tbottom: (newCoordinates.height - coordinates.height) / 2,\n\t\t\t\t\t\t}\n\t\t\t\t\t)\n\t\t\t\t});\n\t\t\t\treturn moveAlgorithm(coordinates, { left: prevCoordinates.left, top: prevCoordinates.top });\n\t\t\t};\n\n\t\t\tlet coordinates = this.coordinates;\n\n\t\t\tif (!Array.isArray(transforms)) {\n\t\t\t\ttransforms = [transforms];\n\t\t\t}\n\n\t\t\ttransforms.forEach(transform => {\n\t\t\t\tlet changes = {};\n\t\t\t\tif (typeof transform === 'function') {\n\t\t\t\t\tchanges = transform({ ...coordinates }, this.imageSize);\n\t\t\t\t} else {\n\t\t\t\t\tchanges = transform;\n\t\t\t\t}\n\t\t\t\tif (!isUndefined(changes.width) || !isUndefined(changes.height)) {\n\t\t\t\t\tcoordinates = resizeAlgorithm(coordinates, { ...coordinates, ...changes });\n\t\t\t\t}\n\t\t\t\tif (!isUndefined(changes.left) || !isUndefined(changes.top)) {\n\t\t\t\t\tcoordinates = moveAlgorithm(coordinates, { ...coordinates, ...changes });\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (autoZoom) {\n\t\t\t\tthis.autoZoom(coordinates);\n\t\t\t} else {\n\t\t\t\tif (this.worldTransforms.scale > 1) {\n\t\t\t\t\tthis.resetWorldTransforms();\n\t\t\t\t}\n\t\t\t\tthis.updateStencilCoordinates(coordinates);\n\t\t\t}\n\t\t\tthis.onChangeCoordinates(coordinates, false);\n\n\t\t\treturn coordinates;\n\t\t},\n\t\tresetWorldTransforms() {\n\t\t\tthis.worldTransforms = {\n\t\t\t\tscale: 1,\n\t\t\t\tshift: {\n\t\t\t\t\tleft:0,\n\t\t\t\t\ttop: 0\n\t\t\t\t}\n\t\t\t};\n\t\t},\n\t\tresetCoordinates() {\n\t\t\t// This function can be asynchronously called after completion of refreshing image promise\n\t\t\t// Therefore there is a workaround to prevent processing after the component was unmounted\n\t\t\tif (!this.$refs.image) return;\n\n\t\t\tconst cropper = this.$refs.cropper;\n\t\t\tconst image = this.$refs.image;\n\t\t\tconst { minWidth, minHeight, maxWidth, maxHeight, widthFrozen, heightFrozen, } = this.stencilRestrictions;\n\n\t\t\t// Freeze height or width if there was problems while setting stencil restrictions\n\t\t\tthis.frozenDirections.width = Boolean(widthFrozen);\n\t\t\tthis.frozenDirections.height = Boolean(heightFrozen);\n\n\t\t\tconst defaultSize = migrateAlgorithm(this.defaultSize, 'defaultSize', (args) => (\n\t\t\t\t[args.cropper, args.image, { minWidth: args.minWidth, minHeight: args.minHeight, maxWidth: args.maxWidth, maxHeight: args.maxHeight }, args.imageWidth, args.imageHeight, args.props ]\n\t\t\t))({\n\t\t\t\tcropper,\n\t\t\t\timage,\n\t\t\t\timageWidth: this.imageSize.width,\n\t\t\t\timageHeight: this.imageSize.height,\n\t\t\t\tprops: this.$props,\n\t\t\t\taspectRatio: this.stencilAspectRatios(),\n\t\t\t\t...this.stencilRestrictions,\n\t\t\t});\n\n\t\t\tif (defaultSize.width < minWidth || defaultSize.height < minHeight || defaultSize.width > maxWidth || defaultSize.height > maxHeight) {\n\t\t\t\tconsole.warn('Warning: the default size breaks size restrictions. Check your defaultSize function', defaultSize, this.stencilRestrictions);\n\t\t\t}\n\n\t\t\tconst transforms = [\n\t\t\t\tdefaultSize,\n\t\t\t\t(coordinates) => ({\n\t\t\t\t\t...migrateAlgorithm(this.defaultPosition, 'defaultPosition', (args) => (\n\t\t\t\t\t\t[args.cropper, args.image, args.stencilWidth, args.stencilHeight, args.imageWidth, args.imageHeight, args.props]\n\t\t\t\t\t))({\n\t\t\t\t\t\tcropper,\n\t\t\t\t\t\timage,\n\t\t\t\t\t\tstencilWidth: coordinates.width,\n\t\t\t\t\t\tstencilHeight: coordinates.height,\n\t\t\t\t\t\timageWidth: this.imageSize.width,\n\t\t\t\t\t\timageHeight: this.imageSize.height,\n\t\t\t\t\t\tprops: this.$props\n\t\t\t\t\t})\n\t\t\t\t})\n\t\t\t];\n\n\t\t\tif (this.delayedTransforms) {\n\t\t\t\ttransforms.push(...Array.isArray(this.delayedTransforms) ? this.delayedTransforms : [this.delayedTransforms]);\n\t\t\t}\n\t\t\tthis.resetWorldTransforms();\n\t\t\tthis.applyTransforms(transforms);\n\t\t\tthis.delayedTransforms = null;\n\t\t},\n\t\tclearImage() {\n\t\t\tconst stretcher = this.$refs.stretcher;\n\t\t\tthis.imageLoaded = false;\n\t\t\tsetTimeout(() => {\n\t\t\t\tstretcher.style.height = 'auto';\n\t\t\t\tstretcher.style.width = 'auto';\n\t\t\t\tthis.coordinates = { ...DEFAULT_COORDINATES };\n\t\t\t\tthis.boundarySize = {\n\t\t\t\t\twidth: 0,\n\t\t\t\t\theight: 0,\n\t\t\t\t};\n\t\t\t\tthis.updateStencilCoordinates({ ...DEFAULT_COORDINATES });\n\t\t\t}, this.transitionTime);\n\t\t},\n\t\trefreshImage() {\n\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\tconst image = this.$refs.image;\n\t\t\t\tconst cropper = this.$refs.cropper;\n\t\t\t\tif (this.src && image) {\n\t\t\t\t\tconst stretcher = this.$refs.stretcher;\n\t\t\t\t\tif (this.imageTransforms.flipped) {\n\t\t\t\t\t\tthis.imageSize.height = image.naturalWidth;\n\t\t\t\t\t\tthis.imageSize.width = image.naturalHeight;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.imageSize.height = image.naturalHeight;\n\t\t\t\t\t\tthis.imageSize.width = image.naturalWidth;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst aspectRatio = this.imageSize.width / this.imageSize.height;\n\n\t\t\t\t\tif (this.imageSize.height > this.imageSize.width) {\n\t\t\t\t\t\tstretcher.style.height = `${this.imageSize.height}px`;\n\t\t\t\t\t\tstretcher.style.width = `${stretcher.clientHeight * aspectRatio}px`;\n\t\t\t\t\t\tif (stretcher.clientWidth / stretcher.clientHeight !== aspectRatio) {\n\t\t\t\t\t\t\tstretcher.style.height = `${stretcher.clientWidth / aspectRatio}px`;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tstretcher.style.width = `${this.imageSize.width}px`;\n\t\t\t\t\t\tstretcher.style.height = `${stretcher.clientWidth / aspectRatio }px`;\n\t\t\t\t\t\tif (stretcher.clientHeight / stretcher.clientWidth !== aspectRatio) {\n\t\t\t\t\t\t\tstretcher.style.width = `${stretcher.clientHeight * aspectRatio}px`;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tVue.nextTick(() => {\n\t\t\t\t\t\tconst { height, width, } = migrateAlgorithm(this.areaSize, 'areaSize', (args) => ([\n\t\t\t\t\t\t\targs.cropper, args.image, args.imageWidth, args.imageHeight\n\t\t\t\t\t\t]))({\n\t\t\t\t\t\t\tcropper,\n\t\t\t\t\t\t\timage,\n\t\t\t\t\t\t\timageWidth: this.imageSize.width,\n\t\t\t\t\t\t\timageHeight: this.imageSize.height\n\t\t\t\t\t\t});\n\t\t\t\t\t\tif (height) {\n\t\t\t\t\t\t\tthis.boundarySize.height = height;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (width) {\n\t\t\t\t\t\t\tthis.boundarySize.width = width;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tresolve();\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\treject();\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tgetAllowedArea(breakBoundaries) {\n\t\t\treturn this.allowedArea({\n\t\t\t\tbreakBoundaries,\n\t\t\t\timageSize: this.imageSize,\n\t\t\t\tworldTransforms: this.worldTransforms,\n\t\t\t\timageRestriction: this.imageRestriction\n\t\t\t});\n\t\t},\n\t\tstencilAspectRatios() {\n\t\t\tif (this.$refs.stencil.aspectRatios) {\n\t\t\t\treturn this.$refs.stencil.aspectRatios();\n\t\t\t} else {\n\t\t\t\treturn {\n\t\t\t\t\tminimum: this.stencilProps.aspectRatio || this.stencilProps.minAspectRatio,\n\t\t\t\t\tmaximum: this.stencilProps.aspectRatio || this.stencilProps.maxAspectRatio,\n\t\t\t\t};\n\t\t\t}\n\t\t},\n\t},\n};\n</script>\n\n<template>\n  <div\n    ref=\"cropper\"\n    :class=\"classes.cropper\"\n  >\n    <div\n      :class=\"classes.background\"\n      :style=\"areaStyle\"\n    />\n    <div\n      ref=\"stretcher\"\n      :class=\"classes.stretcher\"\n    />\n\n    <div\n      ref=\"area\"\n      :class=\"classes.area\"\n      :style=\"areaStyle\"\n    >\n      <CropperWrapper\n        :class=\"classes.cropperWrapper\"\n        :wheel-resize=\"settings.wheelResize\"\n        :touch-resize=\"settings.touchResize\"\n        :touch-move=\"settings.touchMove\"\n        :mouse-move=\"settings.touchMove\"\n        @move=\"onManipulateImage\"\n        @resize=\"onManipulateImage\"\n      >\n        <div :class=\"classes.imageWrapper\">\n          <img\n            ref=\"image\"\n            :crossOrigin=\"imageAttributes.crossOrigin\"\n            :src=\"imageAttributes.src\"\n            :class=\"classes.image\"\n            :style=\"imageStyle\"\n            @mousedown.prevent\n          >\n        </div>\n        <component\n          :is=\"stencilComponent\"\n          ref=\"stencil\"\n          :img=\"{\n            src: imageAttributes.src,\n            size: imageSize,\n            transforms: imageTransforms,\n            coefficient: coefficient\n          }\"\n          :result-coordinates=\"coordinates\"\n          :stencil-coordinates=\"stencilCoordinates\"\n          v-bind=\"stencilProps\"\n          @resize=\"onResize\"\n          @move=\"onMove\"\n        />\n        <canvas\n          v-if=\"canvas\"\n          ref=\"canvas\"\n          :style=\"{display:'none'}\"\n        />\n        <canvas\n          v-if=\"canvas\"\n          ref=\"sourceCanvas\"\n          :style=\"{display:'none'}\"\n        />\n      </CropperWrapper>\n    </div>\n  </div>\n</template>\n\n<style lang=\"scss\">\n.vue-advanced-cropper {\n\ttext-align: center;\n\tposition: relative;\n\tuser-select: none;\n\tmax-height: 100%;\n\tmax-width: 100%;\n\tdirection: ltr;\n\n\t&__stretcher {\n\t\tpointer-events: none;\n\t\tposition: relative;\n\t\tmax-width: 100%;\n\t\tmax-height: 100%;\n\t}\n\n  &__image {\n\topacity: 0.5;\n\tuser-select: none;\n\tposition: absolute;\n\ttransform-origin: center;\n\t// Workaround to prevent bugs at the websites with max-width\n\t// rule applied to img (Vuepress for example)\n\tmax-width: unset !important;\n  }\n  &__area {\n\tposition: absolute;\n\tleft: 50%;\n\ttransform: translate(-50%, -50%);\n\ttop: 50%;\n  }\n  &__background {\n\tposition: absolute;\n\tbackground: black;\n\ttop: 50%;\n\tleft: 50%;\n\ttransform: translate(-50%, -50%);\n  }\n  &__cropper-wrapper {\n\twidth: 100%;\n\theight: 100%;\n  }\n  &__image-wrapper {\n\toverflow: hidden;\n\tposition: absolute;\n\twidth: 100%;\n\theight: 100%;\n  }\n  &__stencil-wrapper {\n\tposition: absolute;\n  }\n}\n</style>\n","/*!\n  Copyright (c) 2017 Jed Watson.\n  Licensed under the MIT License (MIT), see\n  http://jedwatson.github.io/classnames\n*/\n/* global define */\n\n(function () {\n\t'use strict';\n\n\tvar hasOwn = {}.hasOwnProperty;\n\n\tfunction classNames () {\n\t\tvar classes = [];\n\n\t\tfor (var i = 0; i < arguments.length; i++) {\n\t\t\tvar arg = arguments[i];\n\t\t\tif (!arg) continue;\n\n\t\t\tvar argType = typeof arg;\n\n\t\t\tif (argType === 'string' || argType === 'number') {\n\t\t\t\tclasses.push(arg);\n\t\t\t} else if (Array.isArray(arg) && arg.length) {\n\t\t\t\tvar inner = classNames.apply(null, arg);\n\t\t\t\tif (inner) {\n\t\t\t\t\tclasses.push(inner);\n\t\t\t\t}\n\t\t\t} else if (argType === 'object') {\n\t\t\t\tfor (var key in arg) {\n\t\t\t\t\tif (hasOwn.call(arg, key) && arg[key]) {\n\t\t\t\t\t\tclasses.push(key);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn classes.join(' ');\n\t}\n\n\tif (typeof module !== 'undefined' && module.exports) {\n\t\tclassNames.default = classNames;\n\t\tmodule.exports = classNames;\n\t} else if (typeof define === 'function' && typeof define.amd === 'object' && define.amd) {\n\t\t// register as 'classnames', consistent with npm package name\n\t\tdefine('classnames', [], function () {\n\t\t\treturn classNames;\n\t\t});\n\t} else {\n\t\twindow.classNames = classNames;\n\t}\n}());\n","'use strict';\r\n\r\n/**\r\n * BEM class name factory.\r\n *\r\n * @typedef {Function} Bem\r\n * @param {String|Object} [elementOrMods] Element name or hash object with mods\r\n * @param {Object} [mods] Hash object with mods\r\n * @returns {String}\r\n */\r\n\r\n/**\r\n * Returns BEM class name factory.\r\n *\r\n * @param {String} componentName Block name\r\n * @returns {Bem}\r\n */\r\nmodule.exports = function bem(componentName) {\r\n    return function (elementOrMods, mods) {\r\n        if (!elementOrMods) {\r\n            return componentName;\r\n        }\r\n\r\n        var element;\r\n\r\n        if (typeof elementOrMods === 'string') {\r\n            element = elementOrMods;\r\n        } else {\r\n            mods = elementOrMods;\r\n        }\r\n\r\n        var base = componentName;\r\n        if (element) {\r\n            base += '__' + element;\r\n        }\r\n\r\n        return base + (\r\n            mods\r\n                ? Object.keys(mods).reduce(function (result, name) {\r\n                    var value = mods[name];\r\n\r\n                    if (value) {\r\n                        result += ' ' + (\r\n                            typeof value === 'boolean'\r\n                                ? (base + '--' + name)\r\n                                : (base + '--' + name + '_' + value)\r\n                        );\r\n                    }\r\n\r\n                    return result;\r\n                }, '')\r\n                : ''\r\n        );\r\n    };\r\n}\r\n","export class ManipulateImageEvent {\r\n\tconstructor(nativeEvent, move = {}, scale = {}, params = {}) {\r\n\t\tthis.nativeEvent = nativeEvent;\r\n\t\tthis.move = move;\r\n\t\tthis.scale = scale;\r\n\t\tthis.params = params;\r\n\t}\r\n}\r\n\r\nexport class ResizeEvent {\r\n\tconstructor(nativeEvent, directions, params = {}) {\r\n\t\tthis.nativeEvent = nativeEvent;\r\n\t\tthis.directions = directions;\r\n\t\tthis.params = params;\r\n\t}\r\n}\r\n\r\nexport class MoveEvent {\r\n\tconstructor(nativeEvent, directions) {\r\n\t\tthis.nativeEvent = nativeEvent;\r\n\t\tthis.directions = directions;\r\n\t}\r\n}\r\n\r\nexport class DragEvent {\r\n\tconstructor(nativeEvent, element, position, previousPosition, anchor) {\r\n\t\tthis.nativeEvent = nativeEvent;\r\n\t\tthis.position = position;\r\n\t\tthis.previousPosition = previousPosition;\r\n\t\tthis.element = element;\r\n\t\tthis.anchor = anchor;\r\n\t}\r\n\tshift() {\r\n\t\tconst { element, anchor, position, } = this;\r\n\t\tconst { left, top, } = element.getBoundingClientRect();\r\n\r\n\t\treturn {\r\n\t\t\tleft: position.left - left - anchor.left,\r\n\t\t\ttop: position.top - top - anchor.top,\r\n\t\t};\r\n\t}\r\n}\r\n","import { DragEvent } from '../core/events';\r\n\r\nexport default {\r\n\tbeforeMount() {\r\n\t\twindow.addEventListener('mouseup', this.onMouseUp, { passive: false, });\r\n\t\twindow.addEventListener('mousemove', this.onMouseMove, { passive: false, });\r\n\t\twindow.addEventListener('touchmove', this.onTouchMove, { passive: false, });\r\n\t\twindow.addEventListener('touchend', this.onTouchEnd, { passive: false, });\r\n\t},\r\n\tbeforeDestroy() {\r\n\t\twindow.removeEventListener('mouseup', this.onMouseUp);\r\n\t\twindow.removeEventListener('mousemove', this.onMouseMove);\r\n\t\twindow.removeEventListener('touchmove', this.onTouchMove);\r\n\t\twindow.removeEventListener('touchend', this.onTouchEnd);\r\n\t},\r\n\tmounted () {\r\n\t\tif (!this.$refs.draggable) {\r\n\t\t\tthrow new Error(\r\n\t\t\t\t'You should add ref \"draggable\" to your root element to use draggable mixin'\r\n\t\t\t);\r\n\t\t}\r\n\t\tthis.touches = [];\r\n\t\tthis.draggingAnchor = [];\r\n\t\tthis.hovered = false;\r\n\t},\r\n\tmethods: {\r\n\t\tonMouseOver () {\r\n\t\t\tif (!this.hovered) {\r\n\t\t\t\tthis.hovered = true;\r\n\t\t\t\tthis.$emit('enter');\r\n\t\t\t}\r\n\t\t},\r\n\t\tonMouseLeave () {\r\n\t\t\tif (this.hovered) {\r\n\t\t\t\tthis.hovered = false;\r\n\t\t\t\tthis.$emit('leave');\r\n\t\t\t}\r\n\t\t},\r\n\t\tonTouchStart (e) {\r\n\t\t\tif (e.cancelable && !this.disabled && e.touches.length === 1) {\r\n\t\t\t\tthis.touches = [...e.touches];\r\n\r\n\t\t\t\tif (!this.hovered) {\r\n\t\t\t\t\tthis.$emit('enter');\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (e.touches.length) {\r\n\t\t\t\t\tthis.initAnchor(\r\n\t\t\t\t\t\tthis.touches.reduce(\r\n\t\t\t\t\t\t\t(mean, touch) => {\r\n\t\t\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\t\t\tclientX: mean.clientX + touch.clientX / e.touches.length,\r\n\t\t\t\t\t\t\t\t\tclientY: mean.clientY + touch.clientY / e.touches.length,\r\n\t\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t{ clientX: 0, clientY: 0, }\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t\tif (e.preventDefault) {\r\n\t\t\t\t\te.preventDefault();\r\n\t\t\t\t}\r\n\t\t\t\te.stopPropagation();\r\n\t\t\t}\r\n\t\t},\r\n\t\tonTouchEnd () {\r\n\t\t\tthis.processEnd();\r\n\t\t},\r\n\t\tonTouchMove (e) {\r\n\t\t\tif (this.touches.length) {\r\n\t\t\t\tthis.processMove(e, e.touches);\r\n\t\t\t\tif (e.preventDefault) {\r\n\t\t\t\t\te.preventDefault();\r\n\t\t\t\t}\r\n\t\t\t\tif (e.stopPropagation) {\r\n\t\t\t\t\te.stopPropagation();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tonMouseDown (e) {\r\n\t\t\tif (!this.disabled) {\r\n\t\t\t\tconst touch = {\r\n\t\t\t\t\tfake: true,\r\n\t\t\t\t\tclientX: e.clientX,\r\n\t\t\t\t\tclientY: e.clientY,\r\n\t\t\t\t};\r\n\t\t\t\tthis.touches = [touch];\r\n\t\t\t\tthis.initAnchor(touch);\r\n\t\t\t\te.stopPropagation();\r\n\t\t\t}\r\n\t\t},\r\n\t\tonMouseMove (e) {\r\n\t\t\tif (this.touches.length) {\r\n\t\t\t\tthis.processMove(e, [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tfake: true,\r\n\t\t\t\t\t\tclientX: e.clientX,\r\n\t\t\t\t\t\tclientY: e.clientY,\r\n\t\t\t\t\t}\r\n\t\t\t\t]);\r\n\t\t\t\tif (e.preventDefault) {\r\n\t\t\t\t\te.preventDefault();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tonMouseUp () {\r\n\t\t\tthis.touches = [];\r\n\t\t},\r\n\t\tinitAnchor (touch) {\r\n\t\t\tconst draggable = this.$refs.draggable;\r\n\t\t\tconst { left, right, bottom, top, } = draggable.getBoundingClientRect();\r\n\r\n\t\t\tthis.anchor = {\r\n\t\t\t\tleft: touch.clientX - left,\r\n\t\t\t\ttop: touch.clientY - top,\r\n\t\t\t\tbottom: bottom - touch.clientY,\r\n\t\t\t\tright: right - touch.clientX,\r\n\t\t\t};\r\n\t\t},\r\n\t\tprocessMove (event, touches) {\r\n\t\t\tconst newTouches = [...touches];\r\n\t\t\tif (this.touches.length) {\r\n\t\t\t\tif (this.touches.length === 1 && newTouches.length === 1) {\r\n\t\t\t\t\tconst element = this.$refs.draggable;\r\n\t\t\t\t\tthis.$emit('drag', new DragEvent(\r\n\t\t\t\t\t\tevent,\r\n\t\t\t\t\t\telement,\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tleft: newTouches[0].clientX,\r\n\t\t\t\t\t\t\ttop: newTouches[0].clientY,\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tleft: this.touches[0].clientX,\r\n\t\t\t\t\t\t\ttop: this.touches[0].clientY,\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tthis.anchor\r\n\t\t\t\t\t));\r\n\t\t\t\t}\r\n\t\t\t\tthis.touches = newTouches;\r\n\t\t\t}\r\n\t\t},\r\n\t\tprocessEnd () {\r\n\t\t\tthis.touches = [];\r\n\t\t\tif (this.hovered) {\r\n\t\t\t\tthis.$emit('leave');\r\n\t\t\t\tthis.hovered = false;\r\n\t\t\t}\r\n\t\t},\r\n\t},\r\n};\r\n","export const HORIZONTAL_DIRECTIONS = ['left', 'right'];\r\nexport const VERTICAL_DIRECTIONS = ['top', 'bottom'];\r\nexport const ALL_DIRECTIONS = ['left', 'right', 'top', 'bottom'];\r\n\r\nexport const COORDINATES_TYPES = ['width', 'height', 'left', 'top'];\r\n\r\nexport const IMAGE_RESTRICTIONS = ['area', 'stencil', 'none'];\r\n\r\nexport const XHR_DONE = 4;\r\n\r\nexport const MINIMAL_PERCENT_SIZE = 0.1;\r\n\r\nexport const DEFAULT_COORDINATES = {\r\n\tleft: 0,\r\n\ttop: 0,\r\n\twidth: 0,\r\n\theight: 0,\r\n};","import Vue from 'vue';\nimport Cropper from './Cropper.vue';\n\nimport {\n\tRectangleStencil,\n\tCircleStencil\n} from './components/stencils';\n\nimport {\n\tSimpleHandler\n} from './components/handlers';\n\nimport {\n\tSimpleLine\n} from './components/lines';\n\nexport {\n\tPreviewResult,\n\tDraggableArea,\n\tBoundingBox,\n\tLineWrapper,\n\tHandlerWrapper,\n\tDraggableElement\n} from './components/service';\n\nexport {\n\tRectangleStencil,\n\tCircleStencil\n} from './components/stencils';\n\nexport {\n\tSimpleHandler\n} from './components/handlers';\n\nexport {\n\tSimpleLine\n} from './components/lines';\n\nexport {\n\tPreviewImage\n} from './components/helpers';\n\nexport {\n\tResizeEvent,\n\tMoveEvent,\n\tDragEvent\n} from './core/events';\n\nexport { default as Cropper } from './Cropper.vue';\n\nVue.component('cropper', Cropper);\nVue.component('rectangle-stencil', RectangleStencil);\nVue.component('circle-stencil', CircleStencil);\nVue.component('simple-handler', SimpleHandler);\nVue.component('simple-line', SimpleLine);\n"],"names":["Math","floor","abs","max","min","ceil","String","fromCharCode","debounce","func","wait","immediate","later","last","Date","now","timestamp","timeout","setTimeout","result","apply","context","args","debounced","arguments","callNow","clear","clearTimeout","flush","directionNames","hDirection","vDirection","name","classname","toUpperCase","slice","isLocal","url","test","isCrossOriginURL","pageLocation","window","location","URL_HOST_PATTERN","urlMatch","exec","urlparts","protocol","host","port","defaultPort","portOf","isUndefined","obj","isObject","_typeof","addTimestamp","getTime","indexOf","distance","firstPoint","secondPoint","pow","sqrt","x","y","getSettings","param","defaultParams","enabled","parseNumber","number","Number","isNaN","parsedNumber","prepareSource","canvas","image","PI","flipped","orientation","width","naturalWidth","height","naturalHeight","ctx","getContext","save","translate","scale","rotate","drawImage","restore","getImageTransforms","scaleX","scaleY","getStyleTransforms","transform","parseImage","src","Promise","resolve","getImageData","then","data","source","arrayBuffer","getOrientation","catch","error","console","warn","img","reject","base64ToArrayBuffer","fileReader","FileReader","onload","e","target","objectURLToBlob","blob","readAsArrayBuffer","http","XMLHttpRequest","onreadystatechange","readyState","status","response","onprogress","getResponseHeader","abort","withCredentials","open","responseType","send","callback","base64","replace","binary","atob","len","length","buffer","ArrayBuffer","view","Uint8Array","i","charCodeAt","getStringFromCharCode","dataView","start","str","getUint8","exifIDCode","tiffOffset","littleEndian","app1Start","ifdStart","DataView","byteLength","offset","endianness","getUint16","firstIFDOffset","getUint32","setUint16","arrayBufferToDataURL","chunks","chunkSize","uint8","value","subarray","push","Array","from","btoa","join","allSides","coordinates","left","top","right","bottom","mainSide","side","getCurrentWidth","actualCoordinates","directions","getCurrentHeight","getBrokenLimits","allowedArea","fitConditions","oldDirections","restrictions","preserveAspectRatio","stopOnBreak","mode","currentWidth","currentHeight","minWidth","minHeight","breaks","maxResize","ALL_DIRECTIONS","forEach","direction","multiplier","map","HORIZONTAL_DIRECTIONS","VERTICAL_DIRECTIONS","maxWidth","maxHeight","getBrokenRatio","aspectRatio","ratioBroken","minimum","maximum","move","moveEvent","newCoordinates","autoZoom","originalStencilCoordinates","stencilCoordinates","originalWorldTransforms","worldTransforms","coefficient","imageSize","shift","scaledImageSize","manipulateImage","manipulateImageEvent","stencilRestrictions","frozenDirections","fitImage","imageShifts","scaleImage","scaleStencil","minScale","factor","epsilon","allowedImageScale","imageSizeChanges","center","stencilResizeAmends","roundCoordinates","round","roundedCoordinates","classNames","arg","classes","argType","isArray","inner","key","hasOwn","call","hasOwnProperty","module","exports","default","componentName","elementOrMods","mods","element","base","Object","keys","reduce","ManipulateImageEvent","nativeEvent","params","ResizeEvent","MoveEvent","DragEvent","position","previousPosition","anchor","getBoundingClientRect","beforeMount","addEventListener","onMouseUp","passive","onMouseMove","onTouchMove","onTouchEnd","beforeDestroy","removeEventListener","mounted","$refs","draggable","Error","touches","draggingAnchor","hovered","methods","onMouseOver","$emit","onMouseLeave","onTouchStart","cancelable","disabled","initAnchor","mean","touch","clientX","clientY","preventDefault","stopPropagation","processEnd","processMove","onMouseDown","fake","event","newTouches","IMAGE_RESTRICTIONS","MINIMAL_PERCENT_SIZE","DEFAULT_COORDINATES","breakBoundaries","imageRestriction","limits","boundaries","resizeEvent","limitedRestrictions","allowedDirections","respectDirection","overlapHeight","overlapWidth","compensate","newHeight","newWidth","cropper","imageWidth","imageHeight","props","areaWidth","areaHeight","ratio","stencilWidth","stencilHeight","clientHeight","clientWidth","component","Cropper","Vue","RectangleStencil","CircleStencil","SimpleHandler","SimpleLine"],"mappings":"0PAwpB6BA,IAAI,CAACC,QAjY7BD,IAAI,CAACE,MA7KgBF,IAAI,CAACG,MAjEIH,IAAI,CAACI,MAAOJ,IAAI,CAACK,OCwJ3CC,MAAM,CAACC,k0CCnLhB,QAASC,CAAAA,CAAT,CAAkBC,CAAlB,CAAwBC,CAAxB,CAA8BC,CAA9B,CAAwC,SAI7BC,CAAAA,GAAQ,IACXC,CAAAA,CAAI,CAAGC,IAAI,CAACC,GAALD,GAAaE,EAEpBH,CAAI,CAAGH,CAAPG,EAAuB,CAARA,EAAAA,CAHJ,CAIbI,CAAO,CAAGC,UAAU,CAACN,CAAD,CAAQF,CAAI,CAAGG,CAAf,CAJP,EAMbI,CAAO,CAAG,IANG,CAOT,CAACN,CAPQ,GAQXQ,CAAM,CAAGV,CAAI,CAACW,KAALX,CAAWY,CAAXZ,CAAoBa,CAApBb,CARE,CASXY,CAAO,CAAGC,CAAI,CAAG,IATN,MAHbL,CAAAA,EAASK,EAAMD,EAASL,EAAWG,EACnC,MAAQT,CAF0B,GAEpBA,CAAI,CAAG,GAFa,KAkBlCa,CAAAA,CAAS,CAAG,UAAU,CACxBF,CAAO,CAAG,IADc,CAExBC,CAAI,CAAGE,SAFiB,CAGxBR,CAAS,CAAGF,IAAI,CAACC,GAALD,EAHY,IAIpBW,CAAAA,CAAO,CAAGd,CAAS,EAAI,CAACM,QACvBA,CAAAA,IAASA,CAAO,CAAGC,UAAU,CAACN,CAAD,CAAQF,CAAR,GAC9Be,IACFN,CAAM,CAAGV,CAAI,CAACW,KAALX,CAAWY,CAAXZ,CAAoBa,CAApBb,EACTY,CAAO,CAAGC,CAAI,CAAG,MAGZH,CAXT,QAcAI,CAAAA,CAAS,CAACG,KAAVH,CAAkB,UAAW,CACvBN,CADuB,GAEzBU,YAAY,CAACV,CAAD,CAFa,CAGzBA,CAAO,CAAG,IAHe,CAA7B,EAOAM,CAAS,CAACK,KAAVL,CAAkB,UAAW,CACvBN,CADuB,GAEzBE,CAAM,CAAGV,CAAI,CAACW,KAALX,CAAWY,CAAXZ,CAAoBa,CAApBb,CAFgB,CAGzBY,CAAO,CAAGC,CAAI,CAAG,IAHQ,CAKzBK,YAAY,CAACV,CAAD,CALa,CAMzBA,CAAO,CAAG,IANe,CAA7B,EAUOM,EC/DF,QAASM,CAAAA,CAAT,CAAyBC,CAAzB,CAAqCC,CAArC,CAAiD,IACnDC,CAAAA,EAAMC,QACNH,CAAAA,CAAU,EAAIC,GACjBC,CAAI,WAAMF,UAAaC,CAAU,CAAC,CAAD,CAAVA,CAAcG,WAAdH,WAA8BA,CAAU,CAACI,KAAXJ,CAAiB,CAAjBA,GACrDE,CAAS,WAAMH,cAAcC,KAE7BC,CAAI,CAAGF,CAAU,EAAIC,EACrBE,CAAS,CAAGH,CAAU,EAAIC,GAEpB,CAAEC,IAAI,CAAJA,CAAF,CAAQC,SAAS,CAATA,CAAR,EAGD,QAASG,CAAAA,CAAT,CAAiBC,CAAjB,CAAsB,OACrB,UAASC,IAAT,CAAcD,CAAd,GAAsB,SAASC,IAAT,CAAcD,CAAd,EAGvB,QAASE,CAAAA,CAAT,CAA0BF,CAA1B,CAA+B,IACjCD,CAAO,CAACC,CAAD,WAD0B,GAI/BG,CAAAA,CAAY,CAAGC,MAAM,CAACC,QAJS,CAK/BC,CAAgB,CAAG,yCALY,CAM/BC,CAAQ,CAAGD,CAAgB,CAACE,IAAjBF,CAAsBN,CAAtBM,GAA8B,EANV,CAO/BG,CAAQ,CAAG,CAChBC,QAAQ,CAAIH,CAAQ,CAAC,CAAD,CAARA,EAAe,EADX,CAEhBI,IAAI,CAAQJ,CAAQ,CAAC,CAAD,CAARA,EAAe,EAFX,CAGhBK,IAAI,CAAQL,CAAQ,CAAC,CAAD,CAARA,EAAe,EAHX,CAPoB,CAa/BM,CAAW,CAAG,SAACH,CAAD,CAAc,OAC1B,SAAU,EAAV,UAAuB,GAAvB,EAA8BA,CAA9B,CADR,CAbqC,CAiB/BI,CAAM,CAAG,SAACT,CAAD,CAAc,OACrBA,CAAAA,CAAQ,CAACO,IAATP,EAAiBQ,CAAW,CAACR,CAAQ,CAACK,QAATL,EAAqBF,CAAY,CAACO,QAAnC,CADpC,CAjBqC,OAqB3B,CAACD,CAAQ,CAACC,QAAV,EAAuBD,CAAQ,CAACE,IAAhC,EAAyCF,CAAQ,CAACG,IAAlD,OACAH,CAAQ,CAACC,QAATD,EAAuBA,CAAQ,CAACC,QAATD,EAAsBN,CAAY,CAACO,QAA1DD,EACDA,CAAQ,CAACE,IADRF,EACsBA,CAAQ,CAACE,IAATF,EAAuBN,CAAY,CAACQ,IAD1DF,EAEDA,CAAQ,CAACE,IAFRF,EAEsBK,CAAM,CAACL,CAAD,CAANK,EAAuBA,CAAM,CAACX,CAAD,CAHnD,EAOJ,QAASY,CAAAA,CAAT,CAAqBC,CAArB,CAA0B,OACV,WAAf,QAAOA,CAAAA,EAGR,QAASC,CAAAA,CAAT,CAAkBD,CAAlB,CAAuB,OACP,QAAf,GAAAE,EAAOF,EAAP,EAAmC,IAARA,GAAAA,EAG5B,QAASG,CAAAA,CAAT,CAAsBnB,CAAtB,CAA2B,IAC3BrB,CAAAA,CAAS,qBAAiB,GAAIF,CAAAA,IAAJ,GAAY2C,OAAZ,UACzBpB,CAAAA,CAAG,EAAyB,CAAC,CAAtBA,GAAAA,CAAG,CAACqB,OAAJrB,CAAY,GAAZA,EAA0B,GAA1BA,CAAgC,GAApC,CAAHA,CAA8CrB,EAG/C,QAAS2C,CAAAA,CAAT,CAAkBC,CAAlB,CAA8BC,CAA9B,CAA2C,OAEhD7D,IAAI,CAAC8D,GAF2C,OAC1C9D,CAAAA,IAAI,CAAC+D,IAAL/D,CACNA,EAAS4D,CAAU,CAACI,CAAXJ,CAAeC,CAAW,CAACG,CAApChE,CAAuC,CAAvCA,EAA4CA,EAAS4D,CAAU,CAACK,CAAXL,CAAeC,CAAW,CAACI,CAApCjE,CAAuC,CAAvCA,CADtCA,EAKD,QAASkE,CAAAA,CAAT,CAAqBC,CAArB,CAAgD,IAApBC,CAAAA,CAAoB,wDAAJ,EAAI,CAClDjD,CAAM,IACTkD,OAAO,GAAUF,GACdC,EAHkD,OAKlDd,CAAAA,CAAQ,CAACa,CAAD,IACXhD,CAAM,MAAQA,EAAWgD,IAEnBhD,EAGD,QAASmD,CAAAA,CAAT,CAAqBC,CAArB,CAA6B,OAE/BC,MAAM,CAACC,KAFwB,CAC7BC,CAAY,EAAUH,CADO,OAE/BC,GAAaE,CAAbF,CAF+B,CAG3BD,CAH2B,CAK3BG,UF7EOC,CAAAA,EAAcC,EAAQC,IAAkC,OAqB/C7E,IAAI,CAAC8E,EArB0C,CAAzBC,CAAyB,GAAzBA,OAAyB,CAAhBC,CAAgB,GAAhBA,WAAgB,CACjEC,CAAK,CAAGJ,CAAK,CAACK,YADmD,CAEjEC,CAAM,CAAGN,CAAK,CAACO,aAFkD,CAIjEC,CAAG,CAAGT,CAAM,CAACU,UAAPV,CAAkB,IAAlBA,CAJ2D,OAKvEA,CAAAA,CAAM,CAACK,KAAPL,CAAeK,EACfL,CAAM,CAACO,MAAPP,CAAgBO,EAEhBE,CAAG,CAACE,IAAJF,GAEIN,IACHH,CAAM,CAACK,KAAPL,CAAeO,EACfP,CAAM,CAACO,MAAPP,CAAgBK,GAIE,CAAfD,EAAAA,GACHK,CAAG,CAACG,SAAJH,CAAcJ,CAAdI,CAAqB,CAArBA,EACAA,CAAG,CAACI,KAAJJ,CAAU,CAAC,CAAXA,CAAc,CAAdA,GACyB,CAAfL,EAAAA,GACVK,CAAG,CAACG,SAAJH,CAAcJ,CAAdI,CAAqBF,CAArBE,EACAA,CAAG,CAACK,MAAJL,CAAW,GAAXA,GACyB,CAAfL,EAAAA,GACVK,CAAG,CAACG,SAAJH,CAAc,CAAdA,CAAiBF,CAAjBE,EACAA,CAAG,CAACI,KAAJJ,CAAU,CAAVA,CAAa,CAAC,CAAdA,GACyB,CAAfL,EAAAA,GACVK,CAAG,CAACK,MAAJL,CAAW,GAAK,GAAL,EAAXA,EACAA,CAAG,CAACI,KAAJJ,CAAU,CAAVA,CAAa,CAAC,CAAdA,GACyB,CAAfL,EAAAA,GACVK,CAAG,CAACK,MAAJL,CAAW,GAAK,GAAL,EAAXA,EACAA,CAAG,CAACG,SAAJH,CAAc,CAAdA,CAAiB,CAACF,CAAlBE,GACyB,CAAfL,EAAAA,GACVK,CAAG,CAACK,MAAJL,CAAW,IAAM,GAAN,EAAXA,EACAA,CAAG,CAACG,SAAJH,CAAc,CAACJ,CAAfI,CAAsBF,CAAtBE,EACAA,CAAG,CAACI,KAAJJ,CAAU,CAAVA,CAAa,CAAC,CAAdA,GACyB,CAAfL,EAAAA,IACVK,CAAG,CAACG,SAAJH,CAAc,CAAdA,CAAiBJ,CAAjBI,EACAA,CAAG,CAACK,MAAJL,CAAW,IAAM,GAAN,EAAXA,GAGDA,CAAG,CAACM,SAAJN,CAAcR,CAAdQ,CAAqB,CAArBA,CAAwB,CAAxBA,CAA2BJ,CAA3BI,CAAkCF,CAAlCE,EACAA,CAAG,CAACO,OAAJP,GAEOT,EAGD,QAASiB,CAAAA,CAAT,CAA4Bb,CAA5B,CAAyC,IAC3C7D,CAAAA,CAAM,CAAG,CACZ6D,WAAW,CAAXA,CADY,QAGTA,CAAAA,IAEE,IADGA,EAEP7D,CAAM,CAAC2E,MAAP3E,CAAgB,CAAC,EAEb,IAJG6D,EAKP7D,CAAM,CAACuE,MAAPvE,CAAgB,CAAC,IAEb,IAPG6D,EAQP7D,CAAM,CAAC4E,MAAP5E,CAAgB,CAAC,EAEb,IAVG6D,GAWP7D,CAAM,CAACuE,MAAPvE,CAAgB,GAChBA,CAAM,CAAC4E,MAAP5E,CAAgB,CAAC,GAEb,IAdG6D,EAeP7D,CAAM,CAACuE,MAAPvE,CAAgB,GAEZ,IAjBG6D,GAkBP7D,CAAM,CAACuE,MAAPvE,CAAgB,GAChBA,CAAM,CAAC2E,MAAP3E,CAAgB,CAAC,GAEb,IArBG6D,EAsBP7D,CAAM,CAACuE,MAAPvE,CAAgB,CAAC,YAIG,EAAlBA,GAAAA,CAAM,CAACuE,MAAPvE,EAA0C,CAAC,EAAnBA,GAAAA,CAAM,CAACuE,UAClCvE,CAAM,CAAC4D,OAAP5D,KAEMA,EAGD,QAAS6E,CAAAA,CAAT,EAAA,CAAyD,IAA3BN,CAAAA,CAA2B,GAA3BA,MAA2B,CAAnBI,CAAmB,GAAnBA,MAAmB,CAAXC,CAAW,GAAXA,MAAW,CAC3DE,CAAS,CAAG,EAD+C,QAE3DP,CAAM,EAAII,CAAVJ,EAAoBK,KACnBL,IACHO,CAAS,oBAAeP,YAErBI,IACHG,CAAS,oBAAeH,SAErBC,IACHE,CAAS,oBAAeF,UAGnBE,EAGD,QAASC,CAAAA,CAAT,CAAoBC,CAApB,CAAyB,OACxB,IAAIC,CAAAA,OAAJ,CAAY,SAACC,CAAD,CAAa,CAC/BC,CAAY,CAACH,CAAD,CAAZG,CACEC,IADFD,CACO,SAAAE,CAAA,CAAQ,CACbH,CAAO,CAACG,CAAI,CACX,CAAEC,MAAM,CAAEN,CAAV,CAAeO,WAAW,CAAEF,CAA5B,CAAkCxB,WAAW,CAAE2B,CAAc,CAACH,CAAD,CAA7D,CADW,CAEX,CAAEC,MAAM,CAAEN,CAAV,CAAeO,WAAW,CAAE,IAA5B,CAAkC1B,WAAW,CAAE,IAA/C,CAFM,CAFT,CAAAsB,EAOEM,KAPFN,CAOQ,SAACO,CAAD,CAAW,CACjBC,OAAO,CAACC,IAARD,CAAaD,CAAbC,CADiB,CAEjBT,CAAO,CAAC,CAAEI,MAAM,CAAEN,CAAV,CAAeO,WAAW,CAAE,IAA5B,CAAkC1B,WAAW,CAAE,IAA/C,CAAD,CATT,CAAAsB,CADM,CAAA,EAeR,QAASA,CAAAA,CAAT,CAAsBU,CAAtB,CAA2B,OACnB,IAAIZ,CAAAA,OAAJ,CAAY,SAACC,CAAD,CAAUY,CAAV,CAAqB,IACnC,KACCD,EAsCHC,CAAM,CAAC,2BAAD,UApCF,UAAU3E,IAAV,CAAe0E,CAAf,EACHX,CAAO,CAACa,CAAmB,CAACF,CAAD,CAApB,MAED,IAAI,UAAU1E,IAAV,CAAe0E,CAAf,CAAJ,CAAyB,IACzBG,CAAAA,CAAU,CAAG,GAAIC,CAAAA,WACvBD,CAAU,CAACE,MAAXF,CAAoB,SAAUG,CAAV,CAAa,CAChCjB,CAAO,CAACiB,CAAC,CAACC,MAAFD,CAASnG,MAAV,CADR,CAF+B,CAK/BqG,CAAe,CAACR,CAAD,CAAM,SAAUS,CAAV,CAAgB,CACpCN,CAAU,CAACO,iBAAXP,CAA6BM,CAA7BN,CADc,CAAA,CALT,CAAA,IASA,IACFQ,CAAAA,CAAI,CAAG,GAAIC,CAAAA,eACfD,CAAI,CAACE,kBAALF,CAA0B,UAAY,CACjCA,IAAAA,CAAI,CAACG,UAD4B,GAGjB,GAAhBH,GAAAA,CAAI,CAACI,MAALJ,EAAuC,CAAhBA,GAAAA,CAAI,CAACI,MAHK,CAIpC1B,CAAO,CAACsB,CAAI,CAACK,QAAN,CAJ6B,CAMpCf,CAAM,CAAC,2DAAD,CAN8B,CAQrCU,CAAI,CAAG,IAR8B,CAAtC,CAFM,CAYNA,CAAI,CAACM,UAALN,CAAkB,UAAY,CAEkB,YAA3CA,GAAAA,CAAI,CAACO,iBAALP,CAAuB,cAAvBA,CAFyB,EAG5BA,CAAI,CAACQ,KAALR,EAHF,CAZM,CAkBNA,CAAI,CAACS,eAALT,GAlBM,CAmBNA,CAAI,CAACU,IAALV,CAAU,KAAVA,CAAiBX,CAAjBW,IAnBM,CAoBNA,CAAI,CAACW,YAALX,CAAoB,aApBd,CAqBNA,CAAI,CAACY,IAALZ,CAAU,IAAVA,EApCH,CAyCE,MAAOL,CAAP,CAAU,CACXL,CAAM,CAACK,CAAD,EA3CD,CAAA,EAgDR,QAASE,CAAAA,CAAT,CAAyBnF,CAAzB,CAA8BmG,CAA9B,CAAwC,IACjCb,CAAAA,CAAI,CAAG,GAAIC,CAAAA,eACjBD,CAAI,CAACU,IAALV,CAAU,KAAVA,CAAiBtF,CAAjBsF,IAFuC,CAGvCA,CAAI,CAACW,YAALX,CAAoB,MAHmB,CAIvCA,CAAI,CAACN,MAALM,CAAc,UAAY,EACN,GAAf,OAAKI,MAAL,EAAsC,CAAhB,QAAKA,MADN,GAExBS,CAAQ,CAAC,KAAKR,QAAN,CAFV,CAJuC,CASvCL,CAAI,CAACY,IAALZ,GAGD,QAAST,CAAAA,CAAT,CAA6BuB,CAA7B,CAAqC,CACpCA,CAAM,CAAGA,CAAM,CAACC,OAAPD,CAAe,0BAAfA,CAA2C,EAA3CA,CAD2B,QAE9BE,CAAAA,CAAM,CAAGC,IAAI,CAACH,CAAD,EACbI,CAAG,CAAGF,CAAM,CAACG,OACbC,CAAM,CAAG,GAAIC,CAAAA,WAAJ,CAAgBH,CAAhB,EACTI,CAAI,CAAG,GAAIC,CAAAA,UAAJ,CAAeH,CAAf,EACJI,CAAC,CAAG,EAAGA,CAAC,CAAGN,EAAKM,CAAC,GACzBF,CAAI,CAACE,CAAD,CAAJF,CAAUN,CAAM,CAACS,UAAPT,CAAkBQ,CAAlBR,CAAVM,OAEMF,CAAAA,EAER,QAASM,CAAAA,CAAT,CAA+BC,CAA/B,CAAyCC,CAAzC,CAAgDT,CAAhD,CAAwD,IAEnDK,CAAAA,CAFmD,CACnDK,CAAG,CAAG,EAD6C,KAGlDL,CAAC,CAAGI,CAAJJ,CAAWL,CAAM,EAAIS,EAAOJ,CAAC,CAAGL,EAAQK,CAAC,GAC7CK,CAAG,EAAIlJ,EAAoBgJ,CAAQ,CAACG,QAATH,CAAkBH,CAAlBG,CAApBhJ,CAAPkJ,OAEMA,CAAAA,EAGR,QAAS7C,CAAAA,CAAT,CAAwBD,CAAxB,CAAqC,IAChC,IAEC1B,CAAAA,CAFD,CAGC0E,CAHD,CAICC,CAJD,CAKCC,CALD,CAMCC,CAND,CAOCC,CAPD,CACGR,CAAQ,CAAG,GAAIS,CAAAA,QAAJ,CAAarD,CAAb,CADd,IAS0B,GAAzB4C,GAAAA,CAAQ,CAACG,QAATH,CAAkB,CAAlBA,GAA0D,GAAzBA,GAAAA,CAAQ,CAACG,QAATH,CAAkB,CAAlBA,SAC9BR,CAAAA,CAAM,CAAGQ,CAAQ,CAACU,WACpBC,CAAM,CAAG,EACNA,CAAM,CAAG,CAATA,CAAanB,GAAQ,IACO,GAA9BQ,GAAAA,CAAQ,CAACG,QAATH,CAAkBW,CAAlBX,GAAwE,GAAlCA,GAAAA,CAAQ,CAACG,QAATH,CAAkBW,CAAM,CAAG,CAA3BX,EAAwC,CACjFO,CAAS,CAAGI,CADqE,OAIlFA,CAAM,MAGJJ,IACHH,CAAU,CAAGG,CAAS,CAAG,EACzBF,CAAU,CAAGE,CAAS,CAAG,GAC8B,MAAnDR,GAAAA,CAAqB,CAACC,CAAD,CAAWI,CAAX,CAAuB,CAAvB,GAAsC,IACxDQ,CAAAA,CAAU,CAAGZ,CAAQ,CAACa,SAATb,CAAmBK,CAAnBL,KAEnBM,CAAY,CAAkB,KAAfM,GAAAA,GAEXN,CAAY,EAAmB,KAAfM,GAAAA,IACsC,EAArDZ,GAAAA,CAAQ,CAACa,SAATb,CAAmBK,CAAU,CAAG,CAAhCL,CAAmCM,CAAnCN,EAA6D,IAC1Dc,CAAAA,CAAc,CAAGd,CAAQ,CAACe,SAATf,CAAmBK,CAAU,CAAG,CAAhCL,CAAmCM,CAAnCN,EACD,CAAlBc,EAAAA,CAF4D,GAG/DN,CAAQ,CAAGH,CAAU,CAAGS,CAHuC,MAShEN,SAIEG,CAAAA,EAHCnB,CAAM,CAAGQ,CAAQ,CAACa,SAATb,CAAmBQ,CAAnBR,CAA6BM,CAA7BN,EAENH,CAAC,CAAG,EAAGA,CAAC,CAAGL,EAAQK,CAAC,MACxBc,EAASH,CAAQ,CAAQ,EAAJX,CAAAA,CAAZW,CAAsB,EACc,GAA7CR,GAAAA,CAAQ,CAACa,SAATb,CAAmBW,CAAnBX,CAA2BM,CAA3BN,EAAuE,CAE1EW,CAAM,EAAI,CAFgE,CAI1EjF,CAAW,CAAGsE,CAAQ,CAACa,SAATb,CAAmBW,CAAnBX,CAA2BM,CAA3BN,CAJ4D,CAM1EA,CAAQ,CAACgB,SAAThB,CAAmBW,CAAnBX,CAA2B,CAA3BA,CAA8BM,CAA9BN,CAN0E,aAWtEtE,CAAAA,CAtDR,CAuDE,MAAO6B,CAAP,CAAc,OACR,OAIF,QAAS0D,CAAAA,CAAT,CAA8B7D,CAA9B,CAA2C,QAC3C8D,CAAAA,CAAM,CAAG,EADkC,CAI3CC,CAAS,CAAG,IAJ+B,CAK7CC,CAAK,CAAG,GAAIxB,CAAAA,UAAJ,CAAexC,CAAf,CALqC,CAO3B,CAAfgE,CAAAA,CAAK,CAAC5B,MAPoC,EAOxB,IAClB6B,CAAAA,CAAK,CAAGD,CAAK,CAACE,QAANF,CAAe,CAAfA,CAAkBD,CAAlBC,EACdF,CAAM,CAACK,IAAPL,CAAYlK,EAAoBc,KAApBd,CACX,IADWA,CAEXwK,KAAK,CAACC,IAAND,CAAaA,KAAK,CAACC,IAAND,CAAWH,CAAXG,CAAbA,CAAiCA,KAAK,CAAC3I,KAAN2I,CAAYH,CAAZG,CAFtBxK,CAAZkK,CAFwB,CAMxBE,CAAK,CAAGA,CAAK,CAACE,QAANF,CAAeD,CAAfC,yCAGwBM,IAAI,CAACR,CAAM,CAACS,IAAPT,CAAY,EAAZA,CAAD,GDvQtC,QAASU,CAAAA,CAAT,CAAkBC,CAAlB,CAA+B,OACvB,CACNC,IAAI,CAAED,CAAW,CAACC,IADZ,CAENC,GAAG,CAAEF,CAAW,CAACE,GAFX,CAGNC,KAAK,CAAEH,CAAW,CAACC,IAAZD,CAAmBA,CAAW,CAAClG,KAHhC,CAINsG,MAAM,CAAEJ,CAAW,CAACE,GAAZF,CAAkBA,CAAW,CAAChG,MAJhC,EAQR,QAASqG,CAAAA,CAAT,CAAkBC,CAAlB,CAAwB,IACV,OAATA,GAAAA,QACI,OAFe,MAGH,QAATA,GAAAA,CAHY,CAIf,KAJe,CAKH,MAATA,GAAAA,CAAI,EAAwB,KAATA,GAAAA,CALP,CAMfA,CANe,QAUxB,QAASC,CAAAA,CAAT,CAAyBC,CAAzB,CAA4CC,CAA5C,CAAwD,OAChDD,CAAAA,CAAiB,CAAC1G,KAAlB0G,EAA2BC,CAAU,CAACR,IAAXQ,CAAkBA,CAAU,CAACN,KAAxDK,EAGR,QAASE,CAAAA,CAAT,CAA0BF,CAA1B,CAA6CC,CAA7C,CAAyD,OACjDD,CAAAA,CAAiB,CAACxG,MAAlBwG,EAA4BC,CAAU,CAACP,GAAXO,CAAiBA,CAAU,CAACL,MAAxDI,EAGR,QAASG,CAAAA,CAAT,CAAyBX,CAAzB,CAAsCS,CAAtC,CAAkDG,CAAlD,CAA+D,OACvD,CACNX,IAAI,CAAG,QAAUW,CAAAA,CAAV,CAAyB,CAAC/L,EAAS,CAATA,CAAYA,EAAUmL,CAAW,CAACC,IAAZD,CAAmBY,CAAW,CAACX,IAAzCpL,EAAiD4L,CAAU,CAACR,IAAxEpL,CAA1B,CAA0G,CAD3G,CAENqL,GAAG,CAAG,OAASU,CAAAA,CAAT,CAAwB,CAAC/L,EAAS,CAATA,CAAYA,EAAUmL,CAAW,CAACE,GAAZF,CAAkBY,CAAW,CAACV,GAAxCrL,EAA+C4L,CAAU,CAACP,GAAtErL,CAAzB,CAAsG,CAFtG,CAGNuL,MAAM,CAAG,UAAYQ,CAAAA,CAAZ,CAA2B,CAAC/L,EAAS,CAATA,CAAY+L,CAAW,CAACR,MAAZQ,EAAsBZ,CAAW,CAACI,MAAZJ,CAAqBS,CAAU,CAACL,MAAtDQ,CAAZ/L,CAA5B,CAAyG,CAH5G,CAINsL,KAAK,CAAG,SAAWS,CAAAA,CAAX,CAA0B,CAAC/L,EAAS,CAATA,CAAY+L,CAAW,CAACT,KAAZS,EAAqBZ,CAAW,CAACG,KAAZH,CAAoBS,CAAU,CAACN,KAApDS,CAAZ/L,CAA3B,CAAqG,CAJvG,EAQR,QAASgM,CAAAA,CAAT,EAAA,CAAmJ,IAA9GC,CAAAA,CAA8G,GAA1HL,UAA0H,CAA/FT,CAA+F,GAA/FA,WAA+F,CAAlFe,CAAkF,GAAlFA,YAAkF,CAApEC,CAAoE,GAApEA,mBAAoE,CAA/CC,CAA+C,GAA/CA,WAA+C,KAAlCC,IAAkC,CAAlCA,CAAkC,YAA3B,QAA2B,KAAnBN,WAAmB,CAAnBA,CAAmB,YAAL,IAAK,CAC5IH,CAAU,MAAQK,EAD0H,CAG9IK,CAAY,CAAGZ,CAAe,CAACP,CAAD,CAAcS,CAAd,CAHgH,CAI9IW,CAAa,CAAGV,CAAgB,CAACV,CAAD,CAAcS,CAAd,CAJ8G,CAO/H,CAAfU,CAAAA,CAP8I,GAQ3H,CAAlBV,CAAAA,CAAU,CAACR,IAAXQ,EAA0C,CAAnBA,CAAAA,CAAU,CAACN,KAR2G,EAShJM,CAAU,CAACR,IAAXQ,CAAkB,EAAET,CAAW,CAAClG,KAAZkG,CAAoBe,CAAY,CAACM,QAAnC,GAAgDZ,CAAU,CAACR,IAAXQ,CAAkBA,CAAU,CAACN,KAA7E,CAT8H,CAUhJM,CAAU,CAACN,KAAXM,CAAmB,EAAET,CAAW,CAAClG,KAAZkG,CAAoBe,CAAY,CAACM,QAAnC,GAAgDZ,CAAU,CAACN,KAAXM,CAAmBA,CAAU,CAACR,IAA9E,CAV6H,EAWpH,CAAlBQ,CAAAA,CAAU,CAACR,IAX2H,CAYhJQ,CAAU,CAACR,IAAXQ,CAAkB,EAAET,CAAW,CAAClG,KAAZkG,CAAoBe,CAAY,CAACM,QAAnC,CAZ8H,CAanH,CAAnBZ,CAAAA,CAAU,CAACN,KAb2H,GAchJM,CAAU,CAACN,KAAXM,CAAmB,EAAET,CAAW,CAAClG,KAAZkG,CAAoBe,CAAY,CAACM,QAAnC,CAd6H,GAiB9H,CAAhBD,CAAAA,CAjB8I,GAkB5H,CAAjBX,CAAAA,CAAU,CAACP,GAAXO,EAA0C,CAApBA,CAAAA,CAAU,CAACL,MAlB4G,EAmBhJK,CAAU,CAACP,GAAXO,CAAiB,EAAET,CAAW,CAAChG,MAAZgG,CAAqBe,CAAY,CAACO,SAApC,GAAkDb,CAAU,CAACP,GAAXO,CAAiBA,CAAU,CAACL,MAA9E,CAnB+H,CAoBhJK,CAAU,CAACL,MAAXK,CAAoB,EAAET,CAAW,CAAChG,MAAZgG,CAAqBe,CAAY,CAACO,SAApC,GAAkDb,CAAU,CAACL,MAAXK,CAAoBA,CAAU,CAACP,GAAjF,CApB4H,EAqBrH,CAAjBO,CAAAA,CAAU,CAACP,GArB2H,CAsBhJO,CAAU,CAACP,GAAXO,CAAiB,EAAET,CAAW,CAAChG,MAAZgG,CAAqBe,CAAY,CAACO,SAApC,CAtB+H,CAuBlH,CAApBb,CAAAA,CAAU,CAACL,MAvB2H,GAwBhJK,CAAU,CAACL,MAAXK,CAAoB,EAAET,CAAW,CAAChG,MAAZgG,CAAqBe,CAAY,CAACO,SAApC,CAxB4H,MA6B9IC,CAAAA,CAAM,CAAGZ,CAAe,CAACX,CAAD,CAAcS,CAAd,CAA0BG,CAA1B,EAEf,MAATM,GAAAA,CA/B8I,GAgC/H,CAAdK,CAAAA,CAAM,CAACtB,IAAPsB,EAAoC,CAAjBA,GAAAA,CAAM,CAACpB,KAhCmH,EAiChJM,CAAU,CAACN,KAAXM,EAAoBc,CAAM,CAACtB,IAjCqH,CAkChJQ,CAAU,CAACR,IAAXQ,EAAmBc,CAAM,CAACtB,IAlCsH,EAmCvH,CAAfsB,CAAAA,CAAM,CAACpB,KAAPoB,EAAoC,CAAhBA,GAAAA,CAAM,CAACtB,IAnC2G,GAoChJQ,CAAU,CAACR,IAAXQ,EAAmBc,CAAM,CAACpB,KApCsH,CAqChJM,CAAU,CAACN,KAAXM,EAAoBc,CAAM,CAACpB,KArCqH,EAwChI,CAAboB,CAAAA,CAAM,CAACrB,GAAPqB,EAAoC,CAAlBA,GAAAA,CAAM,CAACnB,MAxCoH,EAyChJK,CAAU,CAACL,MAAXK,EAAqBc,CAAM,CAACrB,GAzCoH,CA0ChJO,CAAU,CAACP,GAAXO,EAAkBc,CAAM,CAACrB,GA1CuH,EA2CtH,CAAhBqB,CAAAA,CAAM,CAACnB,MAAPmB,EAAoC,CAAfA,GAAAA,CAAM,CAACrB,GA3C0G,GA4ChJO,CAAU,CAACP,GAAXO,EAAkBc,CAAM,CAACnB,MA5CuH,CA6ChJK,CAAU,CAACL,MAAXK,EAAqBc,CAAM,CAACnB,MA7CoH,EAgDjJmB,CAAM,CAAGZ,CAAe,CAACX,CAAD,CAAcS,CAAd,CAA0BG,CAA1B,CAhDyH,KAmD5IY,CAAAA,CAAS,CAAG,CACjB1H,KAAK,IADY,CAEjBE,MAAM,IAFW,KAKlByH,EAAc,CAACC,OAAfD,CAAuB,SAAAE,CAAA,CAAa,CAElCH,CAAS,CAACG,CAAD,CAFyB,CAC/BJ,CAAM,CAACI,CAAD,CAANJ,EAAqBd,CAAU,CAACkB,CAAD,CADA,CAEX9M,EAAS,CAATA,CAAY,EAAI0M,CAAM,CAACI,CAAD,CAANJ,CAAqBd,CAAU,CAACkB,CAAD,CAA/C9M,CAFW,IAApC,CAAA4M,EAQIT,EAAqB,IAClBY,CAAAA,CAAU,CAAG/M,OAAAA,CAAAA,IAAAA,GAAY4M,EAAc,CAACI,GAAfJ,CAAmB,SAAAE,CAAA,QAAaH,CAAAA,CAAS,CAACG,CAAD,CAAzC,CAAAF,EAAZ5M,EACf+M,CAAU,MAFU,EAGvBH,EAAc,CAACC,OAAfD,CAAuB,SAAAE,CAAA,CAAa,CACnClB,CAAU,CAACkB,CAAD,CAAVlB,EAAyBmB,CAD1B,CAAAH,CAHF,KAQCK,CAAAA,EAAqB,CAACJ,OAAtBI,CAA8B,SAAAH,CAAA,CAAa,IACpCC,CAAAA,CAAU,CAAGX,CAAW,CAAGpM,EAAS2M,CAAS,CAACtB,GAAnBrL,CAAwB2M,CAAS,CAACpB,MAAlCvL,CAAH,CAA+C2M,CAAS,CAACG,CAAD,EAClFC,CAAU,MAF4B,GAGzCnB,CAAU,CAACkB,CAAD,CAAVlB,EAAyBmB,CAHgB,CAA3C,CAAAE,EAMAC,EAAmB,CAACL,OAApBK,CAA4B,SAAAJ,CAAA,CAAa,IAClCC,CAAAA,CAAU,CAAGX,CAAW,CAAGpM,EAAS2M,CAAS,CAACtB,GAAnBrL,CAAwB2M,CAAS,CAACpB,MAAlCvL,CAAH,CAA+C2M,CAAS,CAACG,CAAD,EAClFC,CAAU,MAF0B,GAGvCnB,CAAU,CAACkB,CAAD,CAAVlB,EAAyBmB,CAHc,CAAzC,CAAAG,KAQDZ,CAAY,CAAGZ,CAAe,CAACP,CAAD,CAAcS,CAAd,EAC9BW,CAAa,CAAGV,CAAgB,CAACV,CAAD,CAAcS,CAAd,EAE5BA,CAAU,CAACN,KAAXM,CAAmBA,CAAU,CAACR,OAC7BkB,CAAY,CAAGJ,CAAY,CAACiB,SAC/BR,CAAS,CAAC1H,KAAV0H,CAAkB,CAACT,CAAY,CAACiB,QAAbjB,CAAwBf,CAAW,CAAClG,KAArC,GAA+C2G,CAAU,CAACN,KAAXM,CAAmBA,CAAU,CAACR,IAA7E,EACRkB,CAAY,CAAGJ,CAAY,CAACM,WACtCG,CAAS,CAAC1H,KAAV0H,CAAkB,CAACT,CAAY,CAACM,QAAbN,CAAwBf,CAAW,CAAClG,KAArC,GAA+C2G,CAAU,CAACN,KAAXM,CAAmBA,CAAU,CAACR,IAA7E,IAIhBQ,CAAU,CAACL,MAAXK,CAAoBA,CAAU,CAACP,MAC9BkB,CAAa,CAAGL,CAAY,CAACkB,UAChCT,CAAS,CAACxH,MAAVwH,CAAmB,CAACT,CAAY,CAACkB,SAAblB,CAAyBf,CAAW,CAAChG,MAAtC,GAAiDyG,CAAU,CAACL,MAAXK,CAAoBA,CAAU,CAACP,GAAhF,EACTkB,CAAa,CAAGL,CAAY,CAACO,YACvCE,CAAS,CAACxH,MAAVwH,CAAmB,CAACT,CAAY,CAACO,SAAbP,CAAyBf,CAAW,CAAChG,MAAtC,GAAiDyG,CAAU,CAACL,MAAXK,CAAoBA,CAAU,CAACP,GAAhF,IAIjBc,EAAqB,IAClBY,CAAAA,CAAU,CAAG/M,EAAS2M,CAAS,CAAC1H,KAAnBjF,CAA0B2M,CAAS,CAACxH,MAApCnF,EACf+M,CAAU,MAFU,EAGvBH,EAAc,CAACC,OAAfD,CAAuB,SAAAE,CAAA,CAAa,CACnClB,CAAU,CAACkB,CAAD,CAAVlB,EAAyBmB,CAD1B,CAAAH,CAHF,KASKD,CAAAA,CAAS,CAAC1H,KAAV0H,QACHM,EAAqB,CAACJ,OAAtBI,CAA8B,SAAAH,CAAA,CAAa,CAC1ClB,CAAU,CAACkB,CAAD,CAAVlB,EAAyBe,CAAS,CAAC1H,KADpC,CAAAgI,EAIGN,CAAS,CAACxH,MAAVwH,QACHO,EAAmB,CAACL,OAApBK,CAA4B,SAAAJ,CAAA,CAAa,CACxClB,CAAU,CAACkB,CAAD,CAAVlB,EAAyBe,CAAS,CAACxH,MADpC,CAAA+H,QAMKtB,CAAAA,EAKR,QAASyB,CAAAA,CAAT,CAAwBf,CAAxB,CAAsCC,CAAtC,CAAqDe,CAArD,CAAkE3B,CAAlE,CAAqFQ,CAArF,CAA0G,IACrGoB,CAAAA,QACAD,CAAAA,CAAW,CAACE,OAAZF,EAAuBhB,CAAY,CAAGC,CAAfD,CAA+BgB,CAAW,CAACE,QACrED,CAAW,CAAGD,CAAW,CAACE,QAChBF,CAAW,CAACG,OAAZH,EAAuBhB,CAAY,CAAGC,CAAfD,CAA+BgB,CAAW,CAACG,QAC5EF,CAAW,CAAGD,CAAW,CAACG,QAChBtB,IACVoB,CAAW,CAAG5B,CAAiB,CAAC1G,KAAlB0G,CAA0BA,CAAiB,CAACxG,QAEpDoI,EAmHD,QAASG,CAAAA,CAAT,EAAA,CAA6D,IAA5CvC,CAAAA,CAA4C,GAA5CA,WAA4C,KAA/BY,WAA+B,CAA/BA,CAA+B,YAAjB,IAAiB,CAAb4B,CAAa,GAAbA,SAAa,CAE7D/B,CAAU,MACZ+B,CAAS,CAAC/B,WAHqD,CAM7DgC,CAAc,CAAG,CACtBxC,IAAI,CAAED,CAAW,CAACC,IAAZD,CAAmBS,CAAU,CAACR,IADd,CAEtBC,GAAG,CAAEF,CAAW,CAACE,GAAZF,CAAkBS,CAAU,CAACP,GAFZ,CAGtBpG,KAAK,CAAEkG,CAAW,CAAClG,KAHG,CAItBE,MAAM,CAAEgG,CAAW,CAAChG,MAJE,CAN4C,OAa/D,QAAU4G,CAAAA,CAAV,EAAyB6B,CAAc,CAACxC,IAAfwC,CAAsB7B,CAAW,CAACX,OAC9DwC,CAAc,CAACxC,IAAfwC,CAAsB7B,CAAW,CAACX,MAE/B,SAAWW,CAAAA,CAAX,EAA0B6B,CAAc,CAACxC,IAAfwC,CAAsBA,CAAc,CAAC3I,KAArC2I,CAA6C7B,CAAW,CAACT,QACtFsC,CAAc,CAACxC,IAAfwC,CAAsB7B,CAAW,CAACT,KAAZS,CAAoB6B,CAAc,CAAC3I,OAEtD,OAAS8G,CAAAA,CAAT,EAAwB6B,CAAc,CAACvC,GAAfuC,CAAqB7B,CAAW,CAACV,MAC5DuC,CAAc,CAACvC,GAAfuC,CAAqB7B,CAAW,CAACV,KAE9B,UAAYU,CAAAA,CAAZ,EAA2B6B,CAAc,CAACvC,GAAfuC,CAAqBA,CAAc,CAACzI,MAApCyI,CAA6C7B,CAAW,CAACR,SACvFqC,CAAc,CAACvC,GAAfuC,CAAqB7B,CAAW,CAACR,MAAZQ,CAAqB6B,CAAc,CAACzI,QAGnDyI,EAoED,QAASC,CAAAA,CAAT,EAAA,CAAkK,IAA9I1C,CAAAA,CAA8I,GAA9IA,WAA8I,CAA7G2C,CAA6G,GAAjIC,kBAAiI,CAAhEC,CAAgE,GAAjFC,eAAiF,CAAvCC,CAAuC,GAAvCA,WAAuC,CAA1BC,CAA0B,GAA1BA,SAA0B,CAAfpC,CAAe,GAAfA,WAAe,CAClKkC,CAAe,MACjBD,EAFoK,CAKlKD,CAAkB,CAAG,CAC1B9I,KAAK,CAAEgJ,CAAe,CAACxI,KAAhBwI,CAAwB9C,CAAW,CAAClG,KAApCgJ,CAA4CC,CADzB,CAE1B/I,MAAM,CAAE8I,CAAe,CAACxI,KAAhBwI,CAAwB9C,CAAW,CAAChG,MAApC8I,CAA6CC,CAF3B,CAG1B9C,IAAI,CAAE0C,CAA0B,CAAC1C,IAHP,CAI1BC,GAAG,CAAEyC,CAA0B,CAACzC,GAJN,CAL6I,CAYxK4C,CAAe,CAACG,KAAhBH,CAAsB7C,IAAtB6C,EAA+B9C,CAAW,CAACC,IAAZD,CAAmB8C,CAAe,CAACxI,KAAnC0F,CAA2C8C,CAAe,CAACG,KAAhBH,CAAsB7C,IAAjED,CAAyE2C,CAA0B,CAAC1C,IAA3B0C,CAAkCI,CAZ8B,CAaxKD,CAAe,CAACG,KAAhBH,CAAsB5C,GAAtB4C,EAA8B9C,CAAW,CAACE,GAAZF,CAAkB8C,CAAe,CAACxI,KAAlC0F,CAA0C8C,CAAe,CAACG,KAAhBH,CAAsB5C,GAAhEF,CAAuE2C,CAA0B,CAACzC,GAA3ByC,CAAiCI,CAbkC,IAgBpKnB,CAAAA,CAAU,CAAG,EACbgB,CAAkB,CAAC9I,KAAnB8I,CAA2BI,CAAS,CAAClJ,KAAVkJ,CAAkBD,CAjBuH,GAkBvKnB,CAAU,CAAG/M,EAAS+M,CAAT/M,CAAqBmO,CAAS,CAAClJ,KAAVkJ,CAAkBD,CAAlBC,CAAgCJ,CAAkB,CAAC9I,KAAxEjF,CAlB0J,EAoBpK+N,CAAkB,CAAC5I,MAAnB4I,CAA4BI,CAAS,CAAChJ,MAAVgJ,CAAmBD,CApBqH,GAqBvKnB,CAAU,CAAG/M,EAAS+M,CAAT/M,CAAqBmO,CAAS,CAAChJ,MAAVgJ,CAAmBD,CAAnBC,CAAiCJ,CAAkB,CAAC5I,MAAzEnF,CArB0J,EAwBrJ,CAAf+M,GAAAA,CAxBoK,GAyBvKkB,CAAe,CAACxI,KAAhBwI,EAAyBlB,CAzB8I,CA0BvKgB,CAAkB,CAAC3C,IAAnB2C,EAA2BA,CAAkB,CAAC9I,KAAnB8I,EAA4B,EAAIhB,CAAhCgB,EAA4C,CA1BgG,CA2BvKA,CAAkB,CAAC1C,GAAnB0C,EAA0BA,CAAkB,CAAC5I,MAAnB4I,EAA6B,EAAIhB,CAAjCgB,EAA6C,CA3BgG,CA4BvKE,CAAe,CAACG,KAAhBH,CAAsB7C,IAAtB6C,CAA6BF,CAAkB,CAAC3C,IAAnB2C,CAA0BG,CAA1BH,CAAyC5C,CAAW,CAACC,IAAZD,CAAoB8C,CAAe,CAACxI,KA5B6D,CA6BvKwI,CAAe,CAACG,KAAhBH,CAAsB5C,GAAtB4C,CAA4BF,CAAkB,CAAC1C,GAAnB0C,CAAyBG,CAAzBH,CAAwC5C,CAAW,CAACE,GAAZF,CAAmB8C,CAAe,CAACxI,KA7BgE,CA8BvKsI,CAAkB,CAAC9I,KAAnB8I,EAA4BhB,CA9B2I,CA+BvKgB,CAAkB,CAAC5I,MAAnB4I,EAA6BhB,CA/B0I,EAmC1I,CAA1BgB,CAAAA,CAAkB,CAAC3C,IAnCiJ,GAoCvK6C,CAAe,CAACG,KAAhBH,CAAsB7C,IAAtB6C,EAA8BF,CAAkB,CAAC3C,IAAnB2C,CAA0BG,CApC+G,CAqCvKH,CAAkB,CAAC3C,IAAnB2C,CAA0B,CArC6I,EAwC3I,CAAzBA,CAAAA,CAAkB,CAAC1C,GAxCiJ,GAyCvK4C,CAAe,CAACG,KAAhBH,CAAsB5C,GAAtB4C,EAA6BF,CAAkB,CAAC1C,GAAnB0C,CAAyBG,CAzCiH,CA0CvKH,CAAkB,CAAC1C,GAAnB0C,CAAyB,CA1C8I,EA6CpKA,CAAkB,CAAC3C,IAAnB2C,CAA0BA,CAAkB,CAAC9I,KAA7C8I,CAAqDI,CAAS,CAAClJ,KAAVkJ,CAAkBD,CA7C6F,GA8CvKD,CAAe,CAACG,KAAhBH,CAAsB7C,IAAtB6C,EAA8B,CAACF,CAAkB,CAAC3C,IAAnB2C,CAA0BA,CAAkB,CAAC9I,KAA9C,EAAuDiJ,CAAvD,CAAqEC,CAAS,CAAClJ,KA9C0D,CA+CvK8I,CAAkB,CAAC3C,IAAnB2C,CAA0BI,CAAS,CAAClJ,KAAVkJ,CAAkBD,CAAlBC,CAAgCJ,CAAkB,CAAC9I,KA/C0F,EAkDpK8I,CAAkB,CAAC1C,GAAnB0C,CAAyBA,CAAkB,CAAC5I,MAA5C4I,CAAqDI,CAAS,CAAChJ,MAAVgJ,CAAmBD,CAlD4F,GAmDvKD,CAAe,CAACG,KAAhBH,CAAsB5C,GAAtB4C,EAA6B,CAACF,CAAkB,CAAC1C,GAAnB0C,CAAyBA,CAAkB,CAAC5I,MAA7C,EAAuD+I,CAAvD,CAAqEC,CAAS,CAAChJ,MAnD2D,CAoDvK4I,CAAkB,CAAC1C,GAAnB0C,CAAyBI,CAAS,CAAChJ,MAAVgJ,CAAmBD,CAAnBC,CAAiCJ,CAAkB,CAAC5I,MApD0F,KAwDlKkJ,CAAAA,CAAe,CAAG,CACvBpJ,KAAK,CAAEkJ,CAAS,CAAClJ,KAAVkJ,CAAkBF,CAAe,CAACxI,KADlB,CAEvBN,MAAM,CAAEgJ,CAAS,CAAChJ,MAAVgJ,CAAmBF,CAAe,CAACxI,KAFpB,QAKpBwI,CAAAA,CAAe,CAACG,KAAhBH,CAAsB7C,IAAtB6C,CAA6B,CAAClC,CAAW,CAACX,IAAb,CAAoB6C,CAAe,CAACxI,QACpEsI,CAAkB,CAAC3C,IAAnB2C,EAA2B,CAACE,CAAe,CAACG,KAAhBH,CAAsB7C,IAAtB6C,CAA8BlC,CAAW,CAACX,IAAZW,CAAmBkC,CAAe,CAACxI,KAAlE,EAA4EyI,EACvGD,CAAe,CAACG,KAAhBH,CAAsB7C,IAAtB6C,CAA6B,EAAElC,CAAW,CAACX,IAAZW,CAAmBkC,CAAe,CAACxI,KAArC,GAE1BwI,CAAe,CAACG,KAAhBH,CAAsB7C,IAAtB6C,CAA6BE,CAAS,CAAClJ,KAAVkJ,CAAkBE,CAAe,CAACpJ,KAAlCkJ,CAA0C,CAACpC,CAAW,CAACT,KAAZS,CAAoBoC,CAAS,CAAClJ,KAA/B,EAAwCgJ,CAAe,CAACxI,QAClIsI,CAAkB,CAAC3C,IAAnB2C,EAA2B,CAACE,CAAe,CAACG,KAAhBH,CAAsB7C,IAAtB6C,EAA8BE,CAAS,CAAClJ,KAAVkJ,CAAkBE,CAAe,CAACpJ,KAAhEgJ,EAAyE,CAAClC,CAAW,CAACT,KAAZS,CAAoBoC,CAAS,CAAClJ,KAA/B,EAAwCgJ,CAAe,CAACxI,KAAlI,EAA2IyI,EACtKD,CAAe,CAACG,KAAhBH,CAAsB7C,IAAtB6C,CAA6BE,CAAS,CAAClJ,KAAVkJ,CAAkBE,CAAe,CAACpJ,KAAlCkJ,CAA0C,CAACpC,CAAW,CAACT,KAAZS,CAAoBoC,CAAS,CAAClJ,KAA/B,EAAwCgJ,CAAe,CAACxI,OAE5HwI,CAAe,CAACG,KAAhBH,CAAsB5C,GAAtB4C,CAA4B,CAAClC,CAAW,CAACV,GAAb,CAAmB4C,CAAe,CAACxI,QAClEsI,CAAkB,CAAC1C,GAAnB0C,EAA0B,CAACE,CAAe,CAACG,KAAhBH,CAAsB5C,GAAtB4C,CAA6BlC,CAAW,CAACV,GAAZU,CAAkBkC,CAAe,CAACxI,KAAhE,EAA0EyI,EACpGD,CAAe,CAACG,KAAhBH,CAAsB5C,GAAtB4C,CAA4B,CAAClC,CAAW,CAACV,GAAb,CAAmB4C,CAAe,CAACxI,OAE5DwI,CAAe,CAACG,KAAhBH,CAAsB5C,GAAtB4C,CAA4BE,CAAS,CAAChJ,MAAVgJ,CAAmBE,CAAe,CAAClJ,MAAnCgJ,CAA4C,CAACpC,CAAW,CAACR,MAAZQ,CAAqBoC,CAAS,CAAChJ,MAAhC,EAA0C8I,CAAe,CAACxI,QACrIsI,CAAkB,CAAC1C,GAAnB0C,EAA0B,CAACE,CAAe,CAACG,KAAhBH,CAAsB5C,GAAtB4C,EAA6BE,CAAS,CAAChJ,MAAVgJ,CAAmBE,CAAe,CAAClJ,MAAhE8I,EAA0E,CAAClC,CAAW,CAACR,MAAZQ,CAAqBoC,CAAS,CAAChJ,MAAhC,EAA0C8I,CAAe,CAACxI,KAArI,EAA8IyI,EACxKD,CAAe,CAACG,KAAhBH,CAAsB5C,GAAtB4C,CAA4BE,CAAS,CAAChJ,MAAVgJ,CAAmBE,CAAe,CAAClJ,MAAnCgJ,CAA4C,CAACpC,CAAW,CAACR,MAAZQ,CAAqBoC,CAAS,CAAChJ,MAAhC,EAA0C8I,CAAe,CAACxI,OAG5H,CACNsI,kBAAkB,CAAlBA,CADM,CAENE,eAAe,CAAfA,CAFM,EAMD,QAASK,CAAAA,CAAT,EAAA,CAAoN,IAAzLC,CAAAA,CAAyL,GAAzLA,oBAAyL,CAAnKpD,CAAmK,GAAnKA,WAAmK,CAAtJqD,CAAsJ,GAAtJA,mBAAsJ,CAAjIN,CAAiI,GAAjIA,WAAiI,CAApHH,CAAoH,GAApHA,kBAAoH,CAA/EC,CAA+E,GAAhGC,eAAgG,CAAtDE,CAAsD,GAAtDA,SAAsD,CAA3CM,CAA2C,GAA3CA,gBAA2C,CAAzB1C,CAAyB,GAAzBA,WAAyB,CAAZ2C,CAAY,GAAZA,QAAY,CACpNjJ,CADoN,CACpM8I,CADoM,CACpN9I,KADoN,CAC7MiI,CAD6M,CACpMa,CADoM,CAC7Mb,IAD6M,CAEpNO,CAAe,MAAQD,EAF6L,CAIpNK,CAAe,CAAG,CACvBpJ,KAAK,CAAEkJ,CAAS,CAAClJ,KAAVkJ,CAAkBF,CAAe,CAACxI,KADlB,CAEvBN,MAAM,CAAEgJ,CAAS,CAAChJ,MAAVgJ,CAAmBF,CAAe,CAACxI,KAFpB,CAJkM,CASpNkJ,CAAW,CAAG,CACnBvD,IAAI,CAAEsC,CAAI,CAACtC,IAALsC,EAAa,CADA,CAEnBrC,GAAG,CAAEqC,CAAI,CAACrC,GAALqC,EAAY,CAFE,CATsM,CActNkB,CAAU,CAAG,CAdyM,CAetNC,CAAY,CAAG,CAfuM,CAiBpNC,CAAQ,CAAIJ,CAAD,CAGb,CAHa,CAAY1O,EAC3B,QAAU+L,CAAAA,CAAV,EAAyB,SAAWA,CAAAA,CAApC,CAAmDgC,CAAkB,CAAC9I,KAAnB8I,CAA2BG,CAA3BH,EAA0ChC,CAAW,CAACT,KAAZS,CAAoBA,CAAW,CAACX,IAA1E2C,CAAnD,CAAqI,GAD1G/N,CAE3B,OAAS+L,CAAAA,CAAT,EAAwB,UAAYA,CAAAA,CAApC,CAAmDgC,CAAkB,CAAC5I,MAAnB4I,CAA4BG,CAA5BH,EAA2ChC,CAAW,CAACR,MAAZQ,CAAqBA,CAAW,CAACV,GAA5E0C,CAAnD,CAAsI,GAF3G/N,CAjB6L,IAuBtN,CAACyO,CAAgB,CAACxJ,KAAlB,EAA2B,CAACwJ,CAAgB,CAACtJ,MAA7C,EAAoF,IAA7BnF,GAASyF,CAAK,CAACsJ,MAANtJ,CAAe,CAAxBzF,EAAmC,IACvFgP,CAAAA,CAAO,CAAGhP,EAAS,EAAI4O,CAAb5O,EAA2B,CADkD,CAErFmN,CAFqF,CAExCqB,CAFwC,CAErFrB,QAFqF,CAE3EC,CAF2E,CAExCoB,CAFwC,CAE3EpB,SAF2E,CAEhEZ,CAFgE,CAExCgC,CAFwC,CAEhEhC,QAFgE,CAEtDC,CAFsD,CAExC+B,CAFwC,CAEtD/B,SAFsD,CAI7FmC,CAAU,CAAGnJ,CAAK,CAACsJ,MAJ0E,CAOzFd,CAAe,CAACxI,KAAhBwI,CAAwBW,CAAxBX,CAAqCa,CAAQ,CAAGE,CAPyC,GAQ5FJ,CAAU,CAAGX,CAAe,CAACxI,KAAhBwI,CAAwBa,CARuD,KAWzF7J,CAAAA,CAAK,CAAGkG,CAAW,CAAClG,KAAZkG,CAAoByD,CAX6D,CAYzFzJ,CAAM,CAAGgG,CAAW,CAAChG,MAAZgG,CAAqByD,CAZ2D,CAevFlC,CAAM,CAAG,CACdF,QAAQ,CAAEvH,CAAK,CAAGuH,CAAQ,CAAGwC,CADf,CAEdvC,SAAS,CAAEtH,CAAM,CAAGsH,CAAS,CAAGuC,CAFlB,CAGd7B,QAAQ,CAAElI,CAAK,CAAGkI,CAAQ,CAAG6B,CAHf,CAId5B,SAAS,CAAEjI,CAAM,CAAGiI,CAAS,CAAG4B,CAJlB,CAf8E,IAsBzFtC,CAAM,CAACF,WACVoC,CAAU,CAAGpC,CAAQ,CAAGrB,CAAW,CAAClG,OAEjCyH,CAAM,CAACD,YACVmC,CAAU,CAAGnC,CAAS,CAAGtB,CAAW,CAAChG,QAElCuH,CAAM,CAACU,SAAPV,EAAoBA,CAAM,CAACS,SAAU,IACpC8B,CAAAA,CAAiB,CAAGL,EACpBlC,CAAM,CAACS,QAAPT,EAAmBA,CAAM,CAACU,SAFU,CAGvC6B,CAAiB,CAAGjP,EAASoN,CAAS,CAAGjC,CAAW,CAAChG,MAAjCnF,CAAyCmL,CAAW,CAAClG,KAArDjF,CAHmB,CAI7B0M,CAAM,CAACU,SAJsB,CAKvC6B,CAAiB,CAAG7B,CAAS,CAAGjC,CAAW,CAAChG,MALL,CAM7BuH,CAAM,CAACS,QANsB,GAOvC8B,CAAiB,CAAG9B,CAAQ,CAAGhC,CAAW,CAAClG,KAPJ,EASE,CAAtCgJ,EAAAA,CAAe,CAACxI,KAAhBwI,CAAwBW,CATY,CAUvCC,CAAY,CAAGI,CAAiB,CAAGL,CAVI,CAYvCA,CAAU,CAAGK,KAITC,CAAAA,CAAgB,CAAG,CACxBjK,KAAK,CAAEoJ,CAAe,CAACpJ,KAAhBoJ,EAAyB,EAAI,EAAEO,CAA/BP,CADiB,CAExBlJ,MAAM,CAAGkJ,CAAe,CAAClJ,MAAhBkJ,EAA0B,EAAI,EAAEO,CAAhCP,CAFe,EAKzBM,CAAW,CAACvD,IAAZuD,EAAoBO,CAAgB,CAACjK,KAAjBiK,CAAyBlP,EAAS,CAACiO,CAAe,CAACG,KAAhBH,CAAsB7C,IAAtB6C,CAA6BxI,CAAK,CAAC0J,MAAN1J,CAAa2F,IAAb3F,CAAoByI,CAAlD,EAAiEG,CAAe,CAACpJ,KAA1FjF,CAjDgD,CAkD7F2O,CAAW,CAACtD,GAAZsD,EAAmBO,CAAgB,CAAC/J,MAAjB+J,CAA0BlP,EAAS,CAACiO,CAAe,CAACG,KAAhBH,CAAsB5C,GAAtB4C,CAA4BxI,CAAK,CAAC0J,MAAN1J,CAAa4F,GAAb5F,CAAmByI,CAAhD,EAA+DG,CAAe,CAAClJ,MAAxFnF,CAlDgD,CAoD7FqO,CAAe,CAACpJ,KAAhBoJ,EAAyBO,CApDoE,CAqD7FP,CAAe,CAAClJ,MAAhBkJ,EAA0BO,KAG3BX,CAAe,CAACxI,OAAgCmJ,EAI5CF,EAC4D,CAA3D1O,GAAUiO,CAAe,CAACG,KAAhBH,CAAsB7C,IAAtB6C,CAA6BU,CAAW,CAACvD,IAAnDpL,EACH2O,CAAW,CAACvD,IAAZuD,CAAmB,CAACV,CAAe,CAACG,KAAhBH,CAAsB7C,KAChC6C,CAAe,CAACG,KAAhBH,CAAsB7C,IAAtB6C,CAA6BU,CAAW,CAACvD,IAAzC6C,CAAgDE,CAAS,CAAClJ,KAAVkJ,CAAkBE,CAAe,CAACpJ,QAC5F0J,CAAW,CAACvD,IAAZuD,CAAmBR,CAAS,CAAClJ,KAAVkJ,CAAkBE,CAAe,CAACpJ,KAAlCkJ,CAA2CF,CAAe,CAACG,KAAhBH,CAAsB7C,MAGxB,CAAzDpL,GAAUiO,CAAe,CAACG,KAAhBH,CAAsB5C,GAAtB4C,CAA4BU,CAAW,CAACtD,GAAlDrL,EACH2O,CAAW,CAACtD,GAAZsD,CAAkB,CAACV,CAAe,CAACG,KAAhBH,CAAsB5C,IAC/B4C,CAAe,CAACG,KAAhBH,CAAsB5C,GAAtB4C,CAA4BU,CAAW,CAACtD,GAAxC4C,CAA8CE,CAAS,CAAChJ,MAAVgJ,CAAmBE,CAAe,CAAClJ,SAC3FwJ,CAAW,CAACtD,GAAZsD,CAAkBR,CAAS,CAAChJ,MAAVgJ,CAAmBE,CAAe,CAAClJ,MAAnCgJ,CAA4CF,CAAe,CAACG,KAAhBH,CAAsB5C,SAE/E,IACAqB,CAAAA,CAAM,CAAG,GACfE,EAAc,CAACC,OAAfD,CAAuB,SAAAnB,CAAA,CAAQ,CAE7BiB,CAAM,CAACjB,CAAD,CAFuB,CAC1BA,CAAI,GAAIM,CAAAA,CADkB,CAEbkC,CAAe,CAACG,KAAhBH,CAAsBzC,CAAQ,CAACC,CAAD,CAA9BwC,EAAwCU,CAAW,CAACnD,CAAQ,CAACC,CAAD,CAAT,CAAnDwC,EAAwElC,CAAW,CAACN,CAAD,CAAXM,CAAoBkC,CAAe,CAACxI,KAApCsG,CAA4Cb,CAAQ,CAAC6C,CAAD,CAAR7C,CAA6BO,CAA7BP,EAAqCgD,CAAzJD,CAFa,CAId,CAJjB,CAAArB,CAFM,CAWY,CAAdF,CAAAA,CAAM,CAACtB,IAXL,CAYLuD,CAAW,CAACvD,IAAZuD,EAAoBjC,CAAM,CAACtB,IAZtB,CAaoB,CAAfsB,CAAAA,CAAM,CAACpB,KAbZ,GAcLqD,CAAW,CAACvD,IAAZuD,EAAoBjC,CAAM,CAACpB,KAdtB,EAgBW,CAAboB,CAAAA,CAAM,CAACrB,GAhBL,CAiBLsD,CAAW,CAACtD,GAAZsD,EAAmBjC,CAAM,CAACrB,GAjBrB,CAkBqB,CAAhBqB,CAAAA,CAAM,CAACnB,MAlBZ,GAmBLoD,CAAW,CAACtD,GAAZsD,EAAmBjC,CAAM,CAACnB,MAnBrB,EAuBP0C,CAAe,CAACG,KAAhBH,CAAsB7C,IAAtB6C,EAA8BU,CAAW,CAACvD,IAtHgL,CAuH1N6C,CAAe,CAACG,KAAhBH,CAAsB5C,GAAtB4C,EAA6BU,CAAW,CAACtD,GAvHiL,IAyHpN+D,CAAAA,CAAmB,CAAG,CAAEhE,IAAI,CAAE,CAAR,CAAWC,GAAG,CAAE,CAAhB,QACxB8C,CAAAA,CAAS,CAAClJ,KAAVkJ,GAAoBhD,CAAW,CAAClG,KAAhCkJ,EAAkE,CAAzBF,EAAAA,CAAe,CAACxI,QAC5D2J,CAAmB,CAAChE,IAApBgE,CAA2BrB,CAAkB,CAAC9I,KAAnB8I,EAA4B,EAAIc,CAAhCd,GAAiD5C,CAAW,CAACC,IAAZD,EAAoBgD,CAAS,CAAClJ,KAAVkJ,CAAkBhD,CAAW,CAAClG,KAAlDkG,CAAjD4C,GAExBI,CAAS,CAAChJ,MAAVgJ,GAAqBhD,CAAW,CAAChG,MAAjCgJ,EAAoE,CAAzBF,EAAAA,CAAe,CAACxI,QAC9D2J,CAAmB,CAAC/D,GAApB+D,CAA0BrB,CAAkB,CAAC5I,MAAnB4I,EAA6B,EAAIc,CAAjCd,GAAkD5C,CAAW,CAACE,GAAZF,EAAmBgD,CAAS,CAAChJ,MAAVgJ,CAAmBhD,CAAW,CAAChG,MAAlDgG,CAAlD4C,GAGpB,CACN5C,WAAW,CAAE,CACZlG,KAAK,CAAEkG,CAAW,CAAClG,KAAZkG,CAAoByD,CAApBzD,CAAiC0D,CAD5B,CAEZ1J,MAAM,CAAEgG,CAAW,CAAChG,MAAZgG,CAAqByD,CAArBzD,CAAkC0D,CAF9B,CAGZzD,IAAI,CAAE,CAAC2C,CAAkB,CAAC3C,IAAnB2C,CAA0BE,CAAe,CAACG,KAAhBH,CAAsB7C,IAAtB6C,CAA6BC,CAAvDH,CAAqEqB,CAAmB,CAAChE,IAA1F,EAAkG8C,CAAlG,CAAgHD,CAAe,CAACxI,KAH1H,CAIZ4F,GAAG,CAAE,CAAC0C,CAAkB,CAAC1C,GAAnB0C,CAAyBE,CAAe,CAACG,KAAhBH,CAAsB5C,GAAtB4C,CAA4BC,CAArDH,CAAmEqB,CAAmB,CAAC/D,GAAxF,EAA+F6C,CAA/F,CAA6GD,CAAe,CAACxI,KAJtH,CADP,CAONwI,eAAe,CAAfA,CAPM,EA6CD,QAASoB,CAAAA,CAAT,EAAA,CAAsE,OAEpErP,IAAI,CAACsP,KAF+D,CAA1CnE,CAA0C,GAA1CA,WAA0C,CAA7Be,CAA6B,GAA7BA,YAA6B,CAAfH,CAAe,GAAfA,WAAe,CACtEwD,CAAkB,CAAG,CAC1BtK,KAAK,CAAEjF,EAAWmL,CAAW,CAAClG,KAAvBjF,CADmB,CAE1BmF,MAAM,CAAEnF,EAAWmL,CAAW,CAAChG,MAAvBnF,CAFkB,CAG1BoL,IAAI,CAAEpL,EAAWmL,CAAW,CAACC,IAAvBpL,CAHoB,CAI1BqL,GAAG,CAAErL,EAAWmL,CAAW,CAACE,GAAvBrL,CAJqB,CADiD,OAQxEuP,CAAAA,CAAkB,CAACtK,KAAnBsK,CAA2BrD,CAAY,CAACiB,SAC3CoC,CAAkB,CAACtK,KAAnBsK,CAA2BvP,EAAWmL,CAAW,CAAClG,KAAvBjF,EACjBuP,CAAkB,CAACtK,KAAnBsK,CAA2BrD,CAAY,CAACM,WAClD+C,CAAkB,CAACtK,KAAnBsK,CAA2BvP,EAAUmL,CAAW,CAAClG,KAAtBjF,GAExBuP,CAAkB,CAACpK,MAAnBoK,CAA4BrD,CAAY,CAACkB,UAC5CmC,CAAkB,CAACpK,MAAnBoK,CAA4BvP,EAAWmL,CAAW,CAAChG,MAAvBnF,EAClBuP,CAAkB,CAACpK,MAAnBoK,CAA4BrD,CAAY,CAACO,YACnD8C,CAAkB,CAACpK,MAAnBoK,CAA4BvP,EAAUmL,CAAW,CAAChG,MAAtBnF,IAEzBuP,CAAkB,CAACnE,IAAnBmE,CAA0BxD,CAAW,CAACX,IAAtCmE,EAA8CA,CAAkB,CAACnE,IAAnBmE,CAA0BA,CAAkB,CAACtK,KAA7CsK,CAAqDxD,CAAW,CAACT,SAClHiE,CAAkB,CAACnE,IAAnBmE,CAA0BvP,EAAW+L,CAAW,CAACX,IAAvBpL,IAEvBuP,CAAkB,CAAClE,GAAnBkE,CAAyBxD,CAAW,CAACV,GAArCkE,EAA4CA,CAAkB,CAAClE,GAAnBkE,CAAyBA,CAAkB,CAACpK,MAA5CoK,CAAqDxD,CAAW,CAACR,UAChHgE,CAAkB,CAAClE,GAAnBkE,CAAyBvP,EAAW+L,CAAW,CAACV,GAAvBrL,GAGnBuP,EIzpBR,UAAA,EAAA,EAAA,EAAA,idCRC,WAAY,SAKHC,CAAAA,GAAc,QAIjBC,CAAAA,EAHDC,CAAO,CAAG,GAELvG,CAAC,CAAG,EAAGA,CAAC,CAAG3H,SAAS,CAACsH,OAAQK,CAAC,MAClCsG,EAAMjO,SAAS,CAAC2H,CAAD,EACdsG,MAEDE,CAAAA,CAAO,CAAG,MAAOF,CAAAA,KAEL,QAAZE,GAAAA,CAAO,EAA6B,QAAZA,GAAAA,EAC3BD,CAAO,CAAC7E,IAAR6E,CAAaD,CAAbC,MACM,IAAI5E,KAAK,CAAC8E,OAAN9E,CAAc2E,CAAd3E,GAAsB2E,CAAG,CAAC3G,MAA9B,CAAsC,IACxC+G,CAAAA,CAAK,CAAGL,CAAU,CAACpO,KAAXoO,CAAiB,IAAjBA,CAAuBC,CAAvBD,EACRK,CAFwC,EAG3CH,CAAO,CAAC7E,IAAR6E,CAAaG,CAAbH,CAHK,CAAA,IAKA,IAAgB,QAAZC,GAAAA,CAAJ,KACD,GAAIG,CAAAA,IAAOL,CAAAA,EACXM,CAAM,CAACC,IAAPD,CAAYN,CAAZM,CAAiBD,CAAjBC,GAAyBN,CAAG,CAACK,CAAD,GAC/BJ,CAAO,CAAC7E,IAAR6E,CAAaI,CAAbJ,QAMGA,CAAAA,CAAO,CAACzE,IAARyE,CAAa,GAAbA,KA3BJK,CAAAA,CAAM,CAAG,GAAGE,eA8BqBC,CAAM,CAACC,OAjChC,EAkCXX,CAAU,CAACY,OAAXZ,CAAqBA,CAlCV,CAmCXU,SAAAA,CAAiBV,CAnCN,EA0CX/M,MAAM,CAAC+M,UAAP/M,CAAoB+M,CA1CrB,CAAA,OCUD,CAAiB,SAAaa,CAAb,CAA4B,OAClC,UAAUC,CAAV,CAAyBC,CAAzB,CAA+B,IAC9B,CAACD,QACMD,CAAAA,KAGPG,CAAAA,EAEyB,QAAzB,QAAOF,CAAAA,CAPuB,CAQ9BE,CAAO,CAAGF,CARoB,CAU9BC,CAAI,CAAGD,CAVuB,IAa9BG,CAAAA,CAAI,CAAGJ,QACPG,CAAAA,IACAC,CAAI,EAAI,KAAOD,GAGZC,CAAI,EACPF,CAAI,CACEG,MAAM,CAACC,IAAPD,CAAYH,CAAZG,EAAkBE,MAAlBF,CAAyB,SAAUvP,CAAV,CAAkBa,CAAlB,CAAwB,IAC3C2I,CAAAA,CAAK,CAAG4F,CAAI,CAACvO,CAAD,QAEZ2I,CAAAA,IACAxJ,CAAM,EAAI,KACW,SAAjB,QAAOwJ,CAAAA,CAAP,CACO8F,CAAI,CAAG,IAAPA,CAAczO,CADrB,CAEOyO,CAAI,CAAG,IAAPA,CAAczO,CAAdyO,CAAqB,GAArBA,CAA2B9F,CAH5B,GAOPxJ,CAXT,CAAAuP,CAYC,EAZDA,CADF,CAcE,EAfC,CAlBf,CADJ,EJkDAlQ,CAAQ,CAACA,QAATA,CAAoBA,KKnEPqQ,CAAAA,CAAb,CACC,UAAA,CAAYC,CAAZ,CAA6D,IAApCpD,CAAAA,CAAoC,wDAA7B,EAA6B,CAAzBjI,CAAyB,wDAAjB,EAAiB,CAAbsL,CAAa,wDAAJ,EAAI,UAAA,MACvDD,YAAcA,CADyC,MAEvDpD,KAAOA,CAFgD,MAGvDjI,MAAQA,CAH+C,MAIvDsL,OAASA,CALhB,EASaC,CAAb,CACC,UAAA,CAAYF,CAAZ,CAAyBlF,CAAzB,CAAkD,IAAbmF,CAAAA,CAAa,wDAAJ,YAAI,MAC5CD,YAAcA,CAD8B,MAE5ClF,WAAaA,CAF+B,MAG5CmF,OAASA,CAJhB,EAQaE,EAAb,CACC,UAAA,CAAYH,CAAZ,CAAyBlF,CAAzB,CAAqC,UAAA,MAC/BkF,YAAcA,CADiB,MAE/BlF,WAAaA,CAHpB,EAOasF,EAAb,CAAA,sBACaJ,EAAaN,EAASW,EAAUC,EAAkBC,EAAQ,UAAA,MAChEP,YAAcA,CADkD,MAEhEK,SAAWA,CAFqD,MAGhEC,iBAAmBA,CAH6C,MAIhEZ,QAAUA,CAJsD,MAKhEa,OAASA,2CAEP,IACCb,CAAAA,CADD,CACgC,KAA/BA,OADD,CACUa,CADV,CACgC,KAAtBA,MADV,CACkBF,CADlB,CACgC,KAAdA,QADlB,GAEgBX,CAAO,CAACc,qBAARd,EAFhB,CAECpF,CAFD,GAECA,IAFD,CAEOC,CAFP,GAEOA,GAFP,OAIA,CACND,IAAI,CAAE+F,CAAQ,CAAC/F,IAAT+F,CAAgB/F,CAAhB+F,CAAuBE,CAAM,CAACjG,IAD9B,CAENC,GAAG,CAAE8F,CAAQ,CAAC9F,GAAT8F,CAAe9F,CAAf8F,CAAqBE,CAAM,CAAChG,GAF3B,QAZT,uCCtBe,CACdkG,WADc,WACA,CACb9O,MAAM,CAAC+O,gBAAP/O,CAAwB,SAAxBA,CAAmC,KAAKgP,SAAxChP,CAAmD,CAAEiP,OAAO,GAAT,CAAnDjP,CADa,CAEbA,MAAM,CAAC+O,gBAAP/O,CAAwB,WAAxBA,CAAqC,KAAKkP,WAA1ClP,CAAuD,CAAEiP,OAAO,GAAT,CAAvDjP,CAFa,CAGbA,MAAM,CAAC+O,gBAAP/O,CAAwB,WAAxBA,CAAqC,KAAKmP,WAA1CnP,CAAuD,CAAEiP,OAAO,GAAT,CAAvDjP,CAHa,CAIbA,MAAM,CAAC+O,gBAAP/O,CAAwB,UAAxBA,CAAoC,KAAKoP,UAAzCpP,CAAqD,CAAEiP,OAAO,GAAT,CAArDjP,CALa,CAAA,CAOdqP,aAPc,WAOE,CACfrP,MAAM,CAACsP,mBAAPtP,CAA2B,SAA3BA,CAAsC,KAAKgP,SAA3ChP,CADe,CAEfA,MAAM,CAACsP,mBAAPtP,CAA2B,WAA3BA,CAAwC,KAAKkP,WAA7ClP,CAFe,CAGfA,MAAM,CAACsP,mBAAPtP,CAA2B,WAA3BA,CAAwC,KAAKmP,WAA7CnP,CAHe,CAIfA,MAAM,CAACsP,mBAAPtP,CAA2B,UAA3BA,CAAuC,KAAKoP,UAA5CpP,CAXa,CAAA,CAaduP,OAbc,WAaH,IACN,CAAC,KAAKC,KAAL,CAAWC,eACT,IAAIC,CAAAA,KAAJ,CACL,8EADK,OAIFC,QAAU,EANL,MAOLC,eAAiB,EAPZ,MAQLC,UArBQ,CAAA,CAuBdC,OAAO,CAAE,CACRC,WADQ,WACO,CACT,KAAKF,OADI,QAERA,UAFQ,MAGRG,MAAM,QAHE,CADP,CAAA,CAORC,YAPQ,WAOQ,CACX,KAAKJ,OADM,QAETA,UAFS,MAGTG,MAAM,QAHG,CAPR,CAAA,CAaRE,YAbQ,UAaMrL,EAAG,CACZA,CAAC,CAACsL,UAAFtL,EAAgB,CAAC,KAAKuL,QAAtBvL,EAAuD,CAArBA,GAAAA,CAAC,CAAC8K,OAAF9K,CAAUwB,MADhC,QAEVsJ,UAAc9K,CAAC,CAAC8K,QAFN,CAIX,CAAC,KAAKE,OAJK,OAKTG,MAAM,QALG,CAQXnL,CAAC,CAAC8K,OAAF9K,CAAUwB,MARC,OASTgK,WACJ,KAAKV,OAAL,CAAaxB,MAAb,CACC,SAACmC,CAAD,CAAOC,CAAP,CAAiB,OACT,CACNC,OAAO,CAAEF,CAAI,CAACE,OAALF,CAAeC,CAAK,CAACC,OAAND,CAAgB1L,CAAC,CAAC8K,OAAF9K,CAAUwB,MAD5C,CAENoK,OAAO,CAAEH,CAAI,CAACG,OAALH,CAAeC,CAAK,CAACE,OAANF,CAAgB1L,CAAC,CAAC8K,OAAF9K,CAAUwB,MAF5C,CAFT,CAAA,CAOC,CAAEmK,OAAO,CAAE,CAAX,CAAcC,OAAO,CAAE,CAAvB,CAPD,EAVa,CAqBX5L,CAAC,CAAC6L,cArBS,EAsBd7L,CAAC,CAAC6L,cAAF7L,EAtBc,CAwBfA,CAAC,CAAC8L,eAAF9L,EAxBe,CAbT,CAAA,CAwCRuK,UAxCQ,WAwCM,MACRwB,YAzCE,CAAA,CA2CRzB,WA3CQ,UA2CKtK,EAAG,CACX,KAAK8K,OAAL,CAAatJ,MADF,QAETwK,YAAYhM,EAAGA,CAAC,CAAC8K,QAFR,CAGV9K,CAAC,CAAC6L,cAHQ,EAIb7L,CAAC,CAAC6L,cAAF7L,EAJa,CAMVA,CAAC,CAAC8L,eANQ,EAOb9L,CAAC,CAAC8L,eAAF9L,EAPa,CA3CR,CAAA,CAsDRiM,WAtDQ,UAsDKjM,EAAG,IACX,CAAC,KAAKuL,SAAU,IACbG,CAAAA,CAAK,CAAG,CACbQ,IAAI,GADS,CAEbP,OAAO,CAAE3L,CAAC,CAAC2L,OAFE,CAGbC,OAAO,CAAE5L,CAAC,CAAC4L,OAHE,OAKTd,QAAU,CAACY,CAAD,CANI,MAOdF,WAAWE,EAPG,CAQnB1L,CAAC,CAAC8L,eAAF9L,GA/DM,CAAA,CAkERqK,WAlEQ,UAkEKrK,EAAG,CACX,KAAK8K,OAAL,CAAatJ,MADF,QAETwK,YAAYhM,EAAG,CACnB,CACCkM,IAAI,GADL,CAECP,OAAO,CAAE3L,CAAC,CAAC2L,OAFZ,CAGCC,OAAO,CAAE5L,CAAC,CAAC4L,OAHZ,CADmB,EAFN,CASV5L,CAAC,CAAC6L,cATQ,EAUb7L,CAAC,CAAC6L,cAAF7L,EAVa,CAlER,CAAA,CAgFRmK,SAhFQ,WAgFK,MACPW,QAAU,EAjFR,CAAA,CAmFRU,UAnFQ,UAmFIE,EAAO,IACZd,CAAAA,CAAS,CAAG,KAAKD,KAAL,CAAWC,SADX,GAEoBA,CAAS,CAACZ,qBAAVY,EAFpB,CAEV9G,CAFU,GAEVA,IAFU,CAEJE,CAFI,GAEJA,KAFI,CAEGC,CAFH,GAEGA,MAFH,CAEWF,CAFX,GAEWA,GAFX,MAIbgG,OAAS,CACbjG,IAAI,CAAE4H,CAAK,CAACC,OAAND,CAAgB5H,CADT,CAEbC,GAAG,CAAE2H,CAAK,CAACE,OAANF,CAAgB3H,CAFR,CAGbE,MAAM,CAAEA,CAAM,CAAGyH,CAAK,CAACE,OAHV,CAIb5H,KAAK,CAAEA,CAAK,CAAG0H,CAAK,CAACC,OAJR,CAvFP,CAAA,CA8FRK,WA9FQ,UA8FKG,EAAOrB,EAAS,IACtBsB,CAAAA,CAAU,GAAOtB,MACnB,KAAKA,OAAL,CAAatJ,OAAQ,IACI,CAAxB,QAAKsJ,OAAL,CAAatJ,MAAb,EAAmD,CAAtB4K,GAAAA,CAAU,CAAC5K,OAAc,IACnD0H,CAAAA,CAAO,CAAG,KAAKyB,KAAL,CAAWC,eACtBO,MAAM,OAAQ,GAAIvB,CAAAA,EAAJ,CAClBuC,CADkB,CAElBjD,CAFkB,CAGlB,CACCpF,IAAI,CAAEsI,CAAU,CAAC,CAAD,CAAVA,CAAcT,OADrB,CAEC5H,GAAG,CAAEqI,CAAU,CAAC,CAAD,CAAVA,CAAcR,OAFpB,CAHkB,CAOlB,CACC9H,IAAI,CAAE,KAAKgH,OAAL,CAAa,CAAb,EAAgBa,OADvB,CAEC5H,GAAG,CAAE,KAAK+G,OAAL,CAAa,CAAb,EAAgBc,OAFtB,CAPkB,CAWlB,KAAK7B,MAXa,QAcfe,QAAUsB,EAjHT,CAAA,CAoHRL,UApHQ,WAoHM,MACRjB,QAAU,EADF,CAET,KAAKE,OAFI,QAGPG,MAAM,QAHC,MAIPH,UAJO,EApHN,CAvBK,0rTCFFrF,EAAqB,CAAG,CAAC,MAAD,CAAS,OAAT,EACxBC,EAAmB,CAAG,CAAC,KAAD,CAAQ,QAAR,EACtBN,EAAc,CAAG,CAAC,MAAD,CAAS,OAAT,CAAkB,KAAlB,CAAyB,QAAzB,EAIjB+G,EAAkB,CAAG,CAAC,MAAD,CAAS,SAAT,CAAoB,MAApB,EAIrBC,EAAoB,CAAG,GAEvBC,EAAmB,CAAG,CAClCzI,IAAI,CAAE,CAD4B,CAElCC,GAAG,CAAE,CAF6B,CAGlCpG,KAAK,CAAE,CAH2B,CAIlCE,MAAM,CAAE,CAJ0B,g0TTimB5B,UAAA,CAAwF,IAAjE2O,CAAAA,CAAiE,GAAjEA,eAAiE,CAAhD3F,CAAgD,GAAhDA,SAAgD,CAArCF,CAAqC,GAArCA,eAAqC,CAApB8F,CAAoB,GAApBA,gBAAoB,CAC1FC,CAAM,CAAG,EADiF,IAGrE,MAArBD,GAAAA,IACHC,CAAM,CAAG,CACR5I,IAAI,CAAE,CADE,CAERC,GAAG,CAAE,CAFG,CAGRC,KAAK,CAAE6C,CAAS,CAAClJ,KAHT,CAIRsG,MAAM,CAAE4C,CAAS,CAAChJ,MAJV,GAQN,CAAC2O,EAAiB,IACfG,CAAAA,CAAU,CAAG,CAClB7I,IAAI,CAAE,CAAC6C,CAAe,CAACG,KAAhBH,CAAsB7C,IAAvB,CAA8B6C,CAAe,CAACxI,KADlC,CAElB4F,GAAG,CAAE,CAAC4C,CAAe,CAACG,KAAhBH,CAAsB5C,GAAvB,CAA6B4C,CAAe,CAACxI,KAFhC,CAGlB6F,KAAK,CAAE,CAAC6C,CAAS,CAAClJ,KAAVkJ,CAAkBF,CAAe,CAACG,KAAhBH,CAAsB7C,IAAzC,EAAiD6C,CAAe,CAACxI,KAHtD,CAIlB8F,MAAM,CAAE,CAAC4C,CAAS,CAAChJ,MAAVgJ,CAAmBF,CAAe,CAACG,KAAhBH,CAAsB5C,GAA1C,EAAiD4C,CAAe,CAACxI,KAJvD,EAMnBmH,EAAc,CAACC,OAAfD,CAAuB,SAAAE,CAAA,CAAa,CAQlCkH,CAAM,CAAClH,CAAD,CAR4B,CAC9B1J,CAAW,CAAC4Q,CAAM,CAAClH,CAAD,CAAP,CADmB,CAQdmH,CAAU,CAACnH,CAAD,CARI,CAEhB,MAAdA,GAAAA,CAAS,EAA6B,KAAdA,GAAAA,CAFM,CAGb9M,EAASgU,CAAM,CAAClH,CAAD,CAAf9M,CAA4BiU,CAAU,CAACnH,CAAD,CAAtC9M,CAHa,CAKbA,EAASgU,CAAM,CAAClH,CAAD,CAAf9M,CAA4BiU,CAAU,CAACnH,CAAD,CAAtC9M,CALvB,CAAA4M,QAYMoH,CAAAA,2CA7cD,UAAA,CAAuF,IAApE7I,CAAAA,CAAoE,GAApEA,WAAoE,CAAvDe,CAAuD,GAAvDA,YAAuD,CAAzCH,CAAyC,GAAzCA,WAAyC,CAA5BuB,CAA4B,GAA5BA,WAA4B,CAAf4G,CAAe,GAAfA,WAAe,CACvFvI,CAAiB,MACnBR,GACHG,KAAK,CAAEH,CAAW,CAACC,IAAZD,CAAmBA,CAAW,CAAClG,MACtCsG,MAAM,CAAEJ,CAAW,CAACE,GAAZF,CAAkBA,CAAW,CAAChG,QAJsD,CAOvF4L,CAAM,CAAGmD,CAAW,CAACnD,MAAZmD,EAAsB,EAPwD,CASzFtI,CAAU,MACVsI,CAAW,CAACtI,WAV6E,CAavFuI,CAAmB,MACrBjI,GACHM,QAAQ,CAAExM,EAASkM,CAAY,CAACM,QAAtBxM,CAAgCkM,CAAY,CAACsB,OAA7CxN,EACVyM,SAAS,CAAEzM,EAASkM,CAAY,CAACO,SAAtBzM,CAAiCkM,CAAY,CAACsB,OAA9CxN,GAhBiF,CAmBvFoU,CAAiB,CAAGrD,CAAM,CAACqD,iBAAPrD,EAA4B,CACrD3F,IAAI,GADiD,CAErDE,KAAK,GAFgD,CAGrDC,MAAM,GAH+C,CAIrDF,GAAG,GAJkD,CAnBuC,CA0B7FuB,EAAc,CAACC,OAAfD,CAAuB,SAAAE,CAAA,CAAa,CAC9BsH,CAAiB,CAACtH,CAAD,CADa,GAElClB,CAAU,CAACkB,CAAD,CAAVlB,CAAwB,CAFU,CAApC,CAAAgB,CA1B6F,CAiC7FhB,CAAU,CAAGI,CAAa,CAAC,CAAEJ,UAAU,CAAVA,CAAF,CAAcM,YAAY,CAAEiI,CAA5B,CAAiDhJ,WAAW,CAAEQ,CAA9D,CAAiFI,WAAW,CAAXA,CAAjF,CAA8FK,WAAW,CAAE2E,CAAM,CAAC3E,WAAlH,CAAD,CAjCmE,IAoCzFE,CAAAA,CAAY,CAAGZ,CAAe,CAACC,CAAD,CAAoBC,CAApB,CApC2D,CAqCzFW,CAAa,CAAGV,CAAgB,CAACF,CAAD,CAAoBC,CAApB,CArCyD,CAwCzF2B,CAAW,CAAGF,CAAc,CAACf,CAAD,CAAeC,CAAf,CAA8Be,CAA9B,CAA2C3B,CAA3C,CAA8DoF,CAAM,CAAC5E,mBAArE,CAxC6D,IA0CzFoB,EAAa,IACV8G,CAAAA,CADU,CACYtD,CADZ,CACVsD,oBACDA,IACA1I,CAAiB,CAAC1G,KAAlB0G,EAA2BA,CAAiB,CAACxG,MAA7CwG,EAAsE,CAAf4B,EAAAA,EAC1D8G,CAAgB,CAAG,QAEnBA,CAAgB,CAAG,UAGI,OAArBA,GAAAA,EAA8B,IAC7BC,CAAAA,CAAa,CAAGhI,CAAY,CAAGiB,CAAfjB,CAA6BX,CAAiB,CAACxG,OAC9DiP,CAAiB,CAAC/I,GAAlB+I,EAAyBA,CAAiB,CAAC7I,MAFf,EAGhCK,CAAU,CAACL,MAAXK,CAAoB0I,CAAa,CAAG,CAHJ,CAIhC1I,CAAU,CAACP,GAAXO,CAAiB0I,CAAa,CAAG,CAJD,EAKtBF,CAAiB,CAAC7I,MALI,CAMhCK,CAAU,CAACL,MAAXK,CAAoB0I,CANY,CAOtBF,CAAiB,CAAC/I,GAPI,CAQhCO,CAAU,CAACP,GAAXO,CAAiB0I,CARe,CASrBF,CAAiB,CAAC9I,KATG,CAUhCM,CAAU,CAACN,KAAXM,CAAmB,CAVa,CAWtBwI,CAAiB,CAAChJ,IAXI,GAYhCQ,CAAU,CAACR,IAAXQ,CAAkB,CAZc,CAAlC,KAcO,IAAyB,QAArByI,GAAAA,CAAJ,CAAmC,IACrCE,CAAAA,CAAY,CAAG5I,CAAiB,CAAC1G,KAAlB0G,CAA0BY,CAAa,CAAGgB,EACzD6G,CAAiB,CAAChJ,IAAlBgJ,EAA0BA,CAAiB,CAAC9I,KAFP,EAGxCM,CAAU,CAACR,IAAXQ,CAAkB,CAAC2I,CAAD,CAAgB,CAHM,CAIxC3I,CAAU,CAACN,KAAXM,CAAmB,CAAC2I,CAAD,CAAgB,CAJK,EAK9BH,CAAiB,CAAChJ,IALY,CAMxCQ,CAAU,CAACR,IAAXQ,CAAkB,CAAC2I,CANqB,CAO9BH,CAAiB,CAAC9I,KAPY,CAQxCM,CAAU,CAACN,KAAXM,CAAmB,CAAC2I,CARoB,CAS9BH,CAAiB,CAAC/I,GATY,CAUxCO,CAAU,CAACP,GAAXO,CAAiB,CAVuB,CAW9BwI,CAAiB,CAAC7I,MAXY,GAYxCK,CAAU,CAACL,MAAXK,CAAoB,CAZoB,CAvB1B,CAuChBA,CAAU,CAAGI,CAAa,CAAC,CAAEJ,UAAU,CAAVA,CAAF,CAAcM,YAAY,CAAEiI,CAA5B,CAAiDhJ,WAAW,CAAEQ,CAA9D,CAAiFI,WAAW,CAAXA,CAAjF,CAA8FI,mBAAmB,GAAjH,CAAyHE,IAAI,CAAE0E,CAAM,CAACyD,UAAPzD,EAAqB,CAACA,CAAM,CAAC3E,WAA7B2E,CAA2C,MAA3CA,CAAoD,MAAnL,CAAD,CAjFkE,OAqF7FzE,CAAAA,CAAY,CAAGZ,CAAe,CAACC,CAAD,CAAoBC,CAApB,EAC9BW,CAAa,CAAGV,CAAgB,CAACF,CAAD,CAAoBC,CAApB,EAChC2B,CAAW,CAAGF,CAAc,CAACf,CAAD,CAAeC,CAAf,CAA8Be,CAA9B,CAA2C3B,CAA3C,CAA8DoF,CAAM,CAAC5E,mBAArE,EAC6B,IAArDnM,GAASuN,CAAW,CAAGjB,CAAY,CAACC,CAApCvM,IACH8G,OAAO,CAACD,KAARC,sDAA4DwF,CAAY,CAACC,yBAA4BgB,EAArGzG,EACA8F,EAAc,CAACC,OAAfD,CAAuB,SAAAE,CAAA,CAAa,CAC9BsH,CAAiB,CAACtH,CAAD,CADa,GAElClB,CAAU,CAACkB,CAAD,CAAVlB,CAAwB,CAFU,CAApC,CAAAgB,GAOMc,CAAI,CAAC,CACXvC,WAAW,CAAE,CACZlG,KAAK,CAAEkG,CAAW,CAAClG,KAAZkG,CAAoBS,CAAU,CAACN,KAA/BH,CAAuCS,CAAU,CAACR,IAD7C,CAEZjG,MAAM,CAAEgG,CAAW,CAAChG,MAAZgG,CAAqBS,CAAU,CAACP,GAAhCF,CAAsCS,CAAU,CAACL,MAF7C,CAGZH,IAAI,CAAED,CAAW,CAACC,IAHN,CAIZC,GAAG,CAAEF,CAAW,CAACE,GAJL,CADF,CAOXU,WAAW,CAAXA,CAPW,CAQX4B,SAAS,CAAE,GAAIsD,CAAAA,EAAJ,CAAc,EAAd,CAAkB,CAC5B7F,IAAI,CAAE,CAACQ,CAAU,CAACR,IADU,CAE5BC,GAAG,CAAE,CAACO,CAAU,CAACP,GAFW,CAAlB,CARA,CAAD,+EAwEL,UAAA,CAAiI,IACnIoJ,CAAAA,CADmI,CACxHC,CADwH,CAAzGC,CAAyG,GAAzGA,OAAyG,CAAhG9P,CAAgG,GAAhGA,KAAgG,CAAzF2H,CAAyF,GAAzFA,QAAyF,CAA/EC,CAA+E,GAA/EA,SAA+E,CAApEU,CAAoE,GAApEA,QAAoE,CAA1DC,CAA0D,GAA1DA,SAA0D,CAA/CwH,CAA+C,GAA/CA,UAA+C,CAAnCC,CAAmC,GAAnCA,WAAmC,CAAtBvH,CAAsB,GAAtBA,WAAsB,CAATwH,CAAS,GAATA,KAAS,CAEnIC,CAAS,CAAGH,CAFuH,CAGnII,CAAU,CAAGH,CAHsH,CAKjII,CAAK,CAAGL,CAAU,CAAGC,CAAbD,CAA2BtH,CAAW,CAACG,OAAvCmH,CAAiDtH,CAAW,CAACE,OAL4D,QAOnIoH,CAAU,CAAGC,CAAbD,CAA2BtH,CAAW,CAACG,OAAvCmH,EAAkDA,CAAU,CAAGC,CAAbD,CAA2BtH,CAAW,CAACE,WAC/E,CAATyH,EAAAA,GACHD,CAAU,CAAGH,EACbE,CAAS,CAAGC,CAAU,CAAG1H,CAAW,CAACG,UAErCsH,CAAS,CAAGH,EACZI,CAAU,CAAGD,CAAS,CAAGzH,CAAW,CAACE,UAIvCiH,CAAS,CAAGzU,EAASoN,CAATpN,CAAoBA,EAASyM,CAATzM,CAAiC,EAAbgV,CAAAA,CAApBhV,CAApBA,EACZ0U,CAAQ,CAAG1U,EAASmN,CAATnN,CAAmBA,EAASwM,CAATxM,CAA+B,EAAZ+U,CAAAA,CAAnB/U,CAAnBA,EAEJ,CACNmF,MAAM,CAAEsP,CADF,CAENxP,KAAK,CAAEyP,CAFD,2CA5BD,UAAA,CAA4G,IAAhFC,CAAAA,CAAgF,GAAhFA,QAAS9P,CAAuE,GAAvEA,MAAOqQ,CAAgE,GAAhEA,aAAcC,CAAkD,GAAlDA,cAAeP,CAAmC,GAAnCA,WAAYC,CAAuB,GAAvBA,YAAcC,CAAS,GAATA,YAClG,CACN1J,IAAI,CAAEwJ,CAAU,CAAG,CAAbA,CAAiBM,CAAY,CAAG,CADhC,CAEN7J,GAAG,CAAEwJ,CAAW,CAAG,CAAdA,CAAkBM,CAAa,CAAG,CAFjC,oCApBD,UAAA,CAAgE,IAA3CR,CAAAA,CAA2C,GAA3CA,OAA2C,CAAlC9P,CAAkC,GAAlCA,KAAkC,CAA3B+P,CAA2B,GAA3BA,UAA2B,CAAfC,CAAe,GAAfA,WAAe,CAChEG,CAAU,CAAGL,CAAO,CAACS,YAD2C,CAEhEL,CAAS,CAAGJ,CAAO,CAACU,WAF4C,CAIlE9I,CAAa,CAAGyI,CAJkD,CAKlE1I,CAAY,CAAGsI,CAAU,CAAGI,CAAbJ,CAA0BC,CALyB,OAOlEvI,CAAAA,CAAY,CAAGyI,IAClBzI,CAAY,CAAGyI,EACfxI,CAAa,CAAGsI,CAAW,CAAGE,CAAdF,CAA0BD,GAGpC,CACN3P,KAAK,CAAEqH,CADD,CAENnH,MAAM,CAAEoH,CAFF,wCAyCD,UAAA,CAAoG,IAArEC,CAAAA,CAAqE,GAArEA,SAAUC,CAA2D,GAA3DA,UAAWU,CAAgD,GAAhDA,SAAUC,CAAsC,GAAtCA,UAAWwH,CAA2B,GAA3BA,WAAYC,CAAe,GAAfA,kBACpF,CACNrI,QAAQ,CAAEA,CAAQ,CAAG,GAAXA,CAAiBoI,CADrB,CAENnI,SAAS,CAAEA,CAAS,CAAG,GAAZA,CAAkBoI,CAFvB,CAGN1H,QAAQ,CAAEA,CAAQ,CAAG,GAAXA,CAAiByH,CAHrB,CAINxH,SAAS,CAAEA,CAAS,CAAG,GAAZA,CAAkByH,CAJvB,q3KE9TSrU,w8YQnBd,CAAC8U,UAAU,UAAWC,IACzBC,CAAG,CAACF,SAAJE,CAAc,mBAAdA,CAAmCC,EAAnCD,EACAA,CAAG,CAACF,SAAJE,CAAc,gBAAdA,CAAgCE,EAAhCF,EACAA,CAAG,CAACF,SAAJE,CAAc,gBAAdA,CAAgCG,EAAhCH,EACAA,CAAG,CAACF,SAAJE,CAAc,aAAdA,CAA6BI,EAA7BJ"}