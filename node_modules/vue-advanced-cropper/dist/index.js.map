{"version":3,"file":"index.js","sources":["../node_modules/classnames/index.js","../node_modules/easy-bem/index.js","../node_modules/debounce/index.js","../src/core/utils.js","../src/core/events.js","../src/mixins/draggable.js","../src/core/constants.js","../src/core/image.js","../src/core/algorithms.js","../src/Cropper.vue","../src/index.js"],"sourcesContent":["/*!\n  Copyright (c) 2017 Jed Watson.\n  Licensed under the MIT License (MIT), see\n  http://jedwatson.github.io/classnames\n*/\n/* global define */\n\n(function () {\n\t'use strict';\n\n\tvar hasOwn = {}.hasOwnProperty;\n\n\tfunction classNames () {\n\t\tvar classes = [];\n\n\t\tfor (var i = 0; i < arguments.length; i++) {\n\t\t\tvar arg = arguments[i];\n\t\t\tif (!arg) continue;\n\n\t\t\tvar argType = typeof arg;\n\n\t\t\tif (argType === 'string' || argType === 'number') {\n\t\t\t\tclasses.push(arg);\n\t\t\t} else if (Array.isArray(arg) && arg.length) {\n\t\t\t\tvar inner = classNames.apply(null, arg);\n\t\t\t\tif (inner) {\n\t\t\t\t\tclasses.push(inner);\n\t\t\t\t}\n\t\t\t} else if (argType === 'object') {\n\t\t\t\tfor (var key in arg) {\n\t\t\t\t\tif (hasOwn.call(arg, key) && arg[key]) {\n\t\t\t\t\t\tclasses.push(key);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn classes.join(' ');\n\t}\n\n\tif (typeof module !== 'undefined' && module.exports) {\n\t\tclassNames.default = classNames;\n\t\tmodule.exports = classNames;\n\t} else if (typeof define === 'function' && typeof define.amd === 'object' && define.amd) {\n\t\t// register as 'classnames', consistent with npm package name\n\t\tdefine('classnames', [], function () {\n\t\t\treturn classNames;\n\t\t});\n\t} else {\n\t\twindow.classNames = classNames;\n\t}\n}());\n","'use strict';\r\n\r\n/**\r\n * BEM class name factory.\r\n *\r\n * @typedef {Function} Bem\r\n * @param {String|Object} [elementOrMods] Element name or hash object with mods\r\n * @param {Object} [mods] Hash object with mods\r\n * @returns {String}\r\n */\r\n\r\n/**\r\n * Returns BEM class name factory.\r\n *\r\n * @param {String} componentName Block name\r\n * @returns {Bem}\r\n */\r\nmodule.exports = function bem(componentName) {\r\n    return function (elementOrMods, mods) {\r\n        if (!elementOrMods) {\r\n            return componentName;\r\n        }\r\n\r\n        var element;\r\n\r\n        if (typeof elementOrMods === 'string') {\r\n            element = elementOrMods;\r\n        } else {\r\n            mods = elementOrMods;\r\n        }\r\n\r\n        var base = componentName;\r\n        if (element) {\r\n            base += '__' + element;\r\n        }\r\n\r\n        return base + (\r\n            mods\r\n                ? Object.keys(mods).reduce(function (result, name) {\r\n                    var value = mods[name];\r\n\r\n                    if (value) {\r\n                        result += ' ' + (\r\n                            typeof value === 'boolean'\r\n                                ? (base + '--' + name)\r\n                                : (base + '--' + name + '_' + value)\r\n                        );\r\n                    }\r\n\r\n                    return result;\r\n                }, '')\r\n                : ''\r\n        );\r\n    };\r\n}\r\n","/**\n * Returns a function, that, as long as it continues to be invoked, will not\n * be triggered. The function will be called after it stops being called for\n * N milliseconds. If `immediate` is passed, trigger the function on the\n * leading edge, instead of the trailing. The function also has a property 'clear' \n * that is a function which will clear the timer to prevent previously scheduled executions. \n *\n * @source underscore.js\n * @see http://unscriptable.com/2009/03/20/debouncing-javascript-methods/\n * @param {Function} function to wrap\n * @param {Number} timeout in ms (`100`)\n * @param {Boolean} whether to execute at the beginning (`false`)\n * @api public\n */\nfunction debounce(func, wait, immediate){\n  var timeout, args, context, timestamp, result;\n  if (null == wait) wait = 100;\n\n  function later() {\n    var last = Date.now() - timestamp;\n\n    if (last < wait && last >= 0) {\n      timeout = setTimeout(later, wait - last);\n    } else {\n      timeout = null;\n      if (!immediate) {\n        result = func.apply(context, args);\n        context = args = null;\n      }\n    }\n  };\n\n  var debounced = function(){\n    context = this;\n    args = arguments;\n    timestamp = Date.now();\n    var callNow = immediate && !timeout;\n    if (!timeout) timeout = setTimeout(later, wait);\n    if (callNow) {\n      result = func.apply(context, args);\n      context = args = null;\n    }\n\n    return result;\n  };\n\n  debounced.clear = function() {\n    if (timeout) {\n      clearTimeout(timeout);\n      timeout = null;\n    }\n  };\n  \n  debounced.flush = function() {\n    if (timeout) {\n      result = func.apply(context, args);\n      context = args = null;\n      \n      clearTimeout(timeout);\n      timeout = null;\n    }\n  };\n\n  return debounced;\n};\n\n// Adds compatibility for ES modules\ndebounce.debounce = debounce;\n\nmodule.exports = debounce;\n","export function directionNames (hDirection, vDirection) {\n\tlet name, classname;\n\tif (hDirection && vDirection) {\n\t\tname = `${hDirection}${vDirection[0].toUpperCase()}${vDirection.slice(1)}`;\n\t\tclassname = `${hDirection}-${vDirection}`;\n\t} else {\n\t\tname = hDirection || vDirection;\n\t\tclassname = hDirection || vDirection;\n\t}\n\treturn { name, classname, };\n}\n\nexport function isLocal(url) {\n\treturn /^data:/.test(url) || /^blob:/.test(url);\n}\n\nexport function isCrossOriginURL(url) {\n\tif (isLocal(url)) {\n\t\treturn false;\n\t}\n\tconst pageLocation = window.location;\n\tconst URL_HOST_PATTERN = /(\\w+:)?(?:\\/\\/)([\\w.-]+)?(?::(\\d+))?\\/?/;\n\tconst urlMatch = URL_HOST_PATTERN.exec(url) || [];\n\tconst urlparts = {\n\t\tprotocol:   urlMatch[1] || '',\n\t\thost:       urlMatch[2] || '',\n\t\tport:       urlMatch[3] || '',\n\t};\n\n\tconst defaultPort = (protocol) => {\n\t\treturn { 'http:':80, 'https:':443, }[protocol];\n\t};\n\n\tconst portOf = (location) => {\n\t\treturn location.port || defaultPort(location.protocol || pageLocation.protocol);\n\t};\n\n\treturn !((!urlparts.protocol && !urlparts.host && !urlparts.port) ||\n\t\tBoolean((urlparts.protocol  && (urlparts.protocol  == pageLocation.protocol)) &&\n\t\t\t\t\t\t\t\t\t(urlparts.host      && (urlparts.host       == pageLocation.host))     &&\n\t\t\t\t\t\t\t\t\t(urlparts.host      && (portOf(urlparts)    == portOf(pageLocation)))\n\t\t));\n}\n\nexport function isUndefined(obj) {\n\treturn typeof obj === 'undefined';\n}\n\nexport function isObject(obj) {\n\treturn typeof obj === 'object' && obj !== null;\n}\n\nexport function addTimestamp(url) {\n\tconst timestamp = `timestamp=${(new Date()).getTime()}`;\n\treturn url + (url.indexOf('?') === -1 ? '?' : '&') + timestamp;\n}\n\nexport function distance(firstPoint, secondPoint) {\n\treturn Math.sqrt(\n\t\tMath.pow(firstPoint.x - secondPoint.x, 2) + Math.pow(firstPoint.y - secondPoint.y, 2)\n\t);\n}\n\nexport function getSettings(param, defaultParams = {}) {\n\tlet result = {\n\t\tenabled: Boolean(param),\n\t\t...defaultParams\n\t};\n\tif (isObject(param)) {\n\t\tresult = { ...result, ...param };\n\t}\n\treturn result;\n}\n\nexport function parseNumber(number) {\n\tconst parsedNumber = Number(number);\n\tif (Number.isNaN(parsedNumber)) {\n\t\treturn number;\n\t} else {\n\t\treturn parsedNumber;\n\t}\n}\n","export class ManipulateImageEvent {\r\n\tconstructor(nativeEvent, move = {}, scale = {}, params = {}) {\r\n\t\tthis.nativeEvent = nativeEvent;\r\n\t\tthis.move = move;\r\n\t\tthis.scale = scale;\r\n\t\tthis.params = params;\r\n\t}\r\n}\r\n\r\nexport class ResizeEvent {\r\n\tconstructor(nativeEvent, directions, params = {}) {\r\n\t\tthis.nativeEvent = nativeEvent;\r\n\t\tthis.directions = directions;\r\n\t\tthis.params = params;\r\n\t}\r\n}\r\n\r\nexport class MoveEvent {\r\n\tconstructor(nativeEvent, directions) {\r\n\t\tthis.nativeEvent = nativeEvent;\r\n\t\tthis.directions = directions;\r\n\t}\r\n}\r\n\r\nexport class DragEvent {\r\n\tconstructor(nativeEvent, element, position, previousPosition, anchor) {\r\n\t\tthis.nativeEvent = nativeEvent;\r\n\t\tthis.position = position;\r\n\t\tthis.previousPosition = previousPosition;\r\n\t\tthis.element = element;\r\n\t\tthis.anchor = anchor;\r\n\t}\r\n\tshift() {\r\n\t\tconst { element, anchor, position, } = this;\r\n\t\tconst { left, top, } = element.getBoundingClientRect();\r\n\r\n\t\treturn {\r\n\t\t\tleft: position.left - left - anchor.left,\r\n\t\t\ttop: position.top - top - anchor.top,\r\n\t\t};\r\n\t}\r\n}\r\n","import { DragEvent } from '../core/events';\r\n\r\nexport default {\r\n\tbeforeMount() {\r\n\t\twindow.addEventListener('mouseup', this.onMouseUp, { passive: false, });\r\n\t\twindow.addEventListener('mousemove', this.onMouseMove, { passive: false, });\r\n\t\twindow.addEventListener('touchmove', this.onTouchMove, { passive: false, });\r\n\t\twindow.addEventListener('touchend', this.onTouchEnd, { passive: false, });\r\n\t},\r\n\tbeforeDestroy() {\r\n\t\twindow.removeEventListener('mouseup', this.onMouseUp);\r\n\t\twindow.removeEventListener('mousemove', this.onMouseMove);\r\n\t\twindow.removeEventListener('touchmove', this.onTouchMove);\r\n\t\twindow.removeEventListener('touchend', this.onTouchEnd);\r\n\t},\r\n\tmounted () {\r\n\t\tif (!this.$refs.draggable) {\r\n\t\t\tthrow new Error(\r\n\t\t\t\t'You should add ref \"draggable\" to your root element to use draggable mixin'\r\n\t\t\t);\r\n\t\t}\r\n\t\tthis.touches = [];\r\n\t\tthis.draggingAnchor = [];\r\n\t\tthis.hovered = false;\r\n\t},\r\n\tmethods: {\r\n\t\tonMouseOver () {\r\n\t\t\tif (!this.hovered) {\r\n\t\t\t\tthis.hovered = true;\r\n\t\t\t\tthis.$emit('enter');\r\n\t\t\t}\r\n\t\t},\r\n\t\tonMouseLeave () {\r\n\t\t\tif (this.hovered) {\r\n\t\t\t\tthis.hovered = false;\r\n\t\t\t\tthis.$emit('leave');\r\n\t\t\t}\r\n\t\t},\r\n\t\tonTouchStart (e) {\r\n\t\t\tif (e.cancelable && !this.disabled && e.touches.length === 1) {\r\n\t\t\t\tthis.touches = [...e.touches];\r\n\r\n\t\t\t\tif (!this.hovered) {\r\n\t\t\t\t\tthis.$emit('enter');\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (e.touches.length) {\r\n\t\t\t\t\tthis.initAnchor(\r\n\t\t\t\t\t\tthis.touches.reduce(\r\n\t\t\t\t\t\t\t(mean, touch) => {\r\n\t\t\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\t\t\tclientX: mean.clientX + touch.clientX / e.touches.length,\r\n\t\t\t\t\t\t\t\t\tclientY: mean.clientY + touch.clientY / e.touches.length,\r\n\t\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t{ clientX: 0, clientY: 0, }\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t\tif (e.preventDefault) {\r\n\t\t\t\t\te.preventDefault();\r\n\t\t\t\t}\r\n\t\t\t\te.stopPropagation();\r\n\t\t\t}\r\n\t\t},\r\n\t\tonTouchEnd () {\r\n\t\t\tthis.processEnd();\r\n\t\t},\r\n\t\tonTouchMove (e) {\r\n\t\t\tif (this.touches.length) {\r\n\t\t\t\tthis.processMove(e, e.touches);\r\n\t\t\t\tif (e.preventDefault) {\r\n\t\t\t\t\te.preventDefault();\r\n\t\t\t\t}\r\n\t\t\t\tif (e.stopPropagation) {\r\n\t\t\t\t\te.stopPropagation();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tonMouseDown (e) {\r\n\t\t\tif (!this.disabled) {\r\n\t\t\t\tconst touch = {\r\n\t\t\t\t\tfake: true,\r\n\t\t\t\t\tclientX: e.clientX,\r\n\t\t\t\t\tclientY: e.clientY,\r\n\t\t\t\t};\r\n\t\t\t\tthis.touches = [touch];\r\n\t\t\t\tthis.initAnchor(touch);\r\n\t\t\t\te.stopPropagation();\r\n\t\t\t}\r\n\t\t},\r\n\t\tonMouseMove (e) {\r\n\t\t\tif (this.touches.length) {\r\n\t\t\t\tthis.processMove(e, [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tfake: true,\r\n\t\t\t\t\t\tclientX: e.clientX,\r\n\t\t\t\t\t\tclientY: e.clientY,\r\n\t\t\t\t\t}\r\n\t\t\t\t]);\r\n\t\t\t\tif (e.preventDefault) {\r\n\t\t\t\t\te.preventDefault();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tonMouseUp () {\r\n\t\t\tthis.touches = [];\r\n\t\t},\r\n\t\tinitAnchor (touch) {\r\n\t\t\tconst draggable = this.$refs.draggable;\r\n\t\t\tconst { left, right, bottom, top, } = draggable.getBoundingClientRect();\r\n\r\n\t\t\tthis.anchor = {\r\n\t\t\t\tleft: touch.clientX - left,\r\n\t\t\t\ttop: touch.clientY - top,\r\n\t\t\t\tbottom: bottom - touch.clientY,\r\n\t\t\t\tright: right - touch.clientX,\r\n\t\t\t};\r\n\t\t},\r\n\t\tprocessMove (event, touches) {\r\n\t\t\tconst newTouches = [...touches];\r\n\t\t\tif (this.touches.length) {\r\n\t\t\t\tif (this.touches.length === 1 && newTouches.length === 1) {\r\n\t\t\t\t\tconst element = this.$refs.draggable;\r\n\t\t\t\t\tthis.$emit('drag', new DragEvent(\r\n\t\t\t\t\t\tevent,\r\n\t\t\t\t\t\telement,\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tleft: newTouches[0].clientX,\r\n\t\t\t\t\t\t\ttop: newTouches[0].clientY,\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tleft: this.touches[0].clientX,\r\n\t\t\t\t\t\t\ttop: this.touches[0].clientY,\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tthis.anchor\r\n\t\t\t\t\t));\r\n\t\t\t\t}\r\n\t\t\t\tthis.touches = newTouches;\r\n\t\t\t}\r\n\t\t},\r\n\t\tprocessEnd () {\r\n\t\t\tthis.touches = [];\r\n\t\t\tif (this.hovered) {\r\n\t\t\t\tthis.$emit('leave');\r\n\t\t\t\tthis.hovered = false;\r\n\t\t\t}\r\n\t\t},\r\n\t},\r\n};\r\n","export const HORIZONTAL_DIRECTIONS = ['left', 'right'];\r\nexport const VERTICAL_DIRECTIONS = ['top', 'bottom'];\r\nexport const ALL_DIRECTIONS = ['left', 'right', 'top', 'bottom'];\r\n\r\nexport const COORDINATES_TYPES = ['width', 'height', 'left', 'top'];\r\n\r\nexport const IMAGE_RESTRICTIONS = ['area', 'stencil', 'none'];\r\n\r\nexport const XHR_DONE = 4;\r\n\r\nexport const MINIMAL_PERCENT_SIZE = 0.1;\r\n\r\nexport const DEFAULT_COORDINATES = {\r\n\tleft: 0,\r\n\ttop: 0,\r\n\twidth: 0,\r\n\theight: 0,\r\n};","import { XHR_DONE } from './constants';\r\n\r\nexport function prepareSource(canvas, image, { flipped, orientation, }) {\r\n\tconst width = image.naturalWidth;\r\n\tconst height = image.naturalHeight;\r\n\r\n\tconst ctx = canvas.getContext('2d');\r\n\tcanvas.width = width;\r\n\tcanvas.height = height;\r\n\r\n\tctx.save();\r\n\r\n\tif (flipped) {\r\n\t\tcanvas.width = height;\r\n\t\tcanvas.height = width;\r\n\t}\r\n\r\n\t// TODO: refactor this\r\n\tif (orientation == 2) {\r\n\t\tctx.translate(width, 0);\r\n\t\tctx.scale(-1, 1);\r\n\t} else if (orientation == 3) {\r\n\t\tctx.translate(width, height);\r\n\t\tctx.rotate(180 / 180 * Math.PI);\r\n\t} else if (orientation == 4) {\r\n\t\tctx.translate(0, height);\r\n\t\tctx.scale(1, -1);\r\n\t} else if (orientation == 5) {\r\n\t\tctx.rotate(90 / 180 * Math.PI);\r\n\t\tctx.scale(1, -1);\r\n\t} else if (orientation == 6) {\r\n\t\tctx.rotate(90 / 180 * Math.PI);\r\n\t\tctx.translate(0, -height);\r\n\t} else if (orientation == 7) {\r\n\t\tctx.rotate(270 / 180 * Math.PI);\r\n\t\tctx.translate(-width, height);\r\n\t\tctx.scale(1, -1);\r\n\t} else if (orientation == 8) {\r\n\t\tctx.translate(0, width);\r\n\t\tctx.rotate(270 / 180 * Math.PI);\r\n\t}\r\n\r\n\tctx.drawImage(image, 0, 0, width, height);\r\n\tctx.restore();\r\n\r\n\treturn canvas;\r\n}\r\n\r\nexport function getImageTransforms(orientation) {\r\n\tlet result = {\r\n\t\torientation,\r\n\t};\r\n\tif (orientation) {\r\n\t\tswitch (orientation) {\r\n\t\tcase 2:\r\n\t\t\tresult.scaleX = -1;\r\n\t\t\tbreak;\r\n\t\tcase 3:\r\n\t\t\tresult.rotate = -180;\r\n\t\t\tbreak;\r\n\t\tcase 4:\r\n\t\t\tresult.scaleY = -1;\r\n\t\t\tbreak;\r\n\t\tcase 5:\r\n\t\t\tresult.rotate = 90;\r\n\t\t\tresult.scaleY = -1;\r\n\t\t\tbreak;\r\n\t\tcase 6:\r\n\t\t\tresult.rotate = 90;\r\n\t\t\tbreak;\r\n\t\tcase 7:\r\n\t\t\tresult.rotate = 90;\r\n\t\t\tresult.scaleX = -1;\r\n\t\t\tbreak;\r\n\t\tcase 8:\r\n\t\t\tresult.rotate = -90;\r\n\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n\tif (result.rotate === 90 || result.rotate === -90) {\r\n\t\tresult.flipped = true;\r\n\t}\r\n\treturn result;\r\n}\r\n\r\nexport function getStyleTransforms({ rotate, scaleX, scaleY, }) {\r\n\tlet transform = '';\r\n\tif (rotate || scaleX || scaleY) {\r\n\t\tif (rotate) {\r\n\t\t\ttransform += ` rotate(${rotate}deg) `;\r\n\t\t}\r\n\t\tif (scaleX) {\r\n\t\t\ttransform += ` scaleX(${scaleX}) `;\r\n\t\t}\r\n\t\tif (scaleY) {\r\n\t\t\ttransform += ` scaleY(${scaleY}) `;\r\n\t\t}\r\n\t}\r\n\treturn transform;\r\n}\r\n\r\nexport function parseImage(src) {\r\n\treturn new Promise((resolve) => {\r\n\t\tgetImageData(src)\r\n\t\t\t.then(data => {\r\n\t\t\t\tresolve(data ?\r\n\t\t\t\t\t{ source: src, arrayBuffer: data, orientation: getOrientation(data) } :\r\n\t\t\t\t\t{ source: src, arrayBuffer: null, orientation: null }\r\n\t\t\t\t);\r\n\t\t\t})\r\n\t\t\t.catch((error) => {\r\n\t\t\t\tconsole.warn(error);\r\n\t\t\t\tresolve({ source: src, arrayBuffer: null, orientation: null, });\r\n\t\t\t});\r\n\t});\r\n}\r\n\r\nfunction getImageData(img) {\r\n\treturn new Promise((resolve, reject) => {\r\n\t\ttry {\r\n\t\t\tif (img) {\r\n\t\t\t\t// Data URL\r\n\t\t\t\tif (/^data:/i.test(img)) {\r\n\t\t\t\t\tresolve(base64ToArrayBuffer(img));\r\n\t\t\t\t// Blob\r\n\t\t\t\t} else if (/^blob:/i.test(img)) {\r\n\t\t\t\t\tconst fileReader = new FileReader();\r\n\t\t\t\t\tfileReader.onload = function (e) {\r\n\t\t\t\t\t\tresolve(e.target.result);\r\n\t\t\t\t\t};\r\n\t\t\t\t\tobjectURLToBlob(img, function (blob) {\r\n\t\t\t\t\t\tfileReader.readAsArrayBuffer(blob);\r\n\t\t\t\t\t});\r\n\t\t\t\t// Simple URL\r\n\t\t\t\t} else {\r\n\t\t\t\t\tlet http = new XMLHttpRequest();\r\n\t\t\t\t\thttp.onreadystatechange = function () {\r\n\t\t\t\t\t\tif (http.readyState !== XHR_DONE) return;\r\n\r\n\t\t\t\t\t\tif (http.status === 200 || http.status === 0) {\r\n\t\t\t\t\t\t\tresolve(http.response);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\treject('Warning: could not load an image to parse its orientation');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\thttp = null;\r\n\t\t\t\t\t};\r\n\t\t\t\t\thttp.onprogress = function () {\r\n\t\t\t\t\t\t// Abort the request directly if it not a JPEG image for better performance\r\n\t\t\t\t\t\tif (http.getResponseHeader('content-type') !== 'image/jpeg') {\r\n\t\t\t\t\t\t\thttp.abort();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t};\r\n\t\t\t\t\thttp.withCredentials  = false;\r\n\t\t\t\t\thttp.open('GET', img, true);\r\n\t\t\t\t\thttp.responseType = 'arraybuffer';\r\n\t\t\t\t\thttp.send(null);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\treject('Error: the image is empty');\r\n\t\t\t}\r\n\t\t} catch (e) {\r\n\t\t\treject(e);\r\n\t\t}\r\n\t});\r\n}\r\n\r\nfunction objectURLToBlob(url, callback) {\r\n\tconst http = new XMLHttpRequest();\r\n\thttp.open('GET', url, true);\r\n\thttp.responseType = 'blob';\r\n\thttp.onload = function () {\r\n\t\tif (this.status == 200 || this.status === 0) {\r\n\t\t\tcallback(this.response);\r\n\t\t}\r\n\t};\r\n\thttp.send();\r\n}\r\n\r\nfunction base64ToArrayBuffer(base64) {\r\n\tbase64 = base64.replace(/^data:([^;]+);base64,/gmi, '');\r\n\tconst binary = atob(base64);\r\n\tconst len = binary.length;\r\n\tconst buffer = new ArrayBuffer(len);\r\n\tconst view = new Uint8Array(buffer);\r\n\tfor (let i = 0; i < len; i++) {\r\n\t\tview[i] = binary.charCodeAt(i);\r\n\t}\r\n\treturn buffer;\r\n}\r\nfunction getStringFromCharCode(dataView, start, length) {\r\n\tlet str = '';\r\n\tlet i;\r\n\tfor (i = start, length += start; i < length; i++) {\r\n\t\tstr += String.fromCharCode(dataView.getUint8(i));\r\n\t}\r\n\treturn str;\r\n}\r\n\r\nfunction getOrientation(arrayBuffer) {\r\n\ttry {\r\n\t\tconst dataView = new DataView(arrayBuffer);\r\n\t\tlet orientation;\r\n\t\tlet exifIDCode;\r\n\t\tlet tiffOffset;\r\n\t\tlet littleEndian;\r\n\t\tlet app1Start;\r\n\t\tlet ifdStart;\r\n\t\t// Only handle JPEG image (start by 0xFFD8)\r\n\t\tif (dataView.getUint8(0) === 0xFF && dataView.getUint8(1) === 0xD8) {\r\n\t\t\tconst length = dataView.byteLength;\r\n\t\t\tlet offset = 2;\r\n\t\t\twhile (offset + 1 < length) {\r\n\t\t\t\tif (dataView.getUint8(offset) === 0xFF && dataView.getUint8(offset + 1) === 0xE1) {\r\n\t\t\t\t\tapp1Start = offset;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\toffset++;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (app1Start) {\r\n\t\t\texifIDCode = app1Start + 4;\r\n\t\t\ttiffOffset = app1Start + 10;\r\n\t\t\tif (getStringFromCharCode(dataView, exifIDCode, 4) === 'Exif') {\r\n\t\t\t\tconst endianness = dataView.getUint16(tiffOffset);\r\n\r\n\t\t\t\tlittleEndian = endianness === 0x4949;\r\n\r\n\t\t\t\tif (littleEndian || endianness === 0x4D4D /* bigEndian */) {\r\n\t\t\t\t\tif (dataView.getUint16(tiffOffset + 2, littleEndian) === 0x002A) {\r\n\t\t\t\t\t\tconst firstIFDOffset = dataView.getUint32(tiffOffset + 4, littleEndian);\r\n\t\t\t\t\t\tif (firstIFDOffset >= 0x00000008) {\r\n\t\t\t\t\t\t\tifdStart = tiffOffset + firstIFDOffset;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (ifdStart) {\r\n\t\t\tconst length = dataView.getUint16(ifdStart, littleEndian);\r\n\r\n\t\t\tfor (let i = 0; i < length; i++) {\r\n\t\t\t\tlet offset = ifdStart + (i * 12) + 2;\r\n\t\t\t\tif (dataView.getUint16(offset, littleEndian) === 0x0112 /* Orientation */) {\r\n\t\t\t\t\t// 8 is the offset of the current tag's value\r\n\t\t\t\t\toffset += 8;\r\n\t\t\t\t\t// Get the original orientation value\r\n\t\t\t\t\torientation = dataView.getUint16(offset, littleEndian);\r\n\t\t\t\t\t// Override the orientation with its default value\r\n\t\t\t\t\tdataView.setUint16(offset, 1, littleEndian);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn orientation;\r\n\t} catch (error) {\r\n\t\treturn null;\r\n\t}\r\n}\r\n\r\nexport function arrayBufferToDataURL(arrayBuffer) {\r\n\tconst chunks = [];\r\n\r\n\t// Chunk Typed Array for better performance (#435)\r\n\tconst chunkSize = 8192;\r\n\tlet uint8 = new Uint8Array(arrayBuffer);\r\n\r\n\twhile (uint8.length > 0) {\r\n\t\tconst value = uint8.subarray(0, chunkSize);\r\n\t\tchunks.push(String.fromCharCode.apply(\r\n\t\t\tnull,\r\n\t\t\tArray.from ? Array.from(value) : Array.slice(value)\r\n\t\t));\r\n\t\tuint8 = uint8.subarray(chunkSize);\r\n\t}\r\n\r\n\treturn `data:image/jpeg;base64,${btoa(chunks.join(''))}`;\r\n}\r\n","import {\n\tHORIZONTAL_DIRECTIONS,\n\tVERTICAL_DIRECTIONS,\n\tALL_DIRECTIONS,\n} from './constants';\n\nimport {\n\tisUndefined\n} from './utils';\n\nimport { MoveEvent } from './events';\n\nfunction allSides(coordinates) {\n\treturn {\n\t\tleft: coordinates.left,\n\t\ttop: coordinates.top,\n\t\tright: coordinates.left + coordinates.width,\n\t\tbottom: coordinates.top + coordinates.height,\n\t};\n}\n\nfunction mainSide(side) {\n\tif (side === 'right') {\n\t\treturn 'left';\n\t} else if (side === 'bottom') {\n\t\treturn 'top';\n\t} else if (side === 'left' || side === 'top') {\n\t\treturn side;\n\t}\n}\n\nfunction getCurrentWidth(actualCoordinates, directions) {\n\treturn actualCoordinates.width + (directions.left + directions.right);\n}\n\nfunction getCurrentHeight(actualCoordinates, directions) {\n\treturn actualCoordinates.height + (directions.top + directions.bottom);\n}\n\nfunction getBrokenLimits(coordinates, directions, allowedArea) {\n\treturn {\n\t\tleft: ('left' in allowedArea) ? -Math.min(0, Math.ceil(coordinates.left - allowedArea.left) - directions.left) : 0,\n\t\ttop: ('top' in allowedArea) ? -Math.min(0, Math.ceil(coordinates.top - allowedArea.top) - directions.top) : 0,\n\t\tbottom: ('bottom' in allowedArea) ? -Math.min(0, allowedArea.bottom - (coordinates.bottom + directions.bottom)) : 0,\n\t\tright: ('right' in allowedArea) ? -Math.min(0, allowedArea.right - (coordinates.right + directions.right)) : 0,\n\t};\n}\n\nfunction fitConditions({ directions: oldDirections, coordinates, restrictions, preserveAspectRatio, stopOnBreak, mode = 'crop', allowedArea = {}}) {\n\tconst directions = { ...oldDirections, };\n\n\tlet currentWidth = getCurrentWidth(coordinates, directions);\n\tlet currentHeight = getCurrentHeight(coordinates, directions);\n\n\t// Prevent strange resizes when the width or height of stencil becomes smaller than 0\n\tif (currentWidth < 0) {\n\t\tif (directions.left < 0 && directions.right < 0) {\n\t\t\tdirections.left = -(coordinates.width - restrictions.minWidth) / (directions.left / directions.right);\n\t\t\tdirections.right = -(coordinates.width - restrictions.minWidth) / (directions.right / directions.left);\n\t\t} else if (directions.left < 0) {\n\t\t\tdirections.left = -(coordinates.width - restrictions.minWidth);\n\t\t} else if (directions.right < 0) {\n\t\t\tdirections.right = -(coordinates.width - restrictions.minWidth);\n\t\t}\n\t}\n\tif (currentHeight < 0) {\n\t\tif (directions.top < 0 && directions.bottom < 0) {\n\t\t\tdirections.top = -(coordinates.height - restrictions.minHeight) / (directions.top / directions.bottom);\n\t\t\tdirections.bottom = -(coordinates.height - restrictions.minHeight) / (directions.bottom / directions.top);\n\t\t} else if (directions.top < 0) {\n\t\t\tdirections.top = -(coordinates.height - restrictions.minHeight);\n\t\t} else if (directions.bottom < 0) {\n\t\t\tdirections.bottom = -(coordinates.height - restrictions.minHeight);\n\t\t}\n\t}\n\n\t// Prevent breaking limits\n\tlet breaks = getBrokenLimits(coordinates, directions, allowedArea);\n\n\tif (mode === 'move') {\n\t\tif (breaks.left > 0 && breaks.right === 0) {\n\t\t\tdirections.right += breaks.left;\n\t\t\tdirections.left -= breaks.left;\n\t\t} else if (breaks.right > 0 && breaks.left === 0) {\n\t\t\tdirections.left += breaks.right;\n\t\t\tdirections.right -= breaks.right;\n\t\t}\n\n\t\tif (breaks.top > 0 && breaks.bottom === 0) {\n\t\t\tdirections.bottom += breaks.top;\n\t\t\tdirections.top -= breaks.top;\n\t\t} else if (breaks.bottom > 0 && breaks.top === 0) {\n\t\t\tdirections.top += breaks.bottom;\n\t\t\tdirections.bottom -= breaks.bottom;\n\t\t}\n\n\t\tbreaks = getBrokenLimits(coordinates, directions, allowedArea);\n\t}\n\n\tconst maxResize = {\n\t\twidth: Infinity,\n\t\theight: Infinity\n\t};\n\n\tALL_DIRECTIONS.forEach(direction => {\n\t\tif (breaks[direction] && directions[direction]) {\n\t\t\tmaxResize[direction] = Math.max(0, 1 - breaks[direction] / (directions[direction]));\n\t\t} else {\n\t\t\tmaxResize[direction] = Infinity;\n\t\t}\n\t});\n\n\tif (preserveAspectRatio) {\n\t\tconst multiplier = Math.min(...ALL_DIRECTIONS.map(direction => maxResize[direction]));\n\t\tif (multiplier !== Infinity) {\n\t\t\tALL_DIRECTIONS.forEach(direction => {\n\t\t\t\tdirections[direction] *= multiplier;\n\t\t\t});\n\t\t}\n\t} else {\n\t\tHORIZONTAL_DIRECTIONS.forEach(direction => {\n\t\t\tconst multiplier = stopOnBreak ? Math.min(maxResize.top, maxResize.bottom) : maxResize[direction];\n\t\t\tif (multiplier !== Infinity) {\n\t\t\t\tdirections[direction] *= multiplier;\n\t\t\t}\n\t\t});\n\t\tVERTICAL_DIRECTIONS.forEach(direction => {\n\t\t\tconst multiplier = stopOnBreak ? Math.min(maxResize.top, maxResize.bottom) : maxResize[direction];\n\t\t\tif (multiplier !== Infinity) {\n\t\t\t\tdirections[direction] *= multiplier;\n\t\t\t}\n\t\t});\n\t}\n\n\tcurrentWidth = getCurrentWidth(coordinates, directions);\n\tcurrentHeight = getCurrentHeight(coordinates, directions);\n\n\tif (directions.right + directions.left) {\n\t\tif (currentWidth > restrictions.maxWidth) {\n\t\t\tmaxResize.width = (restrictions.maxWidth - coordinates.width) / (directions.right + directions.left);\n\t\t} else if (currentWidth < restrictions.minWidth) {\n\t\t\tmaxResize.width = (restrictions.minWidth - coordinates.width) / (directions.right + directions.left);\n\t\t}\n\t}\n\n\tif (directions.bottom + directions.top) {\n\t\tif (currentHeight > restrictions.maxHeight) {\n\t\t\tmaxResize.height = (restrictions.maxHeight - coordinates.height) / (directions.bottom + directions.top);\n\t\t} else if (currentHeight < restrictions.minHeight) {\n\t\t\tmaxResize.height = (restrictions.minHeight - coordinates.height) / (directions.bottom + directions.top);\n\t\t}\n\t}\n\n\tif (preserveAspectRatio) {\n\t\tconst multiplier = Math.min(maxResize.width, maxResize.height);\n\t\tif (multiplier !== Infinity) {\n\t\t\tALL_DIRECTIONS.forEach(direction => {\n\t\t\t\tdirections[direction] *= multiplier;\n\t\t\t});\n\t\t}\n\t}\n\telse {\n\t\tif (maxResize.width !== Infinity) {\n\t\t\tHORIZONTAL_DIRECTIONS.forEach(direction => {\n\t\t\t\tdirections[direction] *= maxResize.width;\n\t\t\t});\n\t\t}\n\t\tif (maxResize.height !== Infinity) {\n\t\t\tVERTICAL_DIRECTIONS.forEach(direction => {\n\t\t\t\tdirections[direction] *= maxResize.height;\n\t\t\t});\n\t\t}\n\t}\n\n\treturn directions;\n}\n\n\n\nfunction getBrokenRatio(currentWidth, currentHeight, aspectRatio, actualCoordinates, preserveAspectRatio) {\n\tlet ratioBroken;\n\tif (aspectRatio.minimum && currentWidth / currentHeight < aspectRatio.minimum) {\n\t\tratioBroken = aspectRatio.minimum;\n\t} else if (aspectRatio.maximum && currentWidth / currentHeight > aspectRatio.maximum) {\n\t\tratioBroken = aspectRatio.maximum;\n\t} else if (preserveAspectRatio) {\n\t\tratioBroken = actualCoordinates.width / actualCoordinates.height;\n\t}\n\treturn ratioBroken;\n}\n\nexport function resize ({ coordinates, restrictions, allowedArea, aspectRatio, resizeEvent }) {\n\tconst actualCoordinates = {\n\t\t...coordinates,\n\t\tright: coordinates.left + coordinates.width,\n\t\tbottom: coordinates.top + coordinates.height,\n\t};\n\n\tconst params = resizeEvent.params || {};\n\n\tlet directions = {\n\t\t...resizeEvent.directions,\n\t};\n\n\tconst limitedRestrictions = {\n\t\t...restrictions,\n\t\tminWidth: Math.max(restrictions.minWidth, restrictions.minimum),\n\t\tminHeight: Math.max(restrictions.minHeight, restrictions.minimum),\n\t};\n\n\tconst allowedDirections = params.allowedDirections || {\n\t\tleft: true,\n\t\tright: true,\n\t\tbottom: true,\n\t\ttop: true,\n\t};\n\n\tALL_DIRECTIONS.forEach(direction => {\n\t\tif (!allowedDirections[direction]) {\n\t\t\tdirections[direction] = 0;\n\t\t}\n\t});\n\n\t// 1. First step: determine the safe and desired area\n\tdirections = fitConditions({ directions, restrictions: limitedRestrictions, coordinates: actualCoordinates, allowedArea, stopOnBreak: params.stopOnBreak });\n\n\t// 2. Second step: fix desired box to correspondent to aspect ratio\n\tlet currentWidth = getCurrentWidth(actualCoordinates, directions);\n\tlet currentHeight = getCurrentHeight(actualCoordinates, directions);\n\n\t// Checks ratio:\n\tlet ratioBroken = getBrokenRatio(currentWidth, currentHeight, aspectRatio, actualCoordinates, params.preserveAspectRatio);\n\n\tif (ratioBroken) {\n\t\tlet { respectDirection, } = params;\n\t\tif (!respectDirection) {\n\t\t\tif (actualCoordinates.width >= actualCoordinates.height || ratioBroken == 1) {\n\t\t\t\trespectDirection = 'width';\n\t\t\t} else {\n\t\t\t\trespectDirection = 'height';\n\t\t\t}\n\t\t}\n\t\tif (respectDirection === 'width') {\n\t\t\tlet overlapHeight = currentWidth / ratioBroken - actualCoordinates.height;\n\t\t\tif ((allowedDirections.top && allowedDirections.bottom)) {\n\t\t\t\tdirections.bottom = overlapHeight / 2;\n\t\t\t\tdirections.top = overlapHeight / 2;\n\t\t\t} else if (allowedDirections.bottom) {\n\t\t\t\tdirections.bottom = overlapHeight;\n\t\t\t} else if (allowedDirections.top) {\n\t\t\t\tdirections.top = overlapHeight;\n\t\t\t}  else if (allowedDirections.right) {\n\t\t\t\tdirections.right = 0;\n\t\t\t} else if (allowedDirections.left) {\n\t\t\t\tdirections.left = 0;\n\t\t\t}\n\t\t} else if (respectDirection === 'height') {\n\t\t\tlet overlapWidth = actualCoordinates.width - currentHeight * ratioBroken;\n\t\t\tif (allowedDirections.left && allowedDirections.right) {\n\t\t\t\tdirections.left = -overlapWidth / 2;\n\t\t\t\tdirections.right = -overlapWidth / 2;\n\t\t\t} else if (allowedDirections.left) {\n\t\t\t\tdirections.left = -overlapWidth;\n\t\t\t} else if (allowedDirections.right) {\n\t\t\t\tdirections.right = -overlapWidth;\n\t\t\t} else if (allowedDirections.top) {\n\t\t\t\tdirections.top = 0;\n\t\t\t} else if (allowedDirections.bottom) {\n\t\t\t\tdirections.bottom = 0;\n\t\t\t}\n\t\t}\n\t\t// 3. Third step: check if desired box with correct aspect ratios break some limits and fit to this conditions\n\t\tdirections = fitConditions({ directions, restrictions: limitedRestrictions, coordinates: actualCoordinates, allowedArea, preserveAspectRatio: true, mode: params.compensate && !params.stopOnBreak ? 'move' : 'crop' });\n\t}\n\n\t// 4. Check if ratio broken (temporary):\n\tcurrentWidth = getCurrentWidth(actualCoordinates, directions);\n\tcurrentHeight = getCurrentHeight(actualCoordinates, directions);\n\tratioBroken = getBrokenRatio(currentWidth, currentHeight, aspectRatio, actualCoordinates, params.preserveAspectRatio);\n\tif (Math.abs(ratioBroken - currentWidth/currentHeight) > 1e-3) {\n\t\tconsole.error(`Something went wrong and ratio was broken: ${currentWidth/currentHeight} instead of ${ratioBroken}`);\n\t\tALL_DIRECTIONS.forEach(direction => {\n\t\t\tif (!allowedDirections[direction]) {\n\t\t\t\tdirections[direction] = 0;\n\t\t\t}\n\t\t});\n\t}\n\n\treturn move({\n\t\tcoordinates: {\n\t\t\twidth: coordinates.width + directions.right + directions.left,\n\t\t\theight: coordinates.height + directions.top + directions.bottom,\n\t\t\tleft: coordinates.left,\n\t\t\ttop: coordinates.top,\n\t\t},\n\t\tallowedArea,\n\t\tmoveEvent: new MoveEvent({}, {\n\t\t\tleft: -directions.left,\n\t\t\ttop: -directions.top,\n\t\t})\n\t});\n}\n\nexport function move ({ coordinates, allowedArea = {}, moveEvent }) {\n\n\tconst directions = {\n\t\t...moveEvent.directions,\n\t};\n\n\tconst newCoordinates = {\n\t\tleft: coordinates.left + directions.left,\n\t\ttop: coordinates.top + directions.top,\n\t\twidth: coordinates.width,\n\t\theight: coordinates.height,\n\t};\n\n\tif ('left' in allowedArea && newCoordinates.left < allowedArea.left) {\n\t\tnewCoordinates.left = allowedArea.left;\n\t}\n\tif ('right' in allowedArea && newCoordinates.left + newCoordinates.width > allowedArea.right) {\n\t\tnewCoordinates.left = allowedArea.right - newCoordinates.width;\n\t}\n\tif ('top' in allowedArea && newCoordinates.top < allowedArea.top) {\n\t\tnewCoordinates.top = allowedArea.top;\n\t}\n\tif ('bottom' in allowedArea && newCoordinates.top + newCoordinates.height > allowedArea.bottom) {\n\t\tnewCoordinates.top = allowedArea.bottom - newCoordinates.height;\n\t}\n\n\treturn newCoordinates;\n}\n\n// eslint-disable-next-line no-unused-vars\nexport function areaSize ({ cropper, image, imageWidth, imageHeight }) {\n\tconst areaHeight = cropper.clientHeight;\n\tconst areaWidth = cropper.clientWidth;\n\n\tlet currentHeight = areaHeight;\n\tlet currentWidth = imageWidth * areaHeight / imageHeight;\n\n\tif (currentWidth > areaWidth) {\n\t\tcurrentWidth = areaWidth;\n\t\tcurrentHeight = imageHeight * areaWidth / imageWidth;\n\t}\n\n\treturn {\n\t\twidth: currentWidth,\n\t\theight: currentHeight,\n\t};\n}\n\n// eslint-disable-next-line no-unused-vars\nexport function defaultPosition ({ cropper, image, stencilWidth, stencilHeight, imageWidth, imageHeight,  props }) {\n\treturn {\n\t\tleft: imageWidth / 2 - stencilWidth / 2,\n\t\ttop: imageHeight / 2 - stencilHeight / 2,\n\t};\n}\n\n// eslint-disable-next-line no-unused-vars\nexport function defaultSize ({ cropper, image, minWidth, minHeight, maxWidth, maxHeight, imageWidth, imageHeight, aspectRatio, props }) {\n\tlet newHeight, newWidth;\n\tlet areaWidth = imageWidth;\n\tlet areaHeight = imageHeight;\n\n\tconst ratio = imageWidth > imageHeight ? aspectRatio.maximum : aspectRatio.minimum;\n\n\tif (imageWidth / imageHeight > aspectRatio.maximum || imageWidth / imageHeight < aspectRatio.minimum) {\n\t\tif (ratio <= 1) {\n\t\t\tareaHeight = imageHeight;\n\t\t\tareaWidth = areaHeight * aspectRatio.maximum;\n\t\t} else {\n\t\t\tareaWidth = imageWidth;\n\t\t\tareaHeight = areaWidth / aspectRatio.minimum;\n\t\t}\n\t}\n\n\tnewHeight = Math.min(maxHeight, Math.max(minHeight, areaHeight * 0.8));\n\tnewWidth = Math.min(maxWidth, Math.max(minWidth, areaWidth * 0.8));\n\n\treturn {\n\t\theight: newHeight,\n\t\twidth: newWidth,\n\t};\n}\n\nexport function percentRestrictions({ minWidth, minHeight, maxWidth, maxHeight, imageWidth, imageHeight }) {\n\treturn {\n\t\tminWidth: minWidth / 100 * imageWidth,\n\t\tminHeight: minHeight / 100 * imageHeight,\n\t\tmaxWidth: maxWidth / 100 * imageWidth,\n\t\tmaxHeight: maxHeight / 100 * imageHeight,\n\t};\n}\n\n// The main point of this feature is calculating the needed position of stencil and parameters of world transforms\n// Real coordinates don't changes here\nexport function autoZoom({ coordinates, stencilCoordinates: originalStencilCoordinates, worldTransforms: originalWorldTransforms, coefficient, imageSize, allowedArea }) {\n\tconst worldTransforms = {\n\t\t...originalWorldTransforms\n\t};\n\n\tconst stencilCoordinates = {\n\t\twidth: worldTransforms.scale * coordinates.width / coefficient,\n\t\theight: worldTransforms.scale * coordinates.height / coefficient,\n\t\tleft: originalStencilCoordinates.left,\n\t\ttop: originalStencilCoordinates.top,\n\t};\n\n\tworldTransforms.shift.left -= (coordinates.left * worldTransforms.scale + worldTransforms.shift.left) - originalStencilCoordinates.left * coefficient;\n\tworldTransforms.shift.top -= (coordinates.top * worldTransforms.scale + worldTransforms.shift.top) - originalStencilCoordinates.top * coefficient;\n\n\t// 1. Scale the image, if the stencil is too big\n\tlet multiplier = 1;\n\tif (stencilCoordinates.width > imageSize.width / coefficient) {\n\t\tmultiplier = Math.min(multiplier, imageSize.width / coefficient / stencilCoordinates.width);\n\t}\n\tif (stencilCoordinates.height > imageSize.height / coefficient) {\n\t\tmultiplier = Math.min(multiplier, imageSize.height / coefficient / stencilCoordinates.height);\n\t}\n\n\tif (multiplier !== 1) {\n\t\tworldTransforms.scale *= multiplier;\n\t\tstencilCoordinates.left += stencilCoordinates.width * (1 - multiplier)/2;\n\t\tstencilCoordinates.top += stencilCoordinates.height * (1 - multiplier)/2;\n\t\tworldTransforms.shift.left = stencilCoordinates.left * coefficient - (coordinates.left) * worldTransforms.scale;\n\t\tworldTransforms.shift.top = stencilCoordinates.top * coefficient - (coordinates.top) * worldTransforms.scale;\n\t\tstencilCoordinates.width *= multiplier;\n\t\tstencilCoordinates.height *= multiplier;\n\t}\n\n\t// 2. Move the stencil to prevent breaking borders\n\tif (stencilCoordinates.left < 0) {\n\t\tworldTransforms.shift.left -= stencilCoordinates.left * coefficient;\n\t\tstencilCoordinates.left = 0;\n\t}\n\n\tif (stencilCoordinates.top < 0) {\n\t\tworldTransforms.shift.top -= stencilCoordinates.top * coefficient;\n\t\tstencilCoordinates.top = 0;\n\t}\n\n\tif (stencilCoordinates.left + stencilCoordinates.width > imageSize.width / coefficient) {\n\t\tworldTransforms.shift.left -= (stencilCoordinates.left + stencilCoordinates.width) * coefficient - imageSize.width;\n\t\tstencilCoordinates.left = imageSize.width / coefficient - stencilCoordinates.width;\n\t}\n\n\tif (stencilCoordinates.top + stencilCoordinates.height > imageSize.height / coefficient) {\n\t\tworldTransforms.shift.top -= (stencilCoordinates.top + stencilCoordinates.height) * coefficient - imageSize.height;\n\t\tstencilCoordinates.top = imageSize.height / coefficient - stencilCoordinates.height;\n\t}\n\n\t// 3. Move the image to prevent breaking borders:\n\tconst scaledImageSize = {\n\t\twidth: imageSize.width * worldTransforms.scale,\n\t\theight: imageSize.height * worldTransforms.scale,\n\t};\n\n\tif (worldTransforms.shift.left > -allowedArea.left * worldTransforms.scale) {\n\t\tstencilCoordinates.left -= (worldTransforms.shift.left + (allowedArea.left * worldTransforms.scale)) / coefficient;\n\t\tworldTransforms.shift.left = -(allowedArea.left * worldTransforms.scale);\n\t}\n\tif (worldTransforms.shift.left < imageSize.width - scaledImageSize.width - (allowedArea.right - imageSize.width) * worldTransforms.scale) {\n\t\tstencilCoordinates.left -= (worldTransforms.shift.left - (imageSize.width - scaledImageSize.width) + (allowedArea.right - imageSize.width) * worldTransforms.scale) / coefficient;\n\t\tworldTransforms.shift.left = imageSize.width - scaledImageSize.width - (allowedArea.right - imageSize.width) * worldTransforms.scale;\n\t}\n\tif (worldTransforms.shift.top > -allowedArea.top * worldTransforms.scale) {\n\t\tstencilCoordinates.top -= (worldTransforms.shift.top + (allowedArea.top * worldTransforms.scale)) / coefficient;\n\t\tworldTransforms.shift.top = -allowedArea.top * worldTransforms.scale;\n\t}\n\tif (worldTransforms.shift.top < imageSize.height - scaledImageSize.height - (allowedArea.bottom - imageSize.height) * worldTransforms.scale) {\n\t\tstencilCoordinates.top -= (worldTransforms.shift.top - (imageSize.height - scaledImageSize.height) + (allowedArea.bottom - imageSize.height) * worldTransforms.scale) / coefficient;\n\t\tworldTransforms.shift.top = imageSize.height - scaledImageSize.height - (allowedArea.bottom - imageSize.height) * worldTransforms.scale;\n\t}\n\n\treturn {\n\t\tstencilCoordinates,\n\t\tworldTransforms\n\t};\n}\n\nexport function manipulateImage({ manipulateImageEvent, coordinates, stencilRestrictions, coefficient, stencilCoordinates, worldTransforms: originalWorldTransforms, imageSize, frozenDirections, allowedArea, fitImage }) {\n\tlet { scale, move } = manipulateImageEvent;\n\tconst worldTransforms = { ...originalWorldTransforms };\n\n\tconst scaledImageSize = {\n\t\twidth: imageSize.width * worldTransforms.scale,\n\t\theight: imageSize.height * worldTransforms.scale,\n\t};\n\n\tconst imageShifts = {\n\t\tleft: move.left || 0,\n\t\ttop: move.top || 0,\n\t};\n\n\tlet scaleImage = 1;\n\tlet scaleStencil = 1;\n\n\tconst minScale = !fitImage ? Math.max(\n\t\t('left' in allowedArea && 'right' in allowedArea) ? stencilCoordinates.width * coefficient / (allowedArea.right - allowedArea.left) : 1e-2,\n\t\t('top' in allowedArea && 'bottom' in allowedArea) ? stencilCoordinates.height * coefficient / (allowedArea.bottom - allowedArea.top) : 1e-2,\n\t) : 1;\n\n\t// If there is scaling then begin scale\n\tif (!frozenDirections.width && !frozenDirections.height && Math.abs(scale.factor - 1) > 1e-3) {\n\t\tconst epsilon = Math.abs(1 - scaleImage) / 2;\n\t\tconst { maxWidth, maxHeight, minWidth, minHeight } = stencilRestrictions;\n\n\t\tscaleImage = scale.factor;\n\n\t\t// Determine allowed resize:\n\t\tif (worldTransforms.scale / scaleImage < minScale + epsilon) {\n\t\t\tscaleImage = worldTransforms.scale / minScale;\n\t\t}\n\n\t\tlet width = coordinates.width * scaleImage;\n\t\tlet height = coordinates.height * scaleImage;\n\n\t\t// Prevent breaking the restrictions\n\t\tconst breaks = {\n\t\t\tminWidth: width < minWidth + epsilon,\n\t\t\tminHeight: height < minHeight + epsilon,\n\t\t\tmaxWidth: width > maxWidth - epsilon,\n\t\t\tmaxHeight: height > maxHeight - epsilon,\n\t\t};\n\n\t\tif (breaks.minWidth) {\n\t\t\tscaleImage = minWidth / coordinates.width;\n\t\t}\n\t\tif (breaks.minHeight) {\n\t\t\tscaleImage = minHeight / coordinates.height;\n\t\t}\n\t\tif (breaks.maxHeight || breaks.maxWidth) {\n\t\t\tlet allowedImageScale = scaleImage;\n\t\t\tif (breaks.maxWidth && breaks.maxHeight) {\n\t\t\t\tallowedImageScale = Math.min(maxHeight / coordinates.height, coordinates.width);\n\t\t\t} else if (breaks.maxHeight) {\n\t\t\t\tallowedImageScale = maxHeight / coordinates.height;\n\t\t\t} else if (breaks.maxWidth) {\n\t\t\t\tallowedImageScale = maxWidth / coordinates.width;\n\t\t\t}\n\t\t\tif (worldTransforms.scale * scaleImage >= 1) {\n\t\t\t\tscaleStencil = allowedImageScale / scaleImage;\n\t\t\t} else {\n\t\t\t\tscaleImage = allowedImageScale;\n\t\t\t}\n\t\t}\n\n\t\tconst imageSizeChanges = {\n\t\t\twidth: scaledImageSize.width * (1 - 1/scaleImage),\n\t\t\theight:  scaledImageSize.height * (1 - 1/scaleImage),\n\t\t};\n\n\t\timageShifts.left += imageSizeChanges.width * Math.abs((worldTransforms.shift.left - scale.center.left * coefficient) / scaledImageSize.width);\n\t\timageShifts.top += imageSizeChanges.height * Math.abs((worldTransforms.shift.top - scale.center.top * coefficient) / scaledImageSize.height);\n\n\t\tscaledImageSize.width /= scaleImage;\n\t\tscaledImageSize.height /= scaleImage;\n\t}\n\n\tworldTransforms.scale = worldTransforms.scale / scaleImage;\n\n\t// If the image should not break area boundaries we should change coordinates so they don't break them\n\t// otherwise we just prevent moving\n\tif (fitImage) {\n\t\tif (Math.ceil(worldTransforms.shift.left + imageShifts.left) > 0) {\n\t\t\timageShifts.left = -worldTransforms.shift.left;\n\t\t} else if (worldTransforms.shift.left + imageShifts.left < imageSize.width - scaledImageSize.width) {\n\t\t\timageShifts.left = imageSize.width - scaledImageSize.width  - worldTransforms.shift.left;\n\t\t}\n\n\t\tif (Math.ceil(worldTransforms.shift.top + imageShifts.top) > 0) {\n\t\t\timageShifts.top = -worldTransforms.shift.top;\n\t\t} else if (worldTransforms.shift.top + imageShifts.top < imageSize.height - scaledImageSize.height) {\n\t\t\timageShifts.top = imageSize.height - scaledImageSize.height - worldTransforms.shift.top;\n\t\t}\n\t} else {\n\t\tconst breaks = {};\n\t\tALL_DIRECTIONS.forEach(side => {\n\t\t\tif (side in allowedArea) {\n\t\t\t\tbreaks[side] = (worldTransforms.shift[mainSide(side)] + imageShifts[mainSide(side)]) + (allowedArea[side] * worldTransforms.scale - allSides(stencilCoordinates)[side] * coefficient);\n\t\t\t} else {\n\t\t\t\tbreaks[side] = 0;\n\t\t\t}\n\t\t});\n\n\t\t// Process the moving:\n\t\tif (breaks.left > 0) {\n\t\t\timageShifts.left -= breaks.left;\n\t\t} else if (breaks.right < 0) {\n\t\t\timageShifts.left -= breaks.right;\n\t\t}\n\t\tif (breaks.top > 0) {\n\t\t\timageShifts.top -= breaks.top;\n\t\t} else if (breaks.bottom < 0) {\n\t\t\timageShifts.top -= breaks.bottom;\n\t\t}\n\t}\n\n\tworldTransforms.shift.left += imageShifts.left;\n\tworldTransforms.shift.top += imageShifts.top;\n\n\tconst stencilResizeAmends = { left: 0, top: 0 };\n\tif (imageSize.width !== coordinates.width && worldTransforms.scale >= 1) {\n\t\tstencilResizeAmends.left = stencilCoordinates.width * (1 - scaleStencil) * (coordinates.left / (imageSize.width - coordinates.width));\n\t}\n\tif (imageSize.height !== coordinates.height && worldTransforms.scale >= 1) {\n\t\tstencilResizeAmends.top = stencilCoordinates.height * (1 - scaleStencil) * (coordinates.top / (imageSize.height - coordinates.height));\n\t}\n\n\treturn {\n\t\tcoordinates: {\n\t\t\twidth: coordinates.width * scaleImage * scaleStencil,\n\t\t\theight: coordinates.height * scaleImage * scaleStencil,\n\t\t\tleft: (stencilCoordinates.left - worldTransforms.shift.left / coefficient + stencilResizeAmends.left) * coefficient / worldTransforms.scale,\n\t\t\ttop: (stencilCoordinates.top - worldTransforms.shift.top / coefficient + stencilResizeAmends.top) * coefficient / worldTransforms.scale,\n\t\t},\n\t\tworldTransforms\n\t};\n}\n\nexport function allowedArea({ breakBoundaries, imageSize, worldTransforms, imageRestriction }) {\n\tlet limits = {};\n\n\tif (imageRestriction !== 'none') {\n\t\tlimits = {\n\t\t\tleft: 0,\n\t\t\ttop: 0,\n\t\t\tright: imageSize.width,\n\t\t\tbottom: imageSize.height\n\t\t};\n\t}\n\n\tif (!breakBoundaries) {\n\t\tconst boundaries = {\n\t\t\tleft: -worldTransforms.shift.left / worldTransforms.scale,\n\t\t\ttop: -worldTransforms.shift.top / worldTransforms.scale,\n\t\t\tright: (imageSize.width - worldTransforms.shift.left) / worldTransforms.scale,\n\t\t\tbottom: (imageSize.height - worldTransforms.shift.top) / worldTransforms.scale\n\t\t};\n\t\tALL_DIRECTIONS.forEach(direction => {\n\t\t\tif (!isUndefined(limits[direction])) {\n\t\t\t\tif (direction === 'left' || direction === 'top') {\n\t\t\t\t\tlimits[direction] = Math.max(limits[direction], boundaries[direction]);\n\t\t\t\t} else {\n\t\t\t\t\tlimits[direction] = Math.min(limits[direction], boundaries[direction]);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tlimits[direction] = boundaries[direction];\n\t\t\t}\n\t\t});\n\t}\n\treturn limits;\n}\n\nexport function roundCoordinates({ coordinates, restrictions, allowedArea }) {\n\tconst roundedCoordinates = {\n\t\twidth: Math.round(coordinates.width),\n\t\theight: Math.round(coordinates.height),\n\t\tleft: Math.round(coordinates.left),\n\t\ttop: Math.round(coordinates.top),\n\t};\n\n\tif (roundedCoordinates.width > restrictions.maxWidth) {\n\t\troundedCoordinates.width = Math.floor(coordinates.width);\n\t} else if (roundedCoordinates.width < restrictions.minWidth) {\n\t\troundedCoordinates.width = Math.ceil(coordinates.width);\n\t}\n\tif (roundedCoordinates.height > restrictions.maxHeight) {\n\t\troundedCoordinates.height = Math.floor(coordinates.height);\n\t} else if (roundedCoordinates.height < restrictions.minHeight) {\n\t\troundedCoordinates.height = Math.ceil(coordinates.height);\n\t}\n\tif (roundedCoordinates.left < allowedArea.left || roundedCoordinates.left + roundedCoordinates.width > allowedArea.right) {\n\t\troundedCoordinates.left = Math.floor(allowedArea.left);\n\t}\n\tif (roundedCoordinates.top < allowedArea.top || roundedCoordinates.top + roundedCoordinates.height > allowedArea.bottom) {\n\t\troundedCoordinates.top = Math.floor(allowedArea.top);\n\t}\n\n\treturn roundedCoordinates;\n}\n","<script>\nimport classnames from 'classnames';\nimport bem from 'easy-bem';\nimport Vue from 'vue';\nimport debounce from 'debounce';\nimport { RectangleStencil } from './components/stencils';\nimport { CropperWrapper } from './components/service';\nimport { ResizeEvent, MoveEvent } from './core/events';\nimport { isLocal, isCrossOriginURL, isUndefined, addTimestamp, getSettings, parseNumber } from './core/utils';\nimport { arrayBufferToDataURL, getImageTransforms, getStyleTransforms, prepareSource, parseImage } from './core/image';\nimport { ALL_DIRECTIONS, MINIMAL_PERCENT_SIZE, IMAGE_RESTRICTIONS, DEFAULT_COORDINATES } from './core/constants';\nimport * as algorithms from './core/algorithms';\n\nconst cn = bem('vue-advanced-cropper');\n\nfunction migrateAlgorithm(f, name, transform) {\n\tfunction fallback(params) {\n\t\tconsole.warn(`The arguments will be passed to the prop '${name}' as an single object {${Object.keys(params).join(',')}} in the future releases. You should change the interface of your function.`);\n\t\treturn f(...transform(params));\n\t}\n\treturn (params) => {\n\t\tif (f.length > 1) {\n\t\t\treturn fallback(params);\n\t\t} else {\n\t\t\ttry {\n\t\t\t\treturn f(params);\n\t\t\t} catch (e) {\n\t\t\t\treturn fallback(params);\n\t\t\t}\n\t\t}\n\t};\n}\n\nexport default {\n\tname: 'Cropper',\n\tcomponents: {\n\t\tCropperWrapper\n\t},\n\tprops: {\n\t\tsrc: {\n\t\t\ttype: String,\n\t\t\tdefault: null,\n\t\t},\n\t\tbustCache: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\tallowedArea: {\n\t\t\ttype: Function,\n\t\t\tdefault: algorithms.allowedArea,\n\t\t},\n\t\tresizeAlgorithm: {\n\t\t\ttype: Function,\n\t\t\tdefault: algorithms.resize,\n\t\t},\n\t\tmoveAlgorithm: {\n\t\t\ttype: Function,\n\t\t\tdefault: algorithms.move,\n\t\t},\n\t\tdefaultSize: {\n\t\t\ttype: Function,\n\t\t\tdefault: algorithms.defaultSize,\n\t\t},\n\t\tdefaultPosition: {\n\t\t\ttype: Function,\n\t\t\tdefault: algorithms.defaultPosition,\n\t\t},\n\t\tareaSize: {\n\t\t\ttype: Function,\n\t\t\tdefault: algorithms.areaSize,\n\t\t},\n\t\trestrictions: {\n\t\t\ttype: Function,\n\t\t\tdefault: algorithms.percentRestrictions,\n\t\t},\n\t\tminWidth: {\n\t\t\ttype: [Number, String],\n\t\t},\n\t\tminHeight: {\n\t\t\ttype: [Number, String],\n\t\t},\n\t\tmaxWidth: {\n\t\t\ttype: [Number, String],\n\t\t},\n\t\tmaxHeight: {\n\t\t\ttype: [Number, String],\n\t\t},\n\t\tstencilComponent: {\n\t\t\ttype: [Object, String],\n\t\t\tdefault() {\n\t\t\t\treturn RectangleStencil;\n\t\t\t},\n\t\t},\n\t\tstencilProps: {\n\t\t\ttype: Object,\n\t\t\tdefault() {\n\t\t\t\treturn {};\n\t\t\t},\n\t\t},\n\t\tclassname: {\n\t\t\ttype: String,\n\t\t},\n\t\timageClassname: {\n\t\t\ttype: String,\n\t\t},\n\t\tareaClassname: {\n\t\t\ttype: String,\n\t\t},\n\t\tbackgroundClassname: {\n\t\t\ttype: String,\n\t\t},\n\t\tdebounce: {\n\t\t\ttype: Number,\n\t\t\tdefault: 500,\n\t\t},\n\t\tcanvas: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true,\n\t\t},\n\t\tcheckCrossOrigin: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true,\n\t\t},\n\t\tcheckOrientation: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true,\n\t\t},\n\t\tcrossOrigin: {\n\t\t\ttype: String,\n\t\t\tdefault: 'anonymous'\n\t\t},\n\t\ttransitionTime: {\n\t\t\ttype: Number,\n\t\t\tdefault: 300\n\t\t},\n\t\twheelResize: {\n\t\t\ttype: [Boolean, Object],\n\t\t\tdefault: true,\n\t\t},\n\t\ttouchResize: {\n\t\t\ttype: [Boolean, Object],\n\t\t\tdefault: true,\n\t\t},\n\t\ttouchMove: {\n\t\t\ttype: [Boolean, Object],\n\t\t\tdefault: true,\n\t\t},\n\t\tmouseMove: {\n\t\t\ttype: [Boolean, Object],\n\t\t\tdefault: true,\n\t\t},\n\t\timageRestriction: {\n\t\t\ttype: String,\n\t\t\tdefault: 'area',\n\t\t\tvalidator(value) {\n\t\t\t\treturn IMAGE_RESTRICTIONS.indexOf(value) !== -1;\n\t\t\t}\n\t\t},\n\t\troundResult: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true\n\t\t}\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tboundarySize: {\n\t\t\t\twidth: null,\n\t\t\t\theight: null,\n\t\t\t},\n\t\t\timageLoaded: false,\n\t\t\timageAttributes: {\n\t\t\t\tcrossOrigin: false,\n\t\t\t\tsrc: null,\n\t\t\t},\n\t\t\tbasicImageTransforms: {\n\t\t\t\trotate: null,\n\t\t\t\tscaleX: null,\n\t\t\t\tscaleY: null,\n\t\t\t},\n\t\t\timageSize: {\n\t\t\t\twidth: null,\n\t\t\t\theight: null,\n\t\t\t},\n\t\t\tcoordinates: {\n\t\t\t\t...DEFAULT_COORDINATES\n\t\t\t},\n\t\t\tstencilCoordinates: {\n\t\t\t\t...DEFAULT_COORDINATES\n\t\t\t},\n\t\t\tfrozenDirections: {\n\t\t\t\twidth: false,\n\t\t\t\theight: false,\n\t\t\t},\n\t\t\tworldTransforms: {\n\t\t\t\tscale: 1,\n\t\t\t\tshift: {\n\t\t\t\t\tleft: 0,\n\t\t\t\t\ttop: 0\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t},\n\tcomputed: {\n\t\tsettings() {\n\t\t\tconst settings = {\n\t\t\t\ttouchResize: getSettings(this.touchResize),\n\t\t\t\ttouchMove: getSettings(this.touchMove),\n\t\t\t\tmouseMove: getSettings(this.mouseMove),\n\t\t\t\twheelResize: getSettings(this.wheelResize, {\n\t\t\t\t\tratio: 0.1\n\t\t\t\t}),\n\t\t\t};\n\n\t\t\t// Disable some interactions for user convenience\n\t\t\tsettings.touchMove.enabled = settings.touchMove.enabled && (this.worldTransforms.scale !== 1 || this.imageRestriction !== 'area');\n\n\t\t\treturn settings;\n\t\t},\n\t\timageTransforms() {\n\t\t\treturn {\n\t\t\t\t...this.basicImageTransforms,\n\t\t\t\tscaleX: (this.basicImageTransforms.scaleX || 1) * this.worldTransforms.scale,\n\t\t\t\tscaleY: (this.basicImageTransforms.scaleY || 1) * this.worldTransforms.scale,\n\t\t\t\ttranslateX: this.worldTransforms.shift.left / this.coefficient + (this.imageSize.width * this.worldTransforms.scale - this.imageSize.width)/2/this.coefficient,\n\t\t\t\ttranslateY: this.worldTransforms.shift.top / this.coefficient + (this.imageSize.height * this.worldTransforms.scale - this.imageSize.height)/2/this.coefficient,\n\t\t\t};\n\t\t},\n\t\tcoefficient() {\n\t\t\treturn this.imageSize.width\n\t\t\t\t? this.imageSize.width / this.boundarySize.width\n\t\t\t\t: 0;\n\t\t},\n\t\tclasses() {\n\t\t\treturn {\n\t\t\t\tcropper: classnames(cn(), this.classname),\n\t\t\t\timage: classnames(cn('image'), this.imageClassname),\n\t\t\t\tarea: classnames(cn('area'), this.areaClassname),\n\t\t\t\tstretcher: classnames(cn('stretcher')),\n\t\t\t\tbackground: classnames(cn('background'), this.backgroundClassname),\n\t\t\t\timageWrapper: classnames(cn('image-wrapper')),\n\t\t\t\tcropperWrapper: classnames(cn('cropper-wrapper')),\n\t\t\t};\n\t\t},\n\t\twrapperStyle() {\n\t\t\treturn {\n\t\t\t\twidth: `${this.stencilCoordinates.width}px`,\n\t\t\t\theight: `${this.stencilCoordinates.height}px`,\n\t\t\t\tleft: `${this.stencilCoordinates.left}px`,\n\t\t\t\ttop: `${this.stencilCoordinates.top}px`,\n\t\t\t};\n\t\t},\n\t\tareaStyle() {\n\t\t\treturn {\n\t\t\t\twidth: this.boundarySize.width\n\t\t\t\t\t? `${this.boundarySize.width}px`\n\t\t\t\t\t: 'auto',\n\t\t\t\theight: this.boundarySize.height\n\t\t\t\t\t? `${this.boundarySize.height}px`\n\t\t\t\t\t: 'auto',\n\t\t\t\topacity: this.imageLoaded ? 1 : 0,\n\t\t\t\ttransition: `opacity ${this.transitionTime}ms`,\n\t\t\t\tpointerEvents: this.imageLoaded ? 'all' : 'none',\n\t\t\t};\n\t\t},\n\t\timageStyle() {\n\t\t\tconst result = {\n\t\t\t\tleft: `calc(50% + ${this.imageTransforms.translateX}px)`,\n\t\t\t\ttop: `calc(50% + ${this.imageTransforms.translateY}px)`,\n\t\t\t\ttransform: 'translate(-50%, -50%)' + getStyleTransforms(this.imageTransforms),\n\t\t\t};\n\t\t\tconst flipped = this.imageTransforms.flipped;\n\t\t\tif (flipped) {\n\t\t\t\tresult.width = `${this.boundarySize.height}px`;\n\t\t\t\tresult.height = `${this.boundarySize.width}px`;\n\t\t\t} else {\n\t\t\t\tresult.width = `${this.boundarySize.width}px`;\n\t\t\t\tresult.height = `${this.boundarySize.height}px`;\n\t\t\t}\n\t\t\treturn result;\n\t\t},\n\t\tstencilRestrictions() {\n\t\t\tconst minSize = Math.max(\n\t\t\t\tMINIMAL_PERCENT_SIZE * this.imageSize.width / this.coefficient / this.worldTransforms.scale,\n\t\t\t\tMINIMAL_PERCENT_SIZE * this.imageSize.height / this.coefficient / this.worldTransforms.scale,\n\t\t\t);\n\t\t\t\t\t\t\n\t\t\tconst oldRestrictions = {\n\t\t\t\tminWidth: !isUndefined(this.minWidth) ? this.minWidth : 0,\n\t\t\t\tminHeight: !isUndefined(this.minHeight) ? this.minHeight : 0,\n\t\t\t\tmaxWidth: !isUndefined(this.maxWidth) ? this.maxWidth : Infinity,\n\t\t\t\tmaxHeight: !isUndefined(this.maxHeight) ? this.maxHeight : Infinity,\n\t\t\t};\n\n\t\t\tconst restrictions = migrateAlgorithm(this.restrictions, 'restrictions', (args) => [\n\t\t\t\targs.minWidth, args.minHeight, args.maxWidth, args.maxHeight, args.imageWidth, args.imageHeight\n\t\t\t])({\n\t\t\t\tminWidth: parseNumber(oldRestrictions.minWidth),\n\t\t\t\tminHeight: parseNumber(oldRestrictions.minHeight),\n\t\t\t\tmaxWidth: parseNumber(oldRestrictions.maxWidth),\n\t\t\t\tmaxHeight: parseNumber(oldRestrictions.maxHeight),\n\t\t\t\timageWidth: this.imageSize.width,\n\t\t\t\timageHeight: this.imageSize.height,\n\t\t\t\tprops: this.$props\n\t\t\t});\n\n\t\t\tif (isUndefined(restrictions.minWidth)) {\n\t\t\t\trestrictions.minWidth = Math.floor(minSize);\n\t\t\t}\n\n\t\t\tif (isUndefined(restrictions.minHeight)) {\n\t\t\t\trestrictions.minHeight = Math.floor(minSize);\n\t\t\t}\n\n\t\t\tif (restrictions.minWidth > restrictions.maxWidth) {\n\t\t\t\tconsole.warn(`Warning: maximum width (${restrictions.maxWidth}px) fewer that the minimum width (${restrictions.minWidth}px). It is set equal to the minimum width and width resizing was blocked`);\n\t\t\t\trestrictions.maxWidth = restrictions.minWidth;\n\t\t\t\trestrictions.widthFrozen = true;\n\t\t\t}\n\n\t\t\tif (restrictions.minHeight > restrictions.maxHeight) {\n\t\t\t\tconsole.warn(`Warning: maximum height (${restrictions.maxHeight}px) fewer that the minimum height (${restrictions.minHeight}px). It is set equal to the minimum height and height resizing was blocked`);\n\t\t\t\trestrictions.maxHeight = restrictions.minHeight;\n\t\t\t\trestrictions.heightFrozen = true;\n\t\t\t}\n\n\t\t\tif (this.imageRestriction !== 'none') {\n\t\t\t\tif (!restrictions.maxWidth || (restrictions.maxWidth > this.imageSize.width)) {\n\t\t\t\t\trestrictions.maxWidth = this.imageSize.width;\n\t\t\t\t}\n\t\t\t\tif (!restrictions.maxHeight || (restrictions.maxHeight > this.imageSize.height)) {\n\t\t\t\t\trestrictions.maxHeight = this.imageSize.height;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// The magic number is the approximation of the handler size\n\t\t\t// Temporary solution that should be improved in the future\n\t\t\trestrictions.minimum = 20 * this.coefficient / this.worldTransforms.scale;\n\n\t\t\treturn restrictions;\n\t\t},\n\t},\n\twatch: {\n\t\tsrc() {\n\t\t\tthis.onChangeImage();\n\t\t},\n\t\tminWidth() {\n\t\t\tthis.onPropsChange();\n\t\t},\n\t\tmaxWidth() {\n\t\t\tthis.onPropsChange();\n\t\t},\n\t\tminHeight() {\n\t\t\tthis.onPropsChange();\n\t\t},\n\t\tmaxHeight() {\n\t\t\tthis.onPropsChange();\n\t\t},\n\t\timageRestriction() {\n\t\t\tthis.resetCoordinates();\n\t\t},\n\t\tstencilProps(oldProps, newProps) {\n\t\t\tconst significantProps = ['aspectRatio', 'minAspectRatio', 'maxAspectRatio'];\n\t\t\tif (significantProps.find(prop => oldProps[prop] !== newProps[prop])) {\n\t\t\t\tVue.nextTick(this.onPropsChange);\n\t\t\t}\n\t\t}\n\t},\n\tmounted() {\n\t\tthis.debouncedUpdate = debounce(\n\t\t\tthis.update,\n\t\t\tthis.debounce\n\t\t);\n\t\twindow.addEventListener('resize', this.onResizeWindow);\n\t\twindow.addEventListener('orientationchange', this.onResizeWindow);\n\t\tthis.$refs.image.addEventListener('load', () => {\n\t\t\tthis.onSuccessLoadImage();\n\t\t});\n\t\tthis.$refs.image.addEventListener('error', () => {\n\t\t\tthis.onFailLoadImage();\n\t\t});\n\t\tthis.onChangeImage();\n\t},\n\tdestroyed() {\n\t\twindow.removeEventListener('resize', this.refreshImage);\n\t\twindow.removeEventListener('orientationchange', this.refreshImage);\n\t},\n\tmethods: {\n\t\t// External methods\n\t\tgetResult() {\n\t\t\tconst coordinates = this.prepareResult({ ...this.coordinates });\n\t\t\tif (this.canvas && this.src && this.imageLoaded) {\n\t\t\t\tthis.updateCanvas(this.coordinates);\n\t\t\t\treturn {\n\t\t\t\t\tcoordinates,\n\t\t\t\t\tcanvas: this.$refs.canvas,\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\treturn {\n\t\t\t\t\tcoordinates,\n\t\t\t\t};\n\t\t\t}\n\t\t},\n\t\t// Internal methods\n\t\tprepareResult(coordinates) {\n\t\t\tif (this.roundResult) {\n\t\t\t\treturn algorithms.roundCoordinates({\n\t\t\t\t\tcoordinates,\n\t\t\t\t\trestrictions: this.restrictions,\n\t\t\t\t\tallowedArea: this.getAllowedArea()\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\treturn coordinates;\n\t\t\t}\n\t\t},\n\t\tgetArea() {\n\t\t\treturn this.$refs.area;\n\t\t},\n\t\tgetStencil() {\n\t\t\treturn this.$refs.stencil;\n\t\t},\n\t\tautoZoom(coordinates) {\n\t\t\tconst { worldTransforms, stencilCoordinates } = algorithms.autoZoom({\n\t\t\t\tcoordinates,\n\t\t\t\tstencilCoordinates: this.stencilCoordinates,\n\t\t\t\tworldTransforms: this.worldTransforms,\n\t\t\t\tcoefficient: this.coefficient,\n\t\t\t\timageSize: this.imageSize,\n\t\t\t\tallowedArea: this.getAllowedArea(true)\n\t\t\t});\n\n\t\t\tthis.worldTransforms = worldTransforms;\n\t\t\tthis.stencilCoordinates = stencilCoordinates;\n\t\t},\n\t\tupdateStencilCoordinates(coordinates) {\n\t\t\tconst { width, height, left, top, } = coordinates;\n\t\t\tthis.stencilCoordinates =  {\n\t\t\t\twidth: this.worldTransforms.scale * width / this.coefficient,\n\t\t\t\theight: this.worldTransforms.scale * height / this.coefficient,\n\t\t\t\tleft: (left * this.worldTransforms.scale + this.worldTransforms.shift.left) / this.coefficient,\n\t\t\t\ttop: (top * this.worldTransforms.scale + this.worldTransforms.shift.top) / this.coefficient,\n\t\t\t};\n\t\t},\n\t\tupdateCanvas(coordinates) {\n\t\t\t// This function can be asynchronously called because it's debounced\n\t\t\t// Therefore there is workaround to prevent processing after the component was unmounted\n\t\t\tif (!this.$refs.canvas) return;\n\n\t\t\tconst image = this.$refs.image;\n\t\t\tconst source = this.checkOrientation ? prepareSource(this.$refs.sourceCanvas, image, this.imageTransforms) : image;\n\n\t\t\tconst canvas = this.$refs.canvas;\n\t\t\tcanvas.width = coordinates.width;\n\t\t\tcanvas.height = coordinates.height;\n\n\t\t\tconst ctx = canvas.getContext('2d');\n\t\t\tctx.clearRect(0,0,canvas.width,canvas.height);\n\t\t\tctx.drawImage(\n\t\t\t\tsource,\n\t\t\t\tcoordinates.left,\n\t\t\t\tcoordinates.top,\n\t\t\t\tcoordinates.width,\n\t\t\t\tcoordinates.height,\n\t\t\t\t0,\n\t\t\t\t0,\n\t\t\t\tcoordinates.width,\n\t\t\t\tcoordinates.height\n\t\t\t);\n\t\t},\n\t\tupdate() {\n\t\t\tthis.$emit('change', this.getResult());\n\t\t},\n\t\tonResizeWindow() {\n\t\t\tconst image = this.$refs.image;\n\t\t\tif (this.src && image) {\n\t\t\t\tthis.refreshImage().then(() => {\n\t\t\t\t\tthis.updateStencilCoordinates(this.coordinates);\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\tonChangeCoordinates(newCoordinates, debounce = true) {\n\t\t\tthis.coordinates = newCoordinates;\n\t\t\tif (this.$listeners && this.$listeners.change) {\n\t\t\t\tif (debounce) {\n\t\t\t\t\tthis.debouncedUpdate();\n\t\t\t\t} else {\n\t\t\t\t\tthis.update();\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tonChangeImage() {\n\t\t\tthis.imageLoaded = false;\n\t\t\tthis.delayedTransforms = null;\n\t\t\tthis.imageAttributes.src = null;\n\n\t\t\tif (this.src) {\n\t\t\t\tconst crossOrigin = isCrossOriginURL(this.src);\n\t\t\t\tif (crossOrigin && this.canvas && this.checkCrossOrigin) {\n\t\t\t\t\tthis.imageAttributes.crossOrigin = this.crossOrigin;\n\t\t\t\t}\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tconst src = this.bustCache ? addTimestamp(this.src) : this.src;\n\t\t\t\t\tif (this.checkOrientation) {\n\t\t\t\t\t\tparseImage(src).then(this.onParseImage);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.onParseImage({\n\t\t\t\t\t\t\tsource: src\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}, this.transitionTime);\n\t\t\t} else {\n\t\t\t\tthis.clearImage();\n\t\t\t}\n\t\t},\n\t\tonFailLoadImage() {\n\t\t\tthis.clearImage();\n\t\t\tthis.$emit('error');\n\t\t},\n\t\tonSuccessLoadImage() {\n\t\t\t// After loading image the current component can be unmounted\n\t\t\t// Therefore there is a workaround to prevent processing the following code\n\t\t\tif (this.$refs.image && !this.imageLoaded) {\n\t\t\t\tthis.imageLoaded = true;\n\t\t\t\tthis.refreshImage().then(() => {\n\t\t\t\t\tthis.resetCoordinates();\n\t\t\t\t\tthis.$emit('ready');\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\tonParseImage({ source, arrayBuffer, orientation }) {\n\t\t\tif (arrayBuffer && orientation && isLocal(source)) {\n\t\t\t\tthis.imageAttributes.src = arrayBufferToDataURL(arrayBuffer);\n\t\t\t} else {\n\t\t\t\tthis.imageAttributes.src = source;\n\t\t\t}\n\t\t\tthis.basicImageTransforms = getImageTransforms(orientation);\n\t\t\tVue.nextTick(() => {\n\t\t\t\tconst image = this.$refs.image;\n\t\t\t\tif (image && image.complete) {\n\t\t\t\t\tif (image.naturalWidth) {\n\t\t\t\t\t\tthis.onSuccessLoadImage();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.onFailLoadImage();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tonResize(resizeEvent) {\n\t\t\tif (this.frozenDirections.width) {\n\t\t\t\tresizeEvent.directions.left = 0;\n\t\t\t\tresizeEvent.directions.right = 0;\n\t\t\t}\n\t\t\tif (this.frozenDirections.height) {\n\t\t\t\tresizeEvent.directions.top = 0;\n\t\t\t\tresizeEvent.directions.bottom = 0;\n\t\t\t}\n\t\t\tALL_DIRECTIONS.forEach(direction => {\n\t\t\t\tresizeEvent.directions[direction] /= this.worldTransforms.scale / this.coefficient;\n\t\t\t});\n\t\t\tthis.onChangeCoordinates(\n\t\t\t\tthis.resizeAlgorithm({\n\t\t\t\t\tcoordinates: this.coordinates,\n\t\t\t\t\trestrictions: this.stencilRestrictions,\n\t\t\t\t\tallowedArea: this.getAllowedArea(),\n\t\t\t\t\taspectRatio: this.stencilAspectRatios(),\n\t\t\t\t\tresizeEvent\n\t\t\t\t})\n\t\t\t);\n\t\t\tthis.updateStencilCoordinates(this.coordinates);\n\t\t},\n\t\tonManipulateImage(manipulateImageEvent) {\n\t\t\tif (manipulateImageEvent.move.left) {\n\t\t\t\tmanipulateImageEvent.move.left *= this.coefficient;\n\t\t\t}\n\t\t\tif (manipulateImageEvent.move.top) {\n\t\t\t\tmanipulateImageEvent.move.top *= this.coefficient;\n\t\t\t}\n\t\t\tconst { worldTransforms, coordinates } = algorithms.manipulateImage({\n\t\t\t\tmanipulateImageEvent,\n\t\t\t\tcoordinates: this.coordinates,\n\t\t\t\tcoefficient: this.coefficient,\n\t\t\t\tstencilRestrictions: this.stencilRestrictions,\n\t\t\t\timageSize: this.imageSize,\n\t\t\t\tfrozenDirections: this.frozenDirections,\n\t\t\t\tstencilCoordinates: this.stencilCoordinates,\n\t\t\t\tworldTransforms: this.worldTransforms,\n\t\t\t\tallowedArea: this.getAllowedArea(true),\n\t\t\t\tminScale: this.imageRestriction === 'none' ? MINIMAL_PERCENT_SIZE : 1,\n\t\t\t\tfitImage: this.imageRestriction === 'area'\n\t\t\t});\n\t\t\tthis.worldTransforms = worldTransforms;\n\t\t\tthis.onChangeCoordinates(coordinates);\n\t\t\tthis.updateStencilCoordinates(coordinates);\n\t\t},\n\t\tonMove(moveEvent) {\n\t\t\tALL_DIRECTIONS.forEach(direction => {\n\t\t\t\tmoveEvent.directions[direction] /= this.worldTransforms.scale / this.coefficient;\n\t\t\t});\n\t\t\tthis.onChangeCoordinates(\n\t\t\t\tthis.moveAlgorithm({\n\t\t\t\t\tcoordinates: this.coordinates,\n\t\t\t\t\tallowedArea: this.getAllowedArea(),\n\t\t\t\t\tmoveEvent\n\t\t\t\t})\n\t\t\t);\n\t\t\tthis.updateStencilCoordinates(this.coordinates);\n\t\t},\n\t\tdefaultCoordinates() {\n\t\t\tconst aspectRatio = this.stencilAspectRatios();\n\t\t\tconst { minWidth, minHeight, maxWidth, maxHeight } = this.stencilRestrictions;\n\t\t\tconst imageSize = this.imageSize;\n\n\t\t\tlet coordinates = {};\n\t\t\tif (!aspectRatio.minimum && !aspectRatio.maximum) {\n\t\t\t\tcoordinates.height = minHeight;\n\t\t\t\tcoordinates.width = minWidth;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tlet ranges = {\n\t\t\t\t\twidth: {\n\t\t\t\t\t\tmaximum: aspectRatio.minimum ? Math.min(maxHeight, minWidth / aspectRatio.minimum) : maxHeight,\n\t\t\t\t\t\tminimum: aspectRatio.maximum ? Math.max(minHeight, minWidth / aspectRatio.maximum) : minHeight,\n\t\t\t\t\t},\n\t\t\t\t\theight: {\n\t\t\t\t\t\tmaximum: aspectRatio.maximum ? Math.min(maxWidth, minHeight * aspectRatio.maximum) : maxWidth,\n\t\t\t\t\t\tminimum: aspectRatio.minimum ? Math.max(minWidth, minHeight * aspectRatio.minimum) : minWidth,\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\tif (ranges.width.maximum >= ranges.width.minimum) {\n\t\t\t\t\tcoordinates.width = minWidth;\n\t\t\t\t\tcoordinates.height = ranges.width.minimum;\n\t\t\t\t} else if (ranges.height.maximum >= ranges.height.minimum) {\n\t\t\t\t\tcoordinates.height = minHeight;\n\t\t\t\t\tcoordinates.width = ranges.height.minimum;\n\t\t\t\t} else {\n\t\t\t\t\tthrow 'Error: current aspect ratio is incompatible with minimum/maximum height and width settings. Can\\'t setup default coordinates';\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tcoordinates.left = imageSize.width / 2 - coordinates.width / 2;\n\t\t\tcoordinates.top = imageSize.height / 2 - coordinates.height / 2;\n\n\t\t\treturn coordinates;\n\t\t},\n\t\tsetCoordinates(transforms, params = {}) {\n\t\t\tconst { autoZoom = true } = params;\n\t\t\tVue.nextTick(() => {\n\t\t\t\tif (!this.imageLoaded) {\n\t\t\t\t\tthis.delayedTransforms = transforms;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis.applyTransforms(transforms, autoZoom);\n\t\t\t});\n\t\t},\n\t\tonPropsChange() {\n\t\t\tthis.applyTransforms(this.coordinates, true);\n\t\t},\n\t\tapplyTransforms(transforms, autoZoom = false) {\n\t\t\tconst aspectRatio = this.stencilAspectRatios();\n\n\t\t\tconst allowedArea = this.getAllowedArea(true);\n\n\t\t\tconst moveAlgorithm = (prevCoordinates, newCoordinates) => {\n\t\t\t\treturn this.moveAlgorithm({\n\t\t\t\t\tcoordinates: prevCoordinates,\n\t\t\t\t\tallowedArea,\n\t\t\t\t\tmoveEvent: new MoveEvent(null, {\n\t\t\t\t\t\tleft: (newCoordinates.left - prevCoordinates.left),\n\t\t\t\t\t\ttop: (newCoordinates.top - prevCoordinates.top),\n\t\t\t\t\t})\n\t\t\t\t});\n\t\t\t};\n\n\t\t\tconst resizeAlgorithm = (prevCoordinates, newCoordinates) => {\n\t\t\t\tlet coordinates = this.defaultCoordinates();\n\t\t\t\tcoordinates = this.resizeAlgorithm({\n\t\t\t\t\tcoordinates,\n\t\t\t\t\trestrictions: this.stencilRestrictions,\n\t\t\t\t\tallowedArea,\n\t\t\t\t\taspectRatio,\n\t\t\t\t\tresizeEvent: new ResizeEvent(\n\t\t\t\t\t\tnull,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tleft: (newCoordinates.width - coordinates.width) / 2,\n\t\t\t\t\t\t\tright: (newCoordinates.width - coordinates.width) / 2,\n\t\t\t\t\t\t\ttop: (newCoordinates.height - coordinates.height) / 2,\n\t\t\t\t\t\t\tbottom: (newCoordinates.height - coordinates.height) / 2,\n\t\t\t\t\t\t}\n\t\t\t\t\t)\n\t\t\t\t});\n\t\t\t\treturn moveAlgorithm(coordinates, { left: prevCoordinates.left, top: prevCoordinates.top });\n\t\t\t};\n\n\t\t\tlet coordinates = this.coordinates;\n\n\t\t\tif (!Array.isArray(transforms)) {\n\t\t\t\ttransforms = [transforms];\n\t\t\t}\n\n\t\t\ttransforms.forEach(transform => {\n\t\t\t\tlet changes = {};\n\t\t\t\tif (typeof transform === 'function') {\n\t\t\t\t\tchanges = transform({ ...coordinates }, this.imageSize);\n\t\t\t\t} else {\n\t\t\t\t\tchanges = transform;\n\t\t\t\t}\n\t\t\t\tif (!isUndefined(changes.width) || !isUndefined(changes.height)) {\n\t\t\t\t\tcoordinates = resizeAlgorithm(coordinates, { ...coordinates, ...changes });\n\t\t\t\t}\n\t\t\t\tif (!isUndefined(changes.left) || !isUndefined(changes.top)) {\n\t\t\t\t\tcoordinates = moveAlgorithm(coordinates, { ...coordinates, ...changes });\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (autoZoom) {\n\t\t\t\tthis.autoZoom(coordinates);\n\t\t\t} else {\n\t\t\t\tif (this.worldTransforms.scale > 1) {\n\t\t\t\t\tthis.resetWorldTransforms();\n\t\t\t\t}\n\t\t\t\tthis.updateStencilCoordinates(coordinates);\n\t\t\t}\n\t\t\tthis.onChangeCoordinates(coordinates, false);\n\n\t\t\treturn coordinates;\n\t\t},\n\t\tresetWorldTransforms() {\n\t\t\tthis.worldTransforms = {\n\t\t\t\tscale: 1,\n\t\t\t\tshift: {\n\t\t\t\t\tleft:0,\n\t\t\t\t\ttop: 0\n\t\t\t\t}\n\t\t\t};\n\t\t},\n\t\tresetCoordinates() {\n\t\t\t// This function can be asynchronously called after completion of refreshing image promise\n\t\t\t// Therefore there is a workaround to prevent processing after the component was unmounted\n\t\t\tif (!this.$refs.image) return;\n\n\t\t\tconst cropper = this.$refs.cropper;\n\t\t\tconst image = this.$refs.image;\n\t\t\tconst { minWidth, minHeight, maxWidth, maxHeight, widthFrozen, heightFrozen, } = this.stencilRestrictions;\n\n\t\t\t// Freeze height or width if there was problems while setting stencil restrictions\n\t\t\tthis.frozenDirections.width = Boolean(widthFrozen);\n\t\t\tthis.frozenDirections.height = Boolean(heightFrozen);\n\n\t\t\tconst defaultSize = migrateAlgorithm(this.defaultSize, 'defaultSize', (args) => (\n\t\t\t\t[args.cropper, args.image, { minWidth: args.minWidth, minHeight: args.minHeight, maxWidth: args.maxWidth, maxHeight: args.maxHeight }, args.imageWidth, args.imageHeight, args.props ]\n\t\t\t))({\n\t\t\t\tcropper,\n\t\t\t\timage,\n\t\t\t\timageWidth: this.imageSize.width,\n\t\t\t\timageHeight: this.imageSize.height,\n\t\t\t\tprops: this.$props,\n\t\t\t\taspectRatio: this.stencilAspectRatios(),\n\t\t\t\t...this.stencilRestrictions,\n\t\t\t});\n\n\t\t\tif (defaultSize.width < minWidth || defaultSize.height < minHeight || defaultSize.width > maxWidth || defaultSize.height > maxHeight) {\n\t\t\t\tconsole.warn('Warning: the default size breaks size restrictions. Check your defaultSize function', defaultSize, this.stencilRestrictions);\n\t\t\t}\n\n\t\t\tconst transforms = [\n\t\t\t\tdefaultSize,\n\t\t\t\t(coordinates) => ({\n\t\t\t\t\t...migrateAlgorithm(this.defaultPosition, 'defaultPosition', (args) => (\n\t\t\t\t\t\t[args.cropper, args.image, args.stencilWidth, args.stencilHeight, args.imageWidth, args.imageHeight, args.props]\n\t\t\t\t\t))({\n\t\t\t\t\t\tcropper,\n\t\t\t\t\t\timage,\n\t\t\t\t\t\tstencilWidth: coordinates.width,\n\t\t\t\t\t\tstencilHeight: coordinates.height,\n\t\t\t\t\t\timageWidth: this.imageSize.width,\n\t\t\t\t\t\timageHeight: this.imageSize.height,\n\t\t\t\t\t\tprops: this.$props\n\t\t\t\t\t})\n\t\t\t\t})\n\t\t\t];\n\n\t\t\tif (this.delayedTransforms) {\n\t\t\t\ttransforms.push(...Array.isArray(this.delayedTransforms) ? this.delayedTransforms : [this.delayedTransforms]);\n\t\t\t}\n\t\t\tthis.resetWorldTransforms();\n\t\t\tthis.applyTransforms(transforms);\n\t\t\tthis.delayedTransforms = null;\n\t\t},\n\t\tclearImage() {\n\t\t\tconst stretcher = this.$refs.stretcher;\n\t\t\tthis.imageLoaded = false;\n\t\t\tsetTimeout(() => {\n\t\t\t\tstretcher.style.height = 'auto';\n\t\t\t\tstretcher.style.width = 'auto';\n\t\t\t\tthis.coordinates = { ...DEFAULT_COORDINATES };\n\t\t\t\tthis.boundarySize = {\n\t\t\t\t\twidth: 0,\n\t\t\t\t\theight: 0,\n\t\t\t\t};\n\t\t\t\tthis.updateStencilCoordinates({ ...DEFAULT_COORDINATES });\n\t\t\t}, this.transitionTime);\n\t\t},\n\t\trefreshImage() {\n\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\tconst image = this.$refs.image;\n\t\t\t\tconst cropper = this.$refs.cropper;\n\t\t\t\tif (this.src && image) {\n\t\t\t\t\tconst stretcher = this.$refs.stretcher;\n\t\t\t\t\tif (this.imageTransforms.flipped) {\n\t\t\t\t\t\tthis.imageSize.height = image.naturalWidth;\n\t\t\t\t\t\tthis.imageSize.width = image.naturalHeight;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.imageSize.height = image.naturalHeight;\n\t\t\t\t\t\tthis.imageSize.width = image.naturalWidth;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst aspectRatio = this.imageSize.width / this.imageSize.height;\n\n\t\t\t\t\tif (this.imageSize.height > this.imageSize.width) {\n\t\t\t\t\t\tstretcher.style.height = `${this.imageSize.height}px`;\n\t\t\t\t\t\tstretcher.style.width = `${stretcher.clientHeight * aspectRatio}px`;\n\t\t\t\t\t\tif (stretcher.clientWidth / stretcher.clientHeight !== aspectRatio) {\n\t\t\t\t\t\t\tstretcher.style.height = `${stretcher.clientWidth / aspectRatio}px`;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tstretcher.style.width = `${this.imageSize.width}px`;\n\t\t\t\t\t\tstretcher.style.height = `${stretcher.clientWidth / aspectRatio }px`;\n\t\t\t\t\t\tif (stretcher.clientHeight / stretcher.clientWidth !== aspectRatio) {\n\t\t\t\t\t\t\tstretcher.style.width = `${stretcher.clientHeight * aspectRatio}px`;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tVue.nextTick(() => {\n\t\t\t\t\t\tconst { height, width, } = migrateAlgorithm(this.areaSize, 'areaSize', (args) => ([\n\t\t\t\t\t\t\targs.cropper, args.image, args.imageWidth, args.imageHeight\n\t\t\t\t\t\t]))({\n\t\t\t\t\t\t\tcropper,\n\t\t\t\t\t\t\timage,\n\t\t\t\t\t\t\timageWidth: this.imageSize.width,\n\t\t\t\t\t\t\timageHeight: this.imageSize.height\n\t\t\t\t\t\t});\n\t\t\t\t\t\tif (height) {\n\t\t\t\t\t\t\tthis.boundarySize.height = height;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (width) {\n\t\t\t\t\t\t\tthis.boundarySize.width = width;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tresolve();\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\treject();\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tgetAllowedArea(breakBoundaries) {\n\t\t\treturn this.allowedArea({\n\t\t\t\tbreakBoundaries,\n\t\t\t\timageSize: this.imageSize,\n\t\t\t\tworldTransforms: this.worldTransforms,\n\t\t\t\timageRestriction: this.imageRestriction\n\t\t\t});\n\t\t},\n\t\tstencilAspectRatios() {\n\t\t\tif (this.$refs.stencil.aspectRatios) {\n\t\t\t\treturn this.$refs.stencil.aspectRatios();\n\t\t\t} else {\n\t\t\t\treturn {\n\t\t\t\t\tminimum: this.stencilProps.aspectRatio || this.stencilProps.minAspectRatio,\n\t\t\t\t\tmaximum: this.stencilProps.aspectRatio || this.stencilProps.maxAspectRatio,\n\t\t\t\t};\n\t\t\t}\n\t\t},\n\t},\n};\n</script>\n\n<template>\n  <div\n    ref=\"cropper\"\n    :class=\"classes.cropper\"\n  >\n    <div\n      :class=\"classes.background\"\n      :style=\"areaStyle\"\n    />\n    <div\n      ref=\"stretcher\"\n      :class=\"classes.stretcher\"\n    />\n\n    <div\n      ref=\"area\"\n      :class=\"classes.area\"\n      :style=\"areaStyle\"\n    >\n      <CropperWrapper\n        :class=\"classes.cropperWrapper\"\n        :wheel-resize=\"settings.wheelResize\"\n        :touch-resize=\"settings.touchResize\"\n        :touch-move=\"settings.touchMove\"\n        :mouse-move=\"settings.touchMove\"\n        @move=\"onManipulateImage\"\n        @resize=\"onManipulateImage\"\n      >\n        <div :class=\"classes.imageWrapper\">\n          <img\n            ref=\"image\"\n            :crossOrigin=\"imageAttributes.crossOrigin\"\n            :src=\"imageAttributes.src\"\n            :class=\"classes.image\"\n            :style=\"imageStyle\"\n            @mousedown.prevent\n          >\n        </div>\n        <component\n          :is=\"stencilComponent\"\n          ref=\"stencil\"\n          :img=\"{\n            src: imageAttributes.src,\n            size: imageSize,\n            transforms: imageTransforms,\n            coefficient: coefficient\n          }\"\n          :result-coordinates=\"coordinates\"\n          :stencil-coordinates=\"stencilCoordinates\"\n          v-bind=\"stencilProps\"\n          @resize=\"onResize\"\n          @move=\"onMove\"\n        />\n        <canvas\n          v-if=\"canvas\"\n          ref=\"canvas\"\n          :style=\"{display:'none'}\"\n        />\n        <canvas\n          v-if=\"canvas\"\n          ref=\"sourceCanvas\"\n          :style=\"{display:'none'}\"\n        />\n      </CropperWrapper>\n    </div>\n  </div>\n</template>\n\n<style lang=\"scss\">\n.vue-advanced-cropper {\n\ttext-align: center;\n\tposition: relative;\n\tuser-select: none;\n\tmax-height: 100%;\n\tmax-width: 100%;\n\tdirection: ltr;\n\n\t&__stretcher {\n\t\tpointer-events: none;\n\t\tposition: relative;\n\t\tmax-width: 100%;\n\t\tmax-height: 100%;\n\t}\n\n  &__image {\n\topacity: 0.5;\n\tuser-select: none;\n\tposition: absolute;\n\ttransform-origin: center;\n\t// Workaround to prevent bugs at the websites with max-width\n\t// rule applied to img (Vuepress for example)\n\tmax-width: unset !important;\n  }\n  &__area {\n\tposition: absolute;\n\tleft: 50%;\n\ttransform: translate(-50%, -50%);\n\ttop: 50%;\n  }\n  &__background {\n\tposition: absolute;\n\tbackground: black;\n\ttop: 50%;\n\tleft: 50%;\n\ttransform: translate(-50%, -50%);\n  }\n  &__cropper-wrapper {\n\twidth: 100%;\n\theight: 100%;\n  }\n  &__image-wrapper {\n\toverflow: hidden;\n\tposition: absolute;\n\twidth: 100%;\n\theight: 100%;\n  }\n  &__stencil-wrapper {\n\tposition: absolute;\n  }\n}\n</style>\n","import Vue from 'vue';\nimport Cropper from './Cropper.vue';\n\nimport {\n\tRectangleStencil,\n\tCircleStencil\n} from './components/stencils';\n\nimport {\n\tSimpleHandler\n} from './components/handlers';\n\nimport {\n\tSimpleLine\n} from './components/lines';\n\nexport {\n\tPreviewResult,\n\tDraggableArea,\n\tBoundingBox,\n\tLineWrapper,\n\tHandlerWrapper,\n\tDraggableElement\n} from './components/service';\n\nexport {\n\tRectangleStencil,\n\tCircleStencil\n} from './components/stencils';\n\nexport {\n\tSimpleHandler\n} from './components/handlers';\n\nexport {\n\tSimpleLine\n} from './components/lines';\n\nexport {\n\tPreviewImage\n} from './components/helpers';\n\nexport {\n\tResizeEvent,\n\tMoveEvent,\n\tDragEvent\n} from './core/events';\n\nexport { default as Cropper } from './Cropper.vue';\n\nVue.component('cropper', Cropper);\nVue.component('rectangle-stencil', RectangleStencil);\nVue.component('circle-stencil', CircleStencil);\nVue.component('simple-handler', SimpleHandler);\nVue.component('simple-line', SimpleLine);\n"],"names":["classNames","arg","classes","i","arguments","length","argType","push","Array","isArray","inner","apply","key","hasOwn","call","join","hasOwnProperty","module","exports","default","window","componentName","elementOrMods","mods","element","base","Object","keys","reduce","result","name","value","debounce","func","wait","immediate","later","last","Date","now","timestamp","timeout","setTimeout","context","args","debounced","callNow","clear","clearTimeout","flush","directionNames","hDirection","vDirection","classname","toUpperCase","slice","isLocal","url","test","isCrossOriginURL","pageLocation","location","URL_HOST_PATTERN","urlMatch","exec","urlparts","protocol","host","port","defaultPort","portOf","isUndefined","obj","isObject","_typeof","addTimestamp","getTime","indexOf","distance","firstPoint","secondPoint","Math","pow","sqrt","x","y","getSettings","param","defaultParams","enabled","parseNumber","number","Number","isNaN","parsedNumber","ManipulateImageEvent","nativeEvent","move","scale","params","ResizeEvent","directions","MoveEvent","DragEvent","position","previousPosition","anchor","getBoundingClientRect","left","top","beforeMount","addEventListener","onMouseUp","passive","onMouseMove","onTouchMove","onTouchEnd","beforeDestroy","removeEventListener","mounted","$refs","draggable","Error","touches","draggingAnchor","hovered","methods","onMouseOver","$emit","onMouseLeave","onTouchStart","e","cancelable","disabled","initAnchor","mean","touch","clientX","clientY","preventDefault","stopPropagation","processEnd","processMove","onMouseDown","fake","right","bottom","event","newTouches","HORIZONTAL_DIRECTIONS","VERTICAL_DIRECTIONS","ALL_DIRECTIONS","IMAGE_RESTRICTIONS","XHR_DONE","MINIMAL_PERCENT_SIZE","DEFAULT_COORDINATES","width","height","prepareSource","canvas","image","PI","flipped","orientation","naturalWidth","naturalHeight","ctx","getContext","save","translate","rotate","drawImage","restore","getImageTransforms","scaleX","scaleY","getStyleTransforms","transform","parseImage","src","Promise","resolve","getImageData","then","data","source","arrayBuffer","getOrientation","catch","error","console","warn","img","reject","base64ToArrayBuffer","fileReader","FileReader","onload","target","objectURLToBlob","blob","readAsArrayBuffer","http","XMLHttpRequest","onreadystatechange","readyState","status","response","onprogress","getResponseHeader","abort","withCredentials","open","responseType","send","callback","base64","replace","binary","atob","len","buffer","ArrayBuffer","view","Uint8Array","charCodeAt","getStringFromCharCode","dataView","start","str","String","fromCharCode","getUint8","exifIDCode","tiffOffset","littleEndian","app1Start","ifdStart","DataView","byteLength","offset","endianness","getUint16","firstIFDOffset","getUint32","setUint16","arrayBufferToDataURL","chunks","chunkSize","uint8","subarray","from","btoa","allSides","coordinates","mainSide","side","getCurrentWidth","actualCoordinates","getCurrentHeight","getBrokenLimits","allowedArea","min","ceil","fitConditions","max","oldDirections","restrictions","preserveAspectRatio","stopOnBreak","mode","currentWidth","currentHeight","minWidth","minHeight","breaks","maxResize","forEach","direction","multiplier","map","maxWidth","maxHeight","getBrokenRatio","aspectRatio","ratioBroken","minimum","maximum","resize","abs","resizeEvent","limitedRestrictions","allowedDirections","respectDirection","overlapHeight","overlapWidth","compensate","moveEvent","newCoordinates","areaSize","cropper","imageWidth","imageHeight","areaHeight","clientHeight","areaWidth","clientWidth","defaultPosition","stencilWidth","stencilHeight","props","defaultSize","newHeight","newWidth","ratio","percentRestrictions","autoZoom","originalStencilCoordinates","stencilCoordinates","originalWorldTransforms","worldTransforms","coefficient","imageSize","shift","scaledImageSize","manipulateImage","manipulateImageEvent","stencilRestrictions","frozenDirections","fitImage","imageShifts","scaleImage","scaleStencil","minScale","factor","epsilon","allowedImageScale","imageSizeChanges","center","stencilResizeAmends","breakBoundaries","imageRestriction","limits","boundaries","roundCoordinates","floor","round","roundedCoordinates","component","Cropper","Vue","RectangleStencil","CircleStencil","SimpleHandler","SimpleLine"],"mappings":"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"}